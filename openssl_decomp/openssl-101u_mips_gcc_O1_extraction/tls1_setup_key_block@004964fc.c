
/* WARNING: Could not reconcile some variable overlaps */

uint * tls1_setup_key_block(uint *param_1,uint **param_2,char *param_3,uint **param_4)

{
  byte bVar1;
  undefined2 uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  byte bVar21;
  byte bVar22;
  uint *puVar23;
  int iVar24;
  undefined4 uVar25;
  uint **ppuVar26;
  int iVar27;
  uint uVar28;
  uint **ppuVar29;
  int iVar30;
  uint *puVar31;
  undefined4 uVar32;
  char cVar34;
  uint *puVar33;
  undefined uVar39;
  uint uVar35;
  uint *puVar36;
  int iVar37;
  int iVar38;
  uint uVar40;
  char *pcVar41;
  int *piVar42;
  uint uVar43;
  uint uVar44;
  uint uVar45;
  uint in_t0;
  uint uVar46;
  uint in_t1;
  uint uVar47;
  uint in_t2;
  uint uVar48;
  uint in_t3;
  uint uVar49;
  uint uVar50;
  uint *unaff_s0;
  uint **unaff_s2;
  int unaff_s3;
  int unaff_s4;
  int iVar51;
  char *unaff_s5;
  undefined *puVar52;
  int unaff_s6;
  uint *unaff_s7;
  code *pcVar53;
  uint **unaff_s8;
  uint **ppuVar54;
  int iVar55;
  uint uStack_3e8;
  int iStack_3e4;
  undefined4 uStack_3e0;
  int iStack_3dc;
  char *pcStack_3a8;
  int iStack_394;
  int iStack_390;
  uint uStack_38c;
  uint uStack_388;
  uint uStack_384;
  uint uStack_380;
  uint uStack_37c;
  uint uStack_378;
  uint uStack_374;
  uint uStack_370;
  uint uStack_36c;
  uint uStack_368;
  uint uStack_364;
  uint uStack_360;
  uint uStack_35c;
  uint **ppuStack_358;
  int *piStack_354;
  uint **ppuStack_350;
  uint uStack_34c;
  undefined *puStack_348;
  undefined *puStack_344;
  int *piStack_340;
  uint *puStack_33c;
  uint **ppuStack_338;
  code *pcStack_334;
  uint *puStack_320;
  int iStack_31c;
  uint *puStack_318;
  int iStack_314;
  undefined4 uStack_310;
  undefined4 uStack_30c;
  undefined *puStack_308;
  uint *puStack_2fc;
  uint *puStack_2f8;
  uint **ppuStack_2f4;
  uint *puStack_2f0;
  undefined auStack_2ec [24];
  undefined auStack_2d4 [4];
  undefined auStack_2d0 [4];
  uint *puStack_2cc;
  uint *puStack_2c8;
  undefined uStack_2c4;
  undefined uStack_2c3;
  undefined uStack_2c2;
  undefined uStack_2c1;
  undefined uStack_2c0;
  int iStack_2bc;
  uint *puStack_2b8;
  uint **ppuStack_2b4;
  uint *puStack_2b0;
  uint **ppuStack_2ac;
  int *piStack_2a8;
  uint **ppuStack_2a4;
  uint **ppuStack_2a0;
  uint *puStack_29c;
  uint **ppuStack_298;
  code *pcStack_294;
  uint **ppuStack_280;
  undefined *puStack_27c;
  int iStack_278;
  undefined4 uStack_274;
  undefined4 uStack_270;
  undefined4 uStack_26c;
  undefined4 uStack_268;
  uint **ppuStack_264;
  undefined4 uStack_260;
  undefined *puStack_258;
  int iStack_250;
  undefined *puStack_24c;
  uint **ppuStack_248;
  int iStack_244;
  int iStack_240;
  int **ppiStack_23c;
  undefined *puStack_238;
  uint *puStack_234;
  uint **ppuStack_22c;
  uint uStack_228;
  undefined4 uStack_224;
  int iStack_220;
  uint *puStack_21c;
  undefined auStack_218 [24];
  byte bStack_200;
  byte bStack_1ff;
  byte bStack_1fe;
  byte bStack_1fd;
  byte bStack_1fc;
  byte bStack_1fb;
  byte bStack_1fa;
  byte bStack_1f9;
  byte bStack_1f8;
  byte bStack_1f7;
  byte bStack_1f6;
  byte bStack_1f5;
  undefined auStack_1f4 [128];
  int *piStack_174;
  uint **ppuStack_170;
  uint **ppuStack_16c;
  uint *puStack_168;
  uint **ppuStack_164;
  undefined *puStack_160;
  uint **ppuStack_15c;
  int iStack_158;
  uint *puStack_154;
  uint **ppuStack_150;
  code *pcStack_14c;
  uint **ppuStack_140;
  undefined4 uStack_138;
  undefined *puStack_130;
  uint *puStack_128;
  uint *apuStack_124 [6];
  uint **ppuStack_10c;
  uint **ppuStack_104;
  int *piStack_100;
  uint *puStack_fc;
  uint **ppuStack_f8;
  undefined *puStack_f4;
  uint **ppuStack_f0;
  code *pcStack_ec;
  undefined4 uStack_d8;
  undefined *puStack_d0;
  undefined auStack_c8 [4];
  undefined auStack_c4 [8];
  uint *puStack_bc;
  uint *puStack_b8;
  undefined uStack_b4;
  undefined uStack_b3;
  undefined uStack_b2;
  undefined uStack_b1;
  undefined uStack_b0;
  uint **ppuStack_ac;
  uint *puStack_a8;
  undefined *puStack_a4;
  uint **ppuStack_a0;
  int iStack_9c;
  int iStack_98;
  uint **ppuStack_94;
  undefined4 local_38;
  undefined4 local_34 [2];
  undefined4 local_2c;
  int local_28;
  int *local_24;
  
  puStack_a4 = PTR___stack_chk_guard_006a9ae8;
  local_2c = 0;
  local_28 = 0;
  local_24 = *(int **)PTR___stack_chk_guard_006a9ae8;
  puVar23 = (uint *)0x1;
  puStack_a8 = unaff_s0;
  if (*(int *)(param_1[0x16] + 0x374) == 0) {
    puVar23 = (uint *)ssl_cipher_get_evp(param_1[0x30],&local_38,local_34,&local_2c);
    puVar52 = PTR_EVP_CIPHER_key_length_006a7554;
    puStack_a8 = param_1;
    if (puVar23 == (uint *)0x0) {
      param_3 = (char *)0x8a;
      param_4 = (uint **)&DAT_0064760c;
      param_2 = (uint **)0xd3;
      (*(code *)PTR_ERR_put_error_006a7f34)(0x14);
    }
    else {
      unaff_s5 = "-check_ss_sig";
      uVar28 = param_1[0x16];
      *(undefined4 *)(uVar28 + 0x37c) = local_38;
      *(undefined4 *)(uVar28 + 0x380) = local_34[0];
      *(undefined4 *)(uVar28 + 900) = local_2c;
      *(int *)(uVar28 + 0x388) = local_28;
      iVar24 = (*(code *)puVar52)(local_38);
      iVar24 = iVar24 + local_28;
      iVar27 = (*(code *)PTR_EVP_CIPHER_iv_length_006a7550)(local_38);
      unaff_s2 = (uint **)((iVar24 + iVar27) * 2);
      ssl3_cleanup_key_block(param_1);
      unaff_s4 = (*(code *)PTR_CRYPTO_malloc_006a7008)(unaff_s2,&DAT_0064760c,0x288);
      puVar52 = PTR_CRYPTO_malloc_006a7008;
      if (unaff_s4 == 0) {
        param_4 = (uint **)&DAT_0064760c;
        param_3 = &DAT_00000041;
        param_2 = (uint **)0xd3;
        (*(code *)PTR_ERR_put_error_006a7f34)(0x14);
        puVar23 = (uint *)0x0;
      }
      else {
        uVar28 = param_1[0x16];
        *(uint ***)(uVar28 + 0x374) = unaff_s2;
        *(int *)(uVar28 + 0x378) = unaff_s4;
        unaff_s3 = (*(code *)puVar52)(unaff_s2,&DAT_0064760c,0x290);
        if (unaff_s3 == 0) {
          param_4 = (uint **)&DAT_0064760c;
          param_3 = &DAT_00000041;
          param_2 = (uint **)0xd3;
          (*(code *)PTR_ERR_put_error_006a7f34)(0x14);
          (*(code *)PTR_CRYPTO_free_006a6e88)(unaff_s4);
          puVar23 = (uint *)0x0;
        }
        else {
          unaff_s5 = &DAT_00000020;
          uVar25 = ssl_get_algorithm2(param_1);
          param_3 = &DAT_0000000d;
          in_t0 = param_1[0x16] + 0xc0;
          param_4 = (uint **)(param_1[0x16] + 0xa0);
          iVar24 = tls1_PRF_constprop_1(uVar25,"key expansion");
          if (iVar24 == 0) {
            puVar23 = (uint *)0x0;
          }
          else {
            if (((param_1[0x40] & 0x800) == 0) && (*(int *)param_1[2] < 0x302)) {
              uVar28 = param_1[0x16];
              iVar24 = *(int *)(param_1[0x30] + 0xb4);
              *(undefined4 *)(uVar28 + 0xe0) = 1;
              if (iVar24 != 0) {
                iVar24 = *(int *)(iVar24 + 0x14);
                if (iVar24 == 0x20) {
                  *(undefined4 *)(uVar28 + 0xe0) = 0;
                }
                else {
                  puVar23 = (uint *)0x1;
                  if (iVar24 == 4) {
                    *(undefined4 *)(uVar28 + 0xe0) = 0;
                    goto LAB_00496734;
                  }
                }
              }
            }
            puVar23 = (uint *)0x1;
          }
LAB_00496734:
          param_2 = unaff_s2;
          (*(code *)PTR_OPENSSL_cleanse_006a7074)(unaff_s3);
          (*(code *)PTR_CRYPTO_free_006a6e88)(unaff_s3);
          puStack_a8 = puVar23;
        }
      }
    }
  }
  if (local_24 == *(int **)puStack_a4) {
    return puVar23;
  }
  piStack_100 = local_24;
  (*(code *)PTR___stack_chk_fail_006a9ab0)();
  puStack_f4 = PTR___stack_chk_guard_006a9ae8;
  puStack_d0 = &_gp;
  ppuStack_ac = *(uint ***)PTR___stack_chk_guard_006a9ae8;
  ppuStack_2ac = param_2;
  ppuStack_a0 = unaff_s2;
  iStack_9c = unaff_s3;
  iStack_98 = unaff_s4;
  ppuStack_94 = (uint **)unaff_s5;
  if (param_2 == (uint **)0x0) {
    iVar24 = (*(code *)PTR_EVP_MD_CTX_md_006a7500)(piStack_100[0x21]);
    if (iVar24 != 0) {
      uVar25 = (**(code **)(puStack_d0 + -0x78e0))(piStack_100[0x21]);
      iVar24 = (**(code **)(puStack_d0 + -0x6fa4))(uVar25);
      if (iVar24 < 0) {
        param_3 = "n >= 0";
        ppuStack_2ac = (uint **)0x307;
        (**(code **)(puStack_d0 + -0x7184))(&DAT_0064760c);
      }
    }
    puStack_2b0 = (uint *)piStack_100[0x20];
    ppuStack_170 = (uint **)(piStack_100[0x16] + 0x10c);
    if (puStack_2b0 != (uint *)0x0) {
      unaff_s6 = (**(code **)(puStack_d0 + -0x6cf4))(puStack_2b0);
      goto LAB_00496990;
    }
LAB_004968d8:
    pcVar53 = *(code **)(puStack_d0 + -0x52ec);
LAB_004968dc:
    param_3 = (char *)ppuStack_170[1];
    ppuStack_2ac = (uint **)ppuStack_170[4];
    (*pcVar53)(ppuStack_170[3]);
    puVar23 = (uint *)0x1;
    ppuStack_170[4] = ppuStack_170[3];
  }
  else {
    iVar24 = (*(code *)PTR_EVP_MD_CTX_md_006a7500)(piStack_100[0x24]);
    if (iVar24 != 0) {
      uVar25 = (**(code **)(puStack_d0 + -0x78e0))(piStack_100[0x24]);
      iVar24 = (**(code **)(puStack_d0 + -0x6fa4))(uVar25);
      if (iVar24 < 0) {
        param_3 = "n >= 0";
        ppuStack_2ac = (uint **)0x2e8;
        (**(code **)(puStack_d0 + -0x7184))(&DAT_0064760c);
      }
    }
    unaff_s5 = (char *)piStack_100[0x16];
    puStack_2b0 = (uint *)piStack_100[0x23];
    ppuStack_170 = (uint **)((int)unaff_s5 + 0x130);
    if (puStack_2b0 == (uint *)0x0) goto LAB_004968d8;
    unaff_s6 = (**(code **)(puStack_d0 + -0x6cf4))(puStack_2b0);
    if ((0x301 < *piStack_100) &&
       (uVar28 = (**(code **)(puStack_d0 + -0x789c))(unaff_s6), (uVar28 & 0xf0007) == 2)) {
      ppuStack_2ac = (uint **)(**(code **)(puStack_d0 + -0x7890))(unaff_s6);
      if (1 < (int)ppuStack_2ac) {
        if (*(uint **)((int)unaff_s5 + 0x13c) != *(uint **)((int)unaff_s5 + 0x140)) {
          uStack_d8 = 0x2ff;
          param_4 = (uint **)&DAT_0064760c;
          param_3 = "%s:%d: rec->data != rec->input\n";
          ppuStack_2ac = (uint **)0x1;
          (**(code **)(puStack_d0 + -0x5460))(**(undefined4 **)(puStack_d0 + -0x52e8));
          goto LAB_00496990;
        }
        iVar24 = (**(code **)(puStack_d0 + -0x786c))();
        if (0 < iVar24) goto LAB_00496990;
LAB_00496e58:
        puVar23 = (uint *)0xffffffff;
        goto LAB_004968fc;
      }
LAB_00496990:
      pcVar53 = *(code **)(puStack_d0 + -0x52ec);
      if (piStack_100[0x30] != 0) goto LAB_0049699c;
      goto LAB_004968dc;
    }
    if (piStack_100[0x30] == 0) goto LAB_004968d8;
LAB_0049699c:
    if (unaff_s6 == 0) goto LAB_004968d8;
    unaff_s8 = (uint **)ppuStack_170[1];
    unaff_s5 = (char *)(**(code **)(puStack_d0 + -0x6cf0))(*puStack_2b0);
    iVar24 = (**(code **)(puStack_d0 + -0x789c))(*puStack_2b0);
    if (iVar24 << 10 < 0) {
      iVar24 = *piStack_100;
      if (param_2 == (uint **)0x0) {
        ppuVar26 = (uint **)(piStack_100[0x16] + 8);
        if ((iVar24 == 0xfeff) || (iVar24 == 0x100)) {
          uVar2 = *(undefined2 *)(piStack_100[0x17] + 0x208);
          uVar39 = (undefined)((ushort)uVar2 >> 8);
          goto LAB_004969f8;
        }
LAB_00496c60:
        puStack_bc = *ppuVar26;
        puStack_b8 = ppuVar26[1];
        cVar34 = *(char *)((int)ppuVar26 + 7) + '\x01';
        *(char *)((int)ppuVar26 + 7) = cVar34;
        if ((cVar34 == '\0') &&
           (((((cVar34 = *(char *)((int)ppuVar26 + 6) + '\x01',
               *(char *)((int)ppuVar26 + 6) = cVar34, cVar34 == '\0' &&
               (cVar34 = *(char *)((int)ppuVar26 + 5) + '\x01',
               *(char *)((int)ppuVar26 + 5) = cVar34, cVar34 == '\0')) &&
              (cVar34 = *(char *)(ppuVar26 + 1), *(char *)(ppuVar26 + 1) = cVar34 + '\x01',
              (char)(cVar34 + '\x01') == '\0')) &&
             ((cVar34 = *(char *)((int)ppuVar26 + 3) + '\x01', *(char *)((int)ppuVar26 + 3) = cVar34
              , cVar34 == '\0' &&
              (cVar34 = *(char *)((int)ppuVar26 + 2) + '\x01', *(char *)((int)ppuVar26 + 2) = cVar34
              , cVar34 == '\0')))) &&
            (cVar34 = *(char *)((int)ppuVar26 + 1) + '\x01', *(char *)((int)ppuVar26 + 1) = cVar34,
            cVar34 == '\0')))) {
          *(char *)ppuVar26 = *(char *)ppuVar26 + '\x01';
        }
        iVar24 = *piStack_100;
      }
      else {
        ppuVar26 = (uint **)(piStack_100[0x16] + 0x54);
        if ((iVar24 != 0xfeff) && (iVar24 != 0x100)) goto LAB_00496c60;
        uVar2 = *(undefined2 *)(piStack_100[0x17] + 0x20a);
        uVar39 = (undefined)((ushort)uVar2 >> 8);
LAB_004969f8:
        bVar1 = *(byte *)((int)ppuVar26 + 6);
        in_t0 = (uint)bVar1;
        cVar34 = *(char *)((int)ppuVar26 + 7);
        uVar35 = *(uint *)((int)ppuVar26 + 2);
        puStack_bc = (uint *)CONCAT13(uVar39,CONCAT12((char)uVar2,SUB42(auStack_c8,0)));
        auStack_c8 = (undefined  [4])puStack_bc;
        puVar52 = auStack_c8 + 2;
        uVar28 = (uint)puVar52 & 3;
        *(uint *)(puVar52 + -uVar28) =
             *(uint *)(puVar52 + -uVar28) & -1 << (4 - uVar28) * 8 | uVar35 >> uVar28 * 8;
        puVar52 = auStack_c4 + 1;
        uVar28 = (uint)puVar52 & 3;
        *(uint *)(puVar52 + -uVar28) =
             *(uint *)(puVar52 + -uVar28) & 0xffffffffU >> (uVar28 + 1) * 8 |
             uVar35 << (3 - uVar28) * 8;
        auStack_c4._0_4_ = (uint *)CONCAT31(CONCAT21(auStack_c4._0_2_,bVar1),cVar34);
        puStack_b8 = auStack_c4._0_4_;
      }
      param_4 = &puStack_bc;
      uStack_b2 = (undefined)iVar24;
      param_3 = &DAT_0000000d;
      ppuStack_2ac = (uint **)&DAT_00000016;
      uStack_b3 = (undefined)((uint)iVar24 >> 8);
      uStack_b4 = SUB41(*ppuStack_170,0);
      uStack_b0 = SUB41(ppuStack_170[1],0);
      uStack_b1 = (undefined)((uint)ppuStack_170[1] >> 8);
      unaff_s7 = (uint *)(**(code **)(puStack_d0 + -0x6bec))(puStack_2b0);
      if ((int)unaff_s7 < 1) goto LAB_00496e58;
      if (param_2 != (uint **)0x0) {
        ppuVar26 = (uint **)((int)unaff_s8 + (int)unaff_s7);
        ppuStack_170[1] = (uint *)((int)ppuStack_170[1] + (int)unaff_s7);
        unaff_s8 = ppuVar26;
        if (param_2 != (uint **)0x0) goto LAB_00496ab8;
      }
LAB_00496a9c:
      puVar23 = (uint *)0x0;
      ppuVar26 = unaff_s8;
      if (unaff_s8 != (uint **)0x0) {
LAB_00496aa4:
        if ((uint **)unaff_s5 == (uint **)0x0) {
          trap(7);
        }
        puVar23 = (uint *)0x0;
        unaff_s8 = ppuVar26;
        if ((uint)ppuVar26 % (uint)unaff_s5 == 0) {
LAB_00496ab8:
          pcVar53 = *(code **)(puStack_d0 + -0x6cec);
          unaff_s8 = ppuVar26;
          goto LAB_00496abc;
        }
      }
    }
    else if ((uint **)unaff_s5 == (uint **)0x1) {
      unaff_s7 = (uint *)0x0;
      if (param_2 == (uint **)0x0) goto LAB_00496a9c;
      pcVar53 = *(code **)(puStack_d0 + -0x6cec);
LAB_00496abc:
      param_3 = (char *)ppuStack_170[4];
      ppuStack_2ac = (uint **)ppuStack_170[3];
      param_4 = unaff_s8;
      uVar28 = (*pcVar53)(puStack_2b0);
      iVar24 = (**(code **)(puStack_d0 + -0x789c))(*puStack_2b0);
      if (iVar24 << 0xb < 0) {
        puStack_2b0 = (uint *)(uVar28 >> 0x1f);
      }
      else {
        puStack_2b0 = (uint *)(uint)(uVar28 == 0);
      }
      if (puStack_2b0 != (uint *)0x0) goto LAB_00496e58;
      uVar28 = (**(code **)(puStack_d0 + -0x789c))(unaff_s6);
      if ((uVar28 & 0xf0007) == 6) {
        pcVar53 = *(code **)(puStack_d0 + -0x78e0);
        if (param_2 == (uint **)0x0) {
          ppuStack_170[3] = ppuStack_170[3] + 2;
          ppuStack_170[4] = ppuStack_170[4] + 2;
          ppuStack_170[1] = ppuStack_170[1] + -2;
        }
      }
      else {
        pcVar53 = *(code **)(puStack_d0 + -0x78e0);
      }
      iVar24 = (*pcVar53)(piStack_100[0x21]);
      if (iVar24 == 0) {
        ppuVar26 = (uint **)0x0;
      }
      else {
        uVar25 = (**(code **)(puStack_d0 + -0x78e0))(piStack_100[0x21]);
        ppuVar26 = (uint **)(**(code **)(puStack_d0 + -0x6fa4))(uVar25);
      }
      if ((uint **)unaff_s5 == (uint **)0x1) {
        if (unaff_s7 == (uint *)0x0) goto LAB_00496b64;
        puVar23 = (uint *)0x1;
        if (param_2 == (uint **)0x0) goto LAB_00496c3c;
      }
      else if (param_2 == (uint **)0x0) {
        ppuStack_2ac = ppuStack_170;
        param_3 = unaff_s5;
        puVar23 = (uint *)tls1_cbc_remove_padding(piStack_100);
        param_4 = ppuVar26;
        if (unaff_s7 != (uint *)0x0) {
LAB_00496c3c:
          unaff_s7 = (uint *)((int)ppuStack_170[1] - (int)unaff_s7);
          ppuStack_170[1] = unaff_s7;
        }
      }
      else {
LAB_00496b64:
        puVar23 = (uint *)0x1;
      }
    }
    else {
      if (param_2 != (uint **)0x0) {
        if ((uint **)unaff_s5 == (uint **)0x0) {
          trap(7);
        }
        iVar27 = (int)unaff_s5 - (int)unaff_s8 % (int)unaff_s5;
        iVar24 = iVar27 + -1;
        if (((piStack_100[0x40] & 0x200U) != 0) && ((*(uint *)piStack_100[0x16] & 8) != 0)) {
          iVar24 = iVar27;
        }
        ppuVar26 = (uint **)((int)unaff_s8 + iVar27);
        if ((int)unaff_s8 < (int)ppuVar26) {
          do {
            puVar52 = (undefined *)((int)ppuStack_170[4] + (int)unaff_s8);
            unaff_s8 = (uint **)((int)unaff_s8 + 1);
            *puVar52 = (char)iVar24;
          } while (ppuVar26 != unaff_s8);
        }
        unaff_s7 = (uint *)0x0;
        ppuStack_170[1] = (uint *)((int)ppuStack_170[1] + iVar27);
        goto LAB_00496ab8;
      }
      unaff_s7 = (uint *)0x0;
      ppuVar26 = unaff_s8;
      if (unaff_s8 != (uint **)0x0) goto LAB_00496aa4;
      puVar23 = (uint *)0x0;
    }
  }
LAB_004968fc:
  if (ppuStack_ac == *(uint ***)puStack_f4) {
    return puVar23;
  }
  pcStack_ec = tls1_cert_verify_mac;
  ppuStack_16c = ppuStack_ac;
  (**(code **)(puStack_d0 + -0x5330))();
  piStack_2a8 = (int *)PTR___stack_chk_guard_006a9ae8;
  puVar23 = ppuStack_16c[0x16];
  puStack_130 = &_gp;
  ppuStack_248 = *(uint ***)PTR___stack_chk_guard_006a9ae8;
  ppuStack_338 = (uint **)param_3;
  ppuStack_10c = ppuStack_248;
  ppuStack_104 = ppuStack_170;
  puStack_fc = puStack_2b0;
  ppuStack_f8 = param_2;
  ppuStack_f0 = (uint **)unaff_s5;
  if (puVar23[0x5e] == 0) {
LAB_00496ed4:
    ppuStack_170 = (uint **)0x0;
    puStack_2b0 = (uint *)&DAT_00000018;
    puVar52 = puStack_130;
LAB_00496ee4:
    if (*(int *)(puVar23[0x5f] + (int)ppuStack_170) == 0) {
LAB_00496f18:
      ppuStack_170 = ppuStack_170 + 1;
      if (ppuStack_170 == (uint **)&DAT_00000018) goto LAB_00496f24;
      puVar23 = ppuStack_16c[0x16];
      goto LAB_00496ee4;
    }
    uVar25 = (**(code **)(puVar52 + -0x78e0))();
    ppuVar26 = (uint **)(**(code **)(puStack_130 + -0x7a14))(uVar25);
    puVar52 = puStack_130;
    if (ppuVar26 != ppuStack_2ac) goto LAB_00496f18;
    ppuStack_170 = (uint **)(ppuStack_16c[0x16][0x5f] + (int)ppuStack_170);
    ppuStack_16c = (uint **)*ppuStack_170;
    if (ppuStack_16c != (uint **)0x0) {
      ppuStack_170 = apuStack_124;
      (**(code **)(puStack_130 + -0x7fc4))(ppuStack_170);
      ppuStack_248 = ppuStack_16c;
      iVar24 = (**(code **)(puStack_130 + -0x6cdc))(ppuStack_170);
      if (iVar24 < 1) {
LAB_00496ff4:
        puStack_128 = (uint *)0x0;
      }
      else {
        ppuStack_338 = &puStack_128;
        ppuStack_248 = (uint **)param_3;
        iVar24 = (**(code **)(puStack_130 + -0x785c))(ppuStack_170);
        if (iVar24 < 1) goto LAB_00496ff4;
      }
      (**(code **)(puStack_130 + -0x7fac))(ppuStack_170);
      puVar23 = puStack_128;
      goto LAB_00496f50;
    }
LAB_00496f24:
    ppuStack_338 = (uint **)0x144;
    param_4 = (uint **)&DAT_0064760c;
    uStack_138 = 0x399;
    ppuStack_248 = (uint **)0x11e;
    (**(code **)(puVar52 + -0x6eac))(0x14);
    puVar23 = (uint *)0x0;
  }
  else {
    puVar23 = (uint *)ssl3_digest_cached_records();
    if (puVar23 != (uint *)0x0) {
      puVar23 = ppuStack_16c[0x16];
      goto LAB_00496ed4;
    }
  }
LAB_00496f50:
  if (ppuStack_10c == (uint **)*piStack_2a8) {
    return puVar23;
  }
  pcStack_14c = tls1_final_finish_mac;
  ppuVar54 = ppuStack_10c;
  (**(code **)(puStack_130 + -0x5330))();
  ppiStack_23c = (int **)PTR___stack_chk_guard_006a9ae8;
  piStack_340 = *(int **)PTR___stack_chk_guard_006a9ae8;
  puStack_160 = (undefined *)piStack_2a8;
  puStack_258 = &_gp;
  ppuVar26 = param_4;
  piStack_174 = piStack_340;
  puStack_168 = puStack_2b0;
  ppuStack_164 = ppuStack_2ac;
  ppuStack_15c = (uint **)param_3;
  iStack_158 = unaff_s6;
  puStack_154 = unaff_s7;
  ppuStack_150 = unaff_s8;
  ppuStack_140 = ppuStack_338;
  ppuStack_2a0 = param_4;
  if ((ppuVar54[0x16][0x5e] == 0) ||
     (iVar24 = ssl3_digest_cached_records(), ppuStack_2b4 = ppuVar54, iVar24 != 0)) {
    puStack_238 = auStack_218;
    puVar52 = auStack_1f4;
    puStack_24c = puVar52;
    (**(code **)(puStack_258 + -0x7fc4))(puStack_238);
    iVar24 = 0;
    iStack_240 = 0;
    iStack_250 = 0;
    while (iVar27 = ssl_get_handshake_digest(iVar24,&uStack_228,&uStack_224), iVar27 != 0) {
      uVar28 = ssl_get_algorithm2(ppuVar54);
      if ((uVar28 & uStack_228) == 0) {
        iVar24 = iVar24 + 1;
      }
      else {
        ppuVar29 = (uint **)(**(code **)(puStack_258 + -0x6fa4))(uStack_224);
        if (((*(int *)(ppuVar54[0x16][0x5f] + iVar24 * 4) == 0) || ((int)ppuVar29 < 0)) ||
           (0x80 - iStack_250 < (int)ppuVar29)) {
          iVar24 = iVar24 + 1;
          iStack_240 = 1;
        }
        else {
          iVar27 = (**(code **)(puStack_258 + -0x6cdc))(puStack_238);
          if (((iVar27 == 0) ||
              (iVar27 = (**(code **)(puStack_258 + -0x785c))(puStack_238,puVar52,&ppuStack_22c),
              iVar27 == 0)) || (ppuVar26 = ppuStack_22c, ppuStack_22c != ppuVar29)) {
            iStack_240 = 1;
            ppuVar26 = ppuVar29;
          }
          puVar52 = puVar52 + (int)ppuVar26;
          iVar24 = iVar24 + 1;
          iStack_250 = (int)puVar52 - (int)puStack_24c;
        }
      }
    }
    ppuStack_2ac = &puStack_21c;
    ppuStack_2b4 = (uint **)ssl_get_algorithm2(ppuVar54);
    piStack_2a8 = &iStack_220;
    unaff_s7 = (uint *)0x0;
    puStack_2b0 = ppuVar54[0x30] + 5;
    ppuVar54 = (uint **)ppuVar54[0x30][4];
    iVar24 = 0;
    while (puStack_2b8 = (uint *)ssl_get_handshake_digest(unaff_s7,piStack_2a8,ppuStack_2ac),
          unaff_s8 = ppuStack_140, puStack_2b8 != (uint *)0x0) {
      unaff_s7 = (uint *)((int)unaff_s7 + 1);
      if ((iStack_220 << 10 & (uint)ppuStack_2b4) != 0) {
        iVar24 = iVar24 + 1;
      }
    }
    if (iVar24 == 0) {
      ppuStack_338 = (uint **)0x44;
      ppuVar29 = (uint **)&DAT_0064760c;
      ppuStack_280 = (uint **)0x10a;
      (**(code **)(puStack_258 + -0x6eac))(0x14,0x11c);
      unaff_s8 = ppuVar54;
LAB_0049748c:
      param_3 = (char *)&bStack_200;
      (**(code **)(puStack_258 + -0x7fac))(puStack_238);
      (**(code **)(puStack_258 + -0x7d6c))(puStack_24c,iStack_250);
      piStack_340 = (int *)&SUB_0000000c;
      (**(code **)(puStack_258 + -0x7d6c))(param_3);
    }
    else {
      if (iVar24 == 0) {
        trap(7);
      }
      iStack_244 = (int)ppuVar54 / iVar24;
      *(undefined *)param_4 = 0;
      if (iVar24 == 1) {
        ppuVar54 = (uint **)0x0;
      }
      unaff_s7 = (uint *)0x0;
      *(undefined *)((int)param_4 + 1) = 0;
      *(undefined *)((int)param_4 + 2) = 0;
      *(undefined *)((int)param_4 + 3) = 0;
      *(undefined *)(param_4 + 1) = 0;
      param_3 = (char *)&bStack_200;
      *(undefined *)((int)param_4 + 5) = 0;
      *(undefined *)((int)param_4 + 6) = 0;
      *(undefined *)((int)param_4 + 7) = 0;
      *(undefined *)(param_4 + 2) = 0;
      *(undefined *)((int)param_4 + 9) = 0;
      *(undefined *)((int)param_4 + 10) = 0;
      *(undefined *)((int)param_4 + 0xb) = 0;
      ppuStack_2a0 = (uint **)(((uint)ppuVar54 & 1) + iStack_244);
      ppuStack_338 = ppuStack_2ac;
      puStack_234 = puStack_2b8;
      iVar24 = ssl_get_handshake_digest(0,piStack_2a8);
      ppuVar29 = ppuStack_248;
      puStack_2b8 = puStack_234;
      while (ppuStack_248 = ppuVar29, puStack_234 = puStack_2b8, iVar24 != 0) {
        if ((iStack_220 << 10 & (uint)ppuStack_2b4) != 0) {
          if (puStack_21c == (uint *)0x0) {
            ppuStack_338 = (uint **)0x146;
            ppuVar29 = (uint **)&DAT_0064760c;
            ppuStack_280 = (uint **)0x115;
            (**(code **)(puStack_258 + -0x6eac))(0x14,0x11c);
            goto LAB_0049748c;
          }
          uStack_268 = 0;
          uStack_260 = 0xc;
          uStack_26c = 0;
          uStack_270 = 0;
          uStack_274 = 0;
          ppuStack_280 = unaff_s8;
          ppuStack_338 = ppuStack_2a0;
          puStack_27c = puStack_24c;
          iStack_278 = iStack_250;
          ppuStack_264 = (uint **)param_3;
          iVar24 = tls1_P_hash_constprop_2(puStack_21c,puStack_2b0);
          puStack_2b8 = puStack_234;
          if (iVar24 == 0) goto LAB_0049748c;
          puStack_2b0 = (uint *)((int)puStack_2b0 + iStack_244);
          bVar1 = *(byte *)((int)param_4 + 3) ^ bStack_1fd;
          in_t3 = (uint)bVar1;
          bVar21 = *(byte *)((int)param_4 + 6) ^ bStack_1fa;
          ppuVar26 = (uint **)(uint)bVar21;
          in_t2 = (uint)(*(byte *)(param_4 + 1) ^ bStack_1fc);
          bVar22 = *(byte *)((int)param_4 + 5) ^ bStack_1fb;
          in_t1 = (uint)bVar22;
          *(byte *)param_4 = *(byte *)param_4 ^ bStack_200;
          *(byte *)((int)param_4 + 1) = *(byte *)((int)param_4 + 1) ^ bStack_1ff;
          *(byte *)((int)param_4 + 2) = *(byte *)((int)param_4 + 2) ^ bStack_1fe;
          *(byte *)((int)param_4 + 3) = bVar1;
          *(byte *)(param_4 + 1) = *(byte *)(param_4 + 1) ^ bStack_1fc;
          *(byte *)((int)param_4 + 5) = bVar22;
          *(byte *)((int)param_4 + 6) = bVar21;
          *(byte *)((int)param_4 + 7) = *(byte *)((int)param_4 + 7) ^ bStack_1f9;
          *(byte *)(param_4 + 2) = *(byte *)(param_4 + 2) ^ bStack_1f8;
          *(byte *)((int)param_4 + 9) = *(byte *)((int)param_4 + 9) ^ bStack_1f7;
          *(byte *)((int)param_4 + 10) = *(byte *)((int)param_4 + 10) ^ bStack_1f6;
          *(byte *)((int)param_4 + 0xb) = *(byte *)((int)param_4 + 0xb) ^ bStack_1f5;
        }
        unaff_s7 = (uint *)((int)unaff_s7 + 1);
        ppuStack_338 = ppuStack_2ac;
        iVar24 = ssl_get_handshake_digest(unaff_s7,piStack_2a8);
        ppuVar29 = ppuStack_248;
        puStack_2b8 = puStack_234;
      }
      (**(code **)(puStack_258 + -0x7fac))(puStack_238);
      (**(code **)(puStack_258 + -0x7d6c))(puStack_24c,iStack_250);
      piStack_340 = (int *)&SUB_0000000c;
      (**(code **)(puStack_258 + -0x7d6c))(param_3);
      if (iStack_240 != 0) goto LAB_00497418;
      puStack_2b8 = (uint *)0xc;
      ppuVar29 = ppuVar26;
    }
  }
  else {
LAB_00497418:
    puStack_2b8 = (uint *)0x0;
    ppuVar29 = ppuVar26;
  }
  if (piStack_174 == *ppiStack_23c) {
    return puStack_2b8;
  }
  pcStack_294 = tls1_mac;
  piStack_354 = piStack_174;
  (**(code **)(puStack_258 + -0x5330))();
  puStack_344 = PTR___stack_chk_guard_006a9ae8;
  puStack_308 = &_gp;
  iStack_2bc = *(int *)PTR___stack_chk_guard_006a9ae8;
  iVar24 = piStack_354[0x16];
  ppuStack_350 = (uint **)(iVar24 + 0x10c);
  if (ppuStack_338 == (uint **)0x0) {
    puVar52 = (undefined *)piStack_354[0x21];
    ppuStack_358 = (uint **)(iVar24 + 8);
    uStack_34c = piStack_354[0x1f] & 1;
  }
  else {
    puVar52 = (undefined *)piStack_354[0x24];
    ppuStack_350 = (uint **)(iVar24 + 0x130);
    ppuStack_358 = (uint **)(iVar24 + 0x54);
    uStack_34c = piStack_354[0x1f] & 2;
  }
  pcVar41 = (char *)ppuStack_338;
  ppuStack_2a4 = (uint **)param_3;
  puStack_29c = unaff_s7;
  ppuStack_298 = unaff_s8;
  uVar25 = (*(code *)PTR_EVP_MD_CTX_md_006a7500)(puVar52);
  puStack_2f0 = (uint *)(**(code **)(puStack_308 + -0x6fa4))(uVar25);
  if ((int)puStack_2f0 < 0) {
    pcVar41 = "t >= 0";
    puStack_2fc = puStack_2f0;
    (**(code **)(puStack_308 + -0x7184))(&DAT_0064760c,0x3f4);
    puStack_2f0 = puStack_2fc;
  }
  puStack_348 = puVar52;
  if (uStack_34c == 0) {
    puStack_348 = auStack_2ec;
    iVar24 = (**(code **)(puStack_308 + -0x6be0))(puStack_348,puVar52);
    if (iVar24 == 0) {
      puVar23 = (uint *)0xffffffff;
      goto LAB_0049788c;
    }
  }
  iVar24 = *piStack_354;
  if ((iVar24 == 0xfeff) || (iVar24 == 0x100)) {
    if (ppuStack_338 == (uint **)0x0) {
      uVar2 = *(undefined2 *)(piStack_354[0x17] + 0x208);
      uVar39 = (undefined)((ushort)uVar2 >> 8);
    }
    else {
      uVar2 = *(undefined2 *)(piStack_354[0x17] + 0x20a);
      uVar39 = (undefined)((ushort)uVar2 >> 8);
    }
    auStack_2d4 = (undefined  [4])CONCAT13(uVar39,CONCAT12((char)uVar2,SUB42(auStack_2d4,0)));
    bVar1 = *(byte *)((int)ppuStack_358 + 6);
    in_t0 = (uint)bVar1;
    uVar35 = *(uint *)((int)ppuStack_358 + 2);
    cVar34 = *(char *)((int)ppuStack_358 + 7);
    puVar52 = auStack_2d4 + 2;
    uVar28 = (uint)puVar52 & 3;
    *(uint *)(puVar52 + -uVar28) =
         *(uint *)(puVar52 + -uVar28) & -1 << (4 - uVar28) * 8 | uVar35 >> uVar28 * 8;
    puVar52 = auStack_2d0 + 1;
    uVar28 = (uint)puVar52 & 3;
    *(uint *)(puVar52 + -uVar28) =
         *(uint *)(puVar52 + -uVar28) & 0xffffffffU >> (uVar28 + 1) * 8 | uVar35 << (3 - uVar28) * 8
    ;
    auStack_2d0 = (undefined  [4])CONCAT31(CONCAT21(auStack_2d0._0_2_,bVar1),cVar34);
    puStack_2c8 = (uint *)auStack_2d0;
    puStack_2cc = (uint *)auStack_2d4;
  }
  else {
    puStack_2cc = *ppuStack_358;
    puStack_2c8 = ppuStack_358[1];
  }
  puStack_2fc = ppuStack_350[1];
  unaff_s7 = *ppuStack_350;
  puStack_2f8 = puStack_2f0;
  ppuVar29 = (uint **)((uint)unaff_s7 & 0xff);
  *ppuStack_350 = (uint *)ppuVar29;
  uStack_2c4 = SUB41(unaff_s7,0);
  uStack_2c3 = (undefined)((uint)iVar24 >> 8);
  uStack_2c2 = (undefined)iVar24;
  uStack_2c1 = (undefined)((uint)puStack_2fc >> 8);
  uStack_2c0 = SUB41(puStack_2fc,0);
  if (((ppuStack_338 == (uint **)0x0) &&
      (ppuStack_2f4 = &puStack_2cc, uVar28 = (**(code **)(puStack_308 + -0x6cd8))(piStack_354[0x20])
      , (uVar28 & 0xf0007) == 2)) &&
     (iVar24 = ssl3_cbc_record_digest_supported(puStack_348,ppuStack_2f4), iVar24 != 0)) {
    in_t0 = (uint)unaff_s7 >> 8;
    uStack_30c = 0;
    iStack_314 = piStack_354[0x16] + 0x14;
    uStack_310 = *(undefined4 *)(piStack_354[0x16] + 0x10);
    unaff_s7 = (uint *)((int)puStack_2fc + (int)puStack_2f8 + in_t0);
    pcVar41 = (char *)&puStack_2f0;
    iStack_31c = (int)ppuStack_350[1] + (int)puStack_2f0;
    puStack_320 = ppuStack_350[4];
    ppuVar29 = ppuStack_2f4;
    puStack_318 = unaff_s7;
    iVar24 = ssl3_cbc_digest_record(puStack_348,piStack_340);
joined_r0x004976bc:
    if (0 < iVar24) {
      if (uStack_34c == 0) {
        (**(code **)(puStack_308 + -0x7fac))(auStack_2ec);
      }
      puVar23 = puStack_2f0;
      if (((*piStack_354 != 0xfeff) && (*piStack_354 != 0x100)) &&
         ((((cVar34 = *(char *)((int)ppuStack_358 + 7) + '\x01',
            *(char *)((int)ppuStack_358 + 7) = cVar34, cVar34 == '\0' &&
            ((cVar34 = *(char *)((int)ppuStack_358 + 6) + '\x01',
             *(char *)((int)ppuStack_358 + 6) = cVar34, cVar34 == '\0' &&
             (cVar34 = *(char *)((int)ppuStack_358 + 5) + '\x01',
             *(char *)((int)ppuStack_358 + 5) = cVar34, cVar34 == '\0')))) &&
           (cVar34 = *(char *)(ppuStack_358 + 1), *(char *)(ppuStack_358 + 1) = cVar34 + '\x01',
           (char)(cVar34 + '\x01') == '\0')) &&
          (((cVar34 = *(char *)((int)ppuStack_358 + 3) + '\x01',
            *(char *)((int)ppuStack_358 + 3) = cVar34, cVar34 == '\0' &&
            (cVar34 = *(char *)((int)ppuStack_358 + 2) + '\x01',
            *(char *)((int)ppuStack_358 + 2) = cVar34, cVar34 == '\0')) &&
           (cVar34 = *(char *)((int)ppuStack_358 + 1) + '\x01',
           *(char *)((int)ppuStack_358 + 1) = cVar34, cVar34 == '\0')))))) {
        *(char *)ppuStack_358 = *(char *)ppuStack_358 + '\x01';
      }
      goto LAB_0049788c;
    }
  }
  else {
    pcVar41 = &DAT_0000000d;
    iVar24 = (**(code **)(puStack_308 + -0x7860))(puStack_348);
    if (0 < iVar24) {
      pcVar41 = (char *)ppuStack_350[1];
      iVar24 = (**(code **)(puStack_308 + -0x7860))(puStack_348,ppuStack_350[4]);
      if (0 < iVar24) {
        pcVar41 = (char *)&puStack_2f0;
        iVar24 = (**(code **)(puStack_308 + -0x7910))(puStack_348,piStack_340);
        goto joined_r0x004976bc;
      }
    }
  }
  if (uStack_34c == 0) {
    (**(code **)(puStack_308 + -0x7fac))(auStack_2ec);
  }
  puVar23 = (uint *)0xffffffff;
LAB_0049788c:
  if (iStack_2bc == *(int *)puStack_344) {
    return puVar23;
  }
  pcStack_334 = tls1_generate_master_secret;
  iVar24 = iStack_2bc;
  (**(code **)(puStack_308 + -0x5330))();
  puVar52 = PTR___stack_chk_guard_006a9ae8;
  uStack_35c = *(uint *)PTR___stack_chk_guard_006a9ae8;
  ppuVar26 = ppuVar29;
  puStack_33c = unaff_s7;
  uVar28 = ssl_get_algorithm2();
  iVar55 = *(int *)(iVar24 + 0xc0);
  iVar51 = 0;
  iVar27 = *(int *)(iVar24 + 0x58) + 0xc0;
  puVar23 = (uint *)(iVar55 + 0x14);
  iVar24 = 0;
  while (iVar30 = ssl_get_handshake_digest(iVar51,&iStack_394,&iStack_390), iVar30 != 0) {
    iVar51 = iVar51 + 1;
    if ((iStack_394 << 10 & uVar28) != 0) {
      iVar24 = iVar24 + 1;
    }
  }
  if (iVar24 == 0) {
    piVar42 = (int *)0x44;
    ppuVar26 = (uint **)&DAT_0064760c;
    uStack_3e8 = 0x10a;
    (*(code *)PTR_ERR_put_error_006a7f34)(0x14,0x11c);
  }
  else {
    if (iVar24 == 0) {
      trap(7);
    }
    iVar51 = (int)ppuVar29 / iVar24;
    if (iVar24 == 1) {
      ppuVar29 = (uint **)0x0;
    }
    (*(code *)PTR_memset_006a99f4)(puVar23,0,0x30);
    iVar24 = 0;
    pcStack_3a8 = "master secret";
    piVar42 = &iStack_390;
    iVar30 = ssl_get_handshake_digest(0,&iStack_394);
    while (iVar30 != 0) {
      if ((iStack_394 << 10 & uVar28) != 0) {
        if (iStack_390 == 0) {
          piVar42 = (int *)0x146;
          ppuVar26 = (uint **)&DAT_0064760c;
          uStack_3e8 = 0x115;
          (*(code *)PTR_ERR_put_error_006a7f34)(0x14,0x11c);
          break;
        }
        uStack_3e0 = 0x20;
        iStack_3dc = 0;
        uStack_3e8 = 0xd;
        piVar42 = (int *)(((uint)ppuVar29 & 1) + iVar51);
        ppuVar26 = (uint **)pcStack_3a8;
        iVar30 = tls1_P_hash_constprop_2(iStack_390,pcVar41);
        iStack_3e4 = iVar27;
        if (iVar30 == 0) break;
        pcVar41 = (char *)((int)pcVar41 + iVar51);
        puVar33 = &uStack_38c;
        puVar36 = puVar23;
        if (((uint)puVar23 & 3) == 0 &&
            ((uint *)(iVar55 + 0x18) <= &uStack_38c || &uStack_388 <= puVar23)) {
          *(uint *)(iVar55 + 0x14) = *(uint *)(iVar55 + 0x14) ^ uStack_38c;
          *(uint *)(iVar55 + 0x18) = uStack_388 ^ *(uint *)(iVar55 + 0x18);
          ppuVar26 = (uint **)(uStack_374 ^ *(uint *)(iVar55 + 0x2c));
          in_t3 = uStack_378 ^ *(uint *)(iVar55 + 0x28);
          *(uint *)(iVar55 + 0x1c) = uStack_384 ^ *(uint *)(iVar55 + 0x1c);
          *(uint *)(iVar55 + 0x20) = uStack_380 ^ *(uint *)(iVar55 + 0x20);
          *(uint *)(iVar55 + 0x24) = uStack_37c ^ *(uint *)(iVar55 + 0x24);
          *(uint *)(iVar55 + 0x28) = in_t3;
          *(uint ***)(iVar55 + 0x2c) = ppuVar26;
          *(uint *)(iVar55 + 0x30) = uStack_370 ^ *(uint *)(iVar55 + 0x30);
          *(uint *)(iVar55 + 0x38) = uStack_368 ^ *(uint *)(iVar55 + 0x38);
          *(uint *)(iVar55 + 0x34) = uStack_36c ^ *(uint *)(iVar55 + 0x34);
          *(uint *)(iVar55 + 0x3c) = uStack_364 ^ *(uint *)(iVar55 + 0x3c);
          *(uint *)(iVar55 + 0x40) = *(uint *)(iVar55 + 0x40) ^ uStack_360;
        }
        else {
          do {
            puVar31 = (uint *)((int)puVar33 + 1);
            *(byte *)puVar36 = *(byte *)puVar36 ^ *(byte *)puVar33;
            puVar33 = puVar31;
            puVar36 = (uint *)((int)puVar36 + 1);
          } while (puVar31 != &uStack_35c);
        }
      }
      iVar24 = iVar24 + 1;
      piVar42 = &iStack_390;
      iVar30 = ssl_get_handshake_digest(iVar24,&iStack_394);
    }
  }
  uVar25 = 0x30;
  (*(code *)PTR_OPENSSL_cleanse_006a7074)(&uStack_38c);
  if (uStack_35c == *(uint *)puVar52) {
    return (uint *)0x30;
  }
  uVar28 = uStack_35c;
  (*(code *)PTR___stack_chk_fail_006a9ab0)();
  ppuVar54 = ppuVar26;
  iVar24 = (*(code *)PTR_CRYPTO_malloc_006a7008)(piVar42,&DAT_0064760c,0x4a2);
  if (iVar24 == 0) {
    puVar23 = (uint *)0x0;
    (*(code *)PTR_ERR_put_error_006a7f34)(0x14,0x13a,0x41,&DAT_0064760c,0x4ec);
  }
  else {
    iVar27 = uStack_3e8 + 0x40;
    if (iStack_3dc == 0) {
      iVar55 = (*(code *)PTR_CRYPTO_malloc_006a7008)(iVar27,&DAT_0064760c,0x4b0);
      iVar51 = iVar27;
    }
    else {
      iVar51 = uStack_3e0 + 2 + iVar27;
      iVar55 = (*(code *)PTR_CRYPTO_malloc_006a7008)(iVar51,&DAT_0064760c,0x4b0);
    }
    if (iVar55 == 0) {
      (*(code *)PTR_ERR_put_error_006a7f34)(0x14,0x13a,0x41,&DAT_0064760c,0x4ec);
      (*(code *)PTR_CRYPTO_free_006a6e88)(iVar24);
      return (uint *)0x0;
    }
    uVar43 = uStack_3e8;
    (*(code *)PTR_memcpy_006a9aec)(iVar55);
    puVar33 = (uint *)(iVar55 + uStack_3e8);
    iVar37 = *(int *)(uVar28 + 0x58);
    puVar23 = (uint *)(iVar55 + uStack_3e8 + 0x20);
    uVar50 = *(uint *)(iVar37 + 0xc0);
    uVar35 = iVar37 + 0xc4U & 3;
    uVar3 = iVar37 + 200U & 3;
    uVar4 = iVar37 + 0xccU & 3;
    uVar5 = iVar37 + 0xd0U & 3;
    uVar6 = iVar37 + 0xd4U & 3;
    uVar7 = iVar37 + 0xd8U & 3;
    iVar30 = *(int *)((iVar37 + 0xd8U) - uVar7);
    uVar8 = iVar37 + 0xdcU & 3;
    iVar9 = *(int *)((iVar37 + 0xdcU) - uVar8);
    uVar12 = iVar37 + 199U & 3;
    uVar49 = (*(int *)((iVar37 + 0xc4U) - uVar35) << uVar35 * 8 |
             in_t3 & 0xffffffffU >> (4 - uVar35) * 8) & -1 << (uVar12 + 1) * 8 |
             *(uint *)((iVar37 + 199U) - uVar12) >> (3 - uVar12) * 8;
    uVar35 = iVar37 + 0xcbU & 3;
    uVar48 = (*(int *)((iVar37 + 200U) - uVar3) << uVar3 * 8 |
             in_t2 & 0xffffffffU >> (4 - uVar3) * 8) & -1 << (uVar35 + 1) * 8 |
             *(uint *)((iVar37 + 0xcbU) - uVar35) >> (3 - uVar35) * 8;
    uVar35 = iVar37 + 0xcfU & 3;
    uVar47 = (*(int *)((iVar37 + 0xccU) - uVar4) << uVar4 * 8 |
             in_t1 & 0xffffffffU >> (4 - uVar4) * 8) & -1 << (uVar35 + 1) * 8 |
             *(uint *)((iVar37 + 0xcfU) - uVar35) >> (3 - uVar35) * 8;
    uVar35 = iVar37 + 0xd3U & 3;
    uVar46 = (*(int *)((iVar37 + 0xd0U) - uVar5) << uVar5 * 8 |
             in_t0 & 0xffffffffU >> (4 - uVar5) * 8) & -1 << (uVar35 + 1) * 8 |
             *(uint *)((iVar37 + 0xd3U) - uVar35) >> (3 - uVar35) * 8;
    uVar35 = iVar37 + 0xd7U & 3;
    uVar45 = (*(int *)((iVar37 + 0xd4U) - uVar6) << uVar6 * 8 |
             (uint)ppuVar54 & 0xffffffffU >> (4 - uVar6) * 8) & -1 << (uVar35 + 1) * 8 |
             *(uint *)((iVar37 + 0xd7U) - uVar35) >> (3 - uVar35) * 8;
    uVar35 = iVar37 + 0xdbU & 3;
    uVar4 = *(uint *)((iVar37 + 0xdbU) - uVar35);
    uVar3 = iVar37 + 0xdfU & 3;
    uVar5 = *(uint *)((iVar37 + 0xdfU) - uVar3);
    *puVar33 = uVar50;
    puVar33[1] = uVar49;
    puVar33[2] = uVar48;
    puVar33[3] = uVar47;
    puVar33[4] = uVar46;
    puVar33[5] = uVar45;
    puVar33[6] = (iVar30 << uVar7 * 8 | uVar43 & 0xffffffffU >> (4 - uVar7) * 8) &
                 -1 << (uVar35 + 1) * 8 | uVar4 >> (3 - uVar35) * 8;
    puVar33[7] = (iVar9 << uVar8 * 8 | (uint)ppuVar26 & 0xffffffffU >> (4 - uVar8) * 8) &
                 -1 << (uVar3 + 1) * 8 | uVar5 >> (3 - uVar3) * 8;
    iVar38 = *(int *)(uVar28 + 0x58);
    uVar35 = iVar38 + 0xa0U & 3;
    uVar3 = iVar38 + 0xa4U & 3;
    iVar30 = *(int *)((iVar38 + 0xa4U) - uVar3);
    uVar4 = iVar38 + 0xa8U & 3;
    iVar9 = *(int *)((iVar38 + 0xa8U) - uVar4);
    uVar5 = iVar38 + 0xacU & 3;
    iVar37 = *(int *)((iVar38 + 0xacU) - uVar5);
    uVar6 = iVar38 + 0xb0U & 3;
    iVar10 = *(int *)((iVar38 + 0xb0U) - uVar6);
    uVar7 = iVar38 + 0xb4U & 3;
    iVar11 = *(int *)((iVar38 + 0xb4U) - uVar7);
    uVar8 = iVar38 + 0xa3U & 3;
    uVar12 = iVar38 + 0xa7U & 3;
    uVar16 = *(uint *)((iVar38 + 0xa7U) - uVar12);
    uVar43 = iVar38 + 0xabU & 3;
    uVar17 = *(uint *)((iVar38 + 0xabU) - uVar43);
    uVar13 = iVar38 + 0xafU & 3;
    uVar18 = *(uint *)((iVar38 + 0xafU) - uVar13);
    uVar14 = iVar38 + 0xb3U & 3;
    uVar19 = *(uint *)((iVar38 + 0xb3U) - uVar14);
    uVar15 = iVar38 + 0xb7U & 3;
    uVar20 = *(uint *)((iVar38 + 0xb7U) - uVar15);
    uVar44 = *(uint *)(iVar38 + 0xb8);
    uVar40 = *(uint *)(iVar38 + 0xbc);
    *puVar23 = (*(int *)((iVar38 + 0xa0U) - uVar35) << uVar35 * 8 |
               uVar50 & 0xffffffffU >> (4 - uVar35) * 8) & -1 << (uVar8 + 1) * 8 |
               *(uint *)((iVar38 + 0xa3U) - uVar8) >> (3 - uVar8) * 8;
    puVar23[1] = (iVar30 << uVar3 * 8 | uVar49 & 0xffffffffU >> (4 - uVar3) * 8) &
                 -1 << (uVar12 + 1) * 8 | uVar16 >> (3 - uVar12) * 8;
    puVar23[2] = (iVar9 << uVar4 * 8 | uVar48 & 0xffffffffU >> (4 - uVar4) * 8) &
                 -1 << (uVar43 + 1) * 8 | uVar17 >> (3 - uVar43) * 8;
    puVar23[3] = (iVar37 << uVar5 * 8 | uVar47 & 0xffffffffU >> (4 - uVar5) * 8) &
                 -1 << (uVar13 + 1) * 8 | uVar18 >> (3 - uVar13) * 8;
    puVar23[4] = (iVar10 << uVar6 * 8 | uVar46 & 0xffffffffU >> (4 - uVar6) * 8) &
                 -1 << (uVar14 + 1) * 8 | uVar19 >> (3 - uVar14) * 8;
    puVar23[5] = (iVar11 << uVar7 * 8 | uVar45 & 0xffffffffU >> (4 - uVar7) * 8) &
                 -1 << (uVar15 + 1) * 8 | uVar20 >> (3 - uVar15) * 8;
    puVar23[6] = uVar44;
    puVar23[7] = uVar40;
    if (iStack_3dc != 0) {
      *(char *)(iVar55 + iVar27) = (char)((uint)uStack_3e0 >> 8);
      *(undefined *)((int)puVar33 + 0x41) = (undefined)uStack_3e0;
      if ((uStack_3e0 != 0) || (iStack_3e4 != 0)) {
        (*(code *)PTR_memcpy_006a9aec)(iVar55 + uStack_3e8 + 0x42,iStack_3e4,uStack_3e0);
      }
    }
    iVar27 = (*(code *)PTR_memcmp_006a9ad0)(iVar55,"client finished",0xf);
    if (((iVar27 == 0) ||
        (iVar27 = (*(code *)PTR_memcmp_006a9ad0)(iVar55,"server finished",0xf), iVar27 == 0)) ||
       ((iVar27 = (*(code *)PTR_memcmp_006a9ad0)(iVar55,"master secret",0xd), iVar27 == 0 ||
        (iVar27 = (*(code *)PTR_memcmp_006a9ad0)(iVar55,"key expansion",0xd), iVar27 == 0)))) {
      puVar23 = (uint *)0x0;
      (*(code *)PTR_ERR_put_error_006a7f34)(0x14,0x13a,0x16f,&DAT_0064760c,0x4e8);
    }
    else {
      uVar32 = ssl_get_algorithm2(uVar28);
      puVar23 = (uint *)tls1_PRF_constprop_1
                                  (uVar32,iVar55,iVar51,0,0,0,0,0,0,*(int *)(uVar28 + 0xc0) + 0x14,
                                   *(undefined4 *)(*(int *)(uVar28 + 0xc0) + 0x10),uVar25,iVar24,
                                   piVar42);
      (*(code *)PTR_OPENSSL_cleanse_006a7074)(iVar55,iVar51);
      (*(code *)PTR_OPENSSL_cleanse_006a7074)(iVar24,piVar42);
    }
    (*(code *)PTR_CRYPTO_free_006a6e88)(iVar24);
    (*(code *)PTR_CRYPTO_free_006a6e88)(iVar55);
  }
  return puVar23;
}

