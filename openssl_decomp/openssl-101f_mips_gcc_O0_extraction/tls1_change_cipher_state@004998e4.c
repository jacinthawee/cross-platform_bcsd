
/* WARNING: Type propagation algorithm not settling */
/* WARNING: Could not reconcile some variable overlaps */

uint tls1_change_cipher_state(uint *param_1,uint param_2)

{
  bool bVar1;
  byte bVar2;
  undefined2 uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  byte bVar22;
  uint uVar23;
  uint *puVar24;
  int iVar25;
  undefined4 uVar26;
  int iVar27;
  int iVar28;
  int iVar29;
  uint *puVar30;
  char cVar32;
  uint *puVar31;
  byte *pbVar33;
  undefined uVar37;
  uint uVar34;
  int iVar35;
  int iVar36;
  uint uVar38;
  char *pcVar39;
  int *piVar40;
  uint uVar41;
  uint uVar42;
  undefined4 *puVar43;
  undefined4 *puVar44;
  uint uVar45;
  uint *in_t0;
  uint uVar46;
  uint in_t1;
  uint uVar47;
  uint *in_t2;
  uint uVar48;
  uint in_t3;
  uint uVar49;
  uint uVar50;
  undefined *puVar51;
  uint *unaff_s4;
  byte *pbVar52;
  uint *puVar53;
  code *pcVar54;
  int iVar55;
  uint uStack_540;
  int iStack_53c;
  undefined4 uStack_538;
  int iStack_534;
  char *pcStack_500;
  uint uStack_4ec;
  int iStack_4e8;
  uint uStack_4e4;
  uint uStack_4e0;
  uint uStack_4dc;
  uint uStack_4d8;
  uint uStack_4d4;
  uint uStack_4d0;
  uint uStack_4cc;
  uint uStack_4c8;
  uint uStack_4c4;
  uint uStack_4c0;
  uint uStack_4bc;
  uint uStack_4b8;
  uint uStack_4b4;
  undefined4 *puStack_4b0;
  int *piStack_4ac;
  uint *puStack_4a8;
  undefined *puStack_4a4;
  uint uStack_4a0;
  undefined *puStack_49c;
  int *piStack_498;
  uint uStack_494;
  uint *puStack_490;
  code *pcStack_48c;
  uint uStack_478;
  int iStack_474;
  int iStack_470;
  int iStack_46c;
  undefined4 uStack_468;
  undefined4 uStack_464;
  undefined *puStack_460;
  uint uStack_454;
  uint uStack_450;
  undefined4 *puStack_44c;
  uint uStack_448;
  undefined auStack_444 [24];
  undefined auStack_42c [4];
  undefined auStack_428 [4];
  undefined4 uStack_424;
  undefined4 uStack_420;
  undefined uStack_41c;
  undefined uStack_41b;
  undefined uStack_41a;
  undefined uStack_419;
  undefined uStack_418;
  int iStack_414;
  uint *puStack_410;
  uint uStack_40c;
  int *piStack_408;
  uint *puStack_404;
  int *piStack_400;
  uint *puStack_3fc;
  uint *puStack_3f8;
  uint uStack_3f4;
  uint *puStack_3f0;
  code *pcStack_3ec;
  uint *puStack_3d8;
  uint *puStack_3d4;
  int iStack_3d0;
  undefined4 uStack_3cc;
  undefined4 uStack_3c8;
  undefined4 uStack_3c4;
  undefined4 uStack_3c0;
  uint *puStack_3bc;
  undefined4 uStack_3b8;
  undefined *puStack_3b0;
  int iStack_3a8;
  uint *puStack_3a4;
  uint *puStack_3a0;
  int iStack_39c;
  int **ppiStack_398;
  undefined *puStack_394;
  uint *puStack_390;
  uint uStack_38c;
  int iStack_384;
  uint uStack_380;
  undefined4 uStack_37c;
  int iStack_378;
  uint uStack_374;
  undefined auStack_370 [24];
  byte bStack_358;
  byte bStack_357;
  byte bStack_356;
  byte bStack_355;
  byte bStack_354;
  byte bStack_353;
  byte bStack_352;
  byte bStack_351;
  byte bStack_350;
  byte bStack_34f;
  byte bStack_34e;
  byte bStack_34d;
  uint auStack_34c [32];
  int *piStack_2cc;
  uint *puStack_2c8;
  uint uStack_2c4;
  int *piStack_2c0;
  uint *puStack_2bc;
  undefined *puStack_2b8;
  uint *puStack_2b4;
  undefined *puStack_2b0;
  uint uStack_2ac;
  uint *puStack_2a8;
  code *pcStack_2a4;
  uint *puStack_298;
  undefined4 uStack_290;
  undefined *puStack_288;
  uint uStack_280;
  uint auStack_27c [6];
  uint *puStack_264;
  uint *puStack_25c;
  int *piStack_258;
  int *piStack_254;
  char *pcStack_250;
  undefined *puStack_24c;
  char *pcStack_248;
  code *pcStack_244;
  undefined4 uStack_230;
  undefined *puStack_228;
  undefined auStack_220 [4];
  undefined auStack_21c [8];
  uint uStack_214;
  uint uStack_210;
  undefined uStack_20c;
  undefined uStack_20b;
  undefined uStack_20a;
  undefined uStack_209;
  undefined uStack_208;
  uint uStack_204;
  uint uStack_200;
  undefined *puStack_1fc;
  uint *puStack_1f8;
  uint uStack_1f4;
  uint *puStack_1f0;
  uint *puStack_1ec;
  undefined *puStack_1e8;
  uint uStack_1e4;
  uint *puStack_1e0;
  code *pcStack_1dc;
  int *piStack_1c8;
  uint *puStack_1c4;
  undefined4 uStack_1c0;
  undefined4 uStack_1bc;
  undefined4 uStack_1b8;
  int iStack_1b4;
  undefined4 uStack_1b0;
  uint *puStack_1ac;
  uint uStack_1a8;
  uint *puStack_1a4;
  undefined *puStack_1a0;
  uint uStack_194;
  undefined4 uStack_190;
  undefined4 uStack_18c;
  uint uStack_188;
  undefined4 uStack_184;
  int iStack_180;
  int *piStack_17c;
  uint uStack_174;
  uint uStack_170;
  uint *puStack_16c;
  uint uStack_168;
  uint *puStack_164;
  uint *puStack_160;
  code *pcStack_15c;
  uint *local_148;
  uint local_144;
  uint *local_140;
  undefined4 local_13c;
  undefined4 local_138;
  uint *local_134;
  uint *local_130;
  uint *local_12c;
  uint *local_128;
  int local_124;
  undefined *local_120;
  uint *local_114;
  uint **local_110;
  uint *local_10c;
  uint *local_108;
  uint *local_104;
  uint *local_100;
  uint local_fc;
  undefined4 local_f8;
  int local_f4;
  uint auStack_ec [8];
  uint auStack_cc [8];
  uint auStack_ac [16];
  uint auStack_6c [16];
  uint local_2c;
  
  puStack_2b0 = PTR___stack_chk_guard_006aabf0;
  uVar23 = param_1[0x16];
  local_fc = *(uint *)(uVar23 + 0x380);
  uStack_3f4 = param_2 & 1;
  puStack_1f8 = *(uint **)(*(int *)(uVar23 + 0x344) + 0x20);
  local_f8 = *(undefined4 *)(uVar23 + 900);
  uStack_174 = *(uint *)(uVar23 + 0x37c);
  pcStack_248 = *(char **)(uVar23 + 0x38c);
  local_114 = (uint *)((uint)puStack_1f8 & 2);
  local_2c = *(uint *)PTR___stack_chk_guard_006aabf0;
  local_120 = &_gp;
  uVar23 = *(uint *)(*(int *)(uVar23 + 0x344) + 0x24) & 4;
  if (uStack_3f4 == 0) {
    if (uVar23 == 0) {
      uVar23 = param_1[0x1f] & 0xfffffffd;
    }
    else {
      uVar23 = param_1[0x1f] | 2;
    }
    uStack_1f4 = param_1[0x23];
    param_1[0x1f] = uVar23;
    if ((uStack_1f4 != 0) && (unaff_s4 = (uint *)0x1, *(int *)param_1[2] != 0xfeff)) {
LAB_00499cac:
      local_100 = (uint *)ssl_replace_hash(param_1 + 0x24,0);
LAB_00499cc4:
      if (param_1[0x25] != 0) {
        (**(code **)(local_120 + -0x6cd0))();
        param_1[0x25] = 0;
      }
      if ((uint *)pcStack_248 != (uint *)0x0) {
        uVar23 = (**(code **)(local_120 + -0x6ccc))(*(uint *)((int)pcStack_248 + 8));
        param_1[0x25] = uVar23;
        if (uVar23 == 0) {
          pcVar39 = (char *)0x8e;
          puStack_3fc = (uint *)&DAT_00647bcc;
          local_148 = (uint *)0x1ba;
          pcStack_250 = (char *)0xd1;
          (**(code **)(local_120 + -0x6eb0))(0x14);
          goto LAB_00499c3c;
        }
      }
      if (*param_1 != 0xfeff) {
        uVar23 = param_1[0x16];
        *(undefined *)(uVar23 + 0x54) = 0;
        *(undefined *)(uVar23 + 0x55) = 0;
        *(undefined *)(uVar23 + 0x56) = 0;
        *(undefined *)(uVar23 + 0x57) = 0;
        *(undefined *)(uVar23 + 0x58) = 0;
        *(undefined *)(uVar23 + 0x59) = 0;
        *(undefined *)(uVar23 + 0x5a) = 0;
        *(undefined *)(uVar23 + 0x5b) = 0;
      }
      pcStack_248 = (char *)param_1[0x16];
      local_108 = (uint *)((int)pcStack_248 + 0x60);
      local_110 = (uint **)((int)pcStack_248 + 0x5c);
      goto joined_r0x00499d40;
    }
    uStack_1f4 = (*(code *)PTR_EVP_CIPHER_CTX_new_006a9324)();
    param_1[0x23] = uStack_1f4;
    if (uStack_1f4 != 0) {
      if (*(int *)param_1[2] != 0xfeff) {
        unaff_s4 = (uint *)0x0;
        goto LAB_00499cac;
      }
      local_100 = (uint *)(**(code **)(local_120 + -0x6d1c))();
      if (local_100 == (uint *)0x0) goto LAB_0049a0a8;
      param_1[0x24] = (uint)local_100;
      unaff_s4 = (uint *)0x0;
      goto LAB_00499cc4;
    }
LAB_0049a0a8:
    puStack_3fc = (uint *)&DAT_00647bcc;
    pcVar39 = &DAT_00000041;
    pcStack_250 = (char *)0xd1;
    local_148 = (uint *)0x242;
    uStack_3f4 = 0;
    (**(code **)(local_120 + -0x6eb0))(0x14);
  }
  else {
    if (uVar23 == 0) {
      uVar23 = param_1[0x1f] & 0xfffffffe;
    }
    else {
      uVar23 = param_1[0x1f] | 1;
    }
    uStack_1f4 = param_1[0x20];
    param_1[0x1f] = uVar23;
    if (uStack_1f4 == 0) {
      uVar23 = (*(code *)PTR_CRYPTO_malloc_006a8108)(0x8c,&DAT_00647bcc,0x179);
      param_1[0x20] = uVar23;
      if (uVar23 == 0) goto LAB_0049a0a8;
      unaff_s4 = (uint *)0x0;
      (**(code **)(local_120 + -0x7390))(uVar23);
      uStack_1f4 = param_1[0x20];
    }
    else {
      unaff_s4 = (uint *)0x1;
    }
    local_100 = (uint *)ssl_replace_hash(param_1 + 0x21,0);
    if (param_1[0x22] != 0) {
      (**(code **)(local_120 + -0x6cd0))();
      param_1[0x22] = 0;
    }
    if ((uint *)pcStack_248 == (uint *)0x0) {
      pcStack_248 = (char *)param_1[0x16];
LAB_004999ec:
      if (*param_1 != 0xfeff) {
        *(byte *)((int)pcStack_248 + 8) = 0;
        *(byte *)((int)pcStack_248 + 9) = 0;
        *(byte *)((int)pcStack_248 + 10) = 0;
        *(byte *)((int)pcStack_248 + 0xb) = 0;
        *(byte *)((int)pcStack_248 + 0xc) = 0;
        *(byte *)((int)pcStack_248 + 0xd) = 0;
        *(byte *)((int)pcStack_248 + 0xe) = 0;
        *(byte *)((int)pcStack_248 + 0xf) = 0;
        pcStack_248 = (char *)param_1[0x16];
      }
      local_108 = (uint *)((int)pcStack_248 + 0x14);
      local_110 = (uint **)((int)pcStack_248 + 0x10);
joined_r0x00499d40:
      if (unaff_s4 != (uint *)0x0) {
        (**(code **)(local_120 + -0x7380))(uStack_1f4);
        pcStack_248 = (char *)param_1[0x16];
      }
      puStack_1f8 = *(uint **)((int)pcStack_248 + 0x388);
      pcVar54 = *(code **)(local_120 + -0x6ea4);
      pbVar52 = *(byte **)((int)pcStack_248 + 0x378);
      *local_110 = puStack_1f8;
      unaff_s4 = (uint *)(*pcVar54)(uStack_174);
      if (local_114 != (uint *)0x0) {
        puVar24 = (uint *)&DAT_00000005;
        if (((*(uint *)(*(int *)(param_1[0x16] + 0x344) + 0x20) & 8) == 0) &&
           (puVar24 = (uint *)&DAT_00000008, *(int *)(*(int *)(param_1[0x16] + 0x344) + 0x14) != 1))
        {
          puVar24 = (uint *)&DAT_00000007;
        }
        if ((int)puVar24 < (int)unaff_s4) {
          unaff_s4 = puVar24;
        }
      }
      uVar23 = (**(code **)(local_120 + -0x6c70))(uStack_174);
      if ((uVar23 & 0xf0007) == 6) {
        puVar24 = (uint *)&SUB_00000004;
        if (param_2 != 0x12) goto LAB_00499ad4;
LAB_00499d84:
        local_10c = (uint *)(pbVar52 + (int)puStack_1f8 * 2);
        iVar25 = (int)unaff_s4 * 2 + (int)puStack_1f8 * 2;
        local_104 = (uint *)(pbVar52 + iVar25);
        local_f4 = 1;
        pcStack_248 = "client write key";
        if (*(int *)(param_1[0x16] + 0x374) < (int)puVar24 * 2 + iVar25) {
LAB_00499dcc:
          pcVar54 = *(code **)(local_120 + -0x6eb0);
          pcVar39 = (char *)0x44;
          local_148 = (uint *)0x1ec;
          goto LAB_00499de0;
        }
      }
      else {
        puVar24 = (uint *)(**(code **)(local_120 + -0x7884))(uStack_174);
        if (param_2 == 0x12) goto LAB_00499d84;
LAB_00499ad4:
        pbVar33 = (byte *)((int)unaff_s4 + (int)puStack_1f8 * 2);
        if (param_2 == 0x21) goto LAB_00499d84;
        local_f4 = 0;
        local_10c = (uint *)(pbVar33 + (int)pbVar52);
        local_104 = (uint *)((byte *)((int)puVar24 + (int)unaff_s4) + (int)pbVar33 + (int)pbVar52);
        pcStack_248 = "server write key";
        pbVar52 = pbVar52 + (int)puStack_1f8;
        if (*(int *)(param_1[0x16] + 0x374) <
            (int)((int)puVar24 + (int)((byte *)((int)puVar24 + (int)unaff_s4) + (int)pbVar33)))
        goto LAB_00499dcc;
      }
      (**(code **)(local_120 + -0x52ec))(local_108,pbVar52,puStack_1f8);
      iVar25 = (**(code **)(local_120 + -0x6c70))(uStack_174);
      if (-1 < iVar25 << 10) {
        local_148 = (uint *)(**(code **)(local_120 + -0x78f4))(local_f8,0,local_108,*local_110);
        puVar53 = local_100;
        local_100 = local_148;
        (**(code **)(local_120 + -0x7fc0))(puVar53,0,local_fc,0);
        in_t0 = local_100;
        (**(code **)(local_120 + -0x7f68))(local_100);
      }
      bVar1 = local_114 != (uint *)0x0;
      local_114 = auStack_6c;
      puVar53 = local_10c;
      if (bVar1) {
        puStack_1f8 = auStack_ac;
        local_100 = (uint *)ssl_get_algorithm2(param_1);
        local_fc = param_1[0x16];
        local_124 = (**(code **)(local_120 + -0x6ea4))(uStack_174);
        local_134 = local_10c;
        pcVar39 = &SUB_00000010;
        in_t1 = local_fc + 0xa0;
        puStack_3fc = (uint *)(local_fc + 0xc0);
        local_140 = (uint *)&DAT_00000020;
        local_148 = (uint *)&DAT_00000020;
        local_128 = local_114;
        local_138 = 0;
        local_13c = 0;
        local_10c = (uint *)&DAT_00000020;
        pcStack_250 = pcStack_248;
        in_t2 = local_100;
        local_144 = in_t1;
        local_130 = unaff_s4;
        local_12c = puStack_1f8;
        iVar25 = tls1_PRF_constprop_1(local_100);
        in_t0 = local_10c;
        if (iVar25 == 0) goto LAB_00499df4;
        puVar53 = puStack_1f8;
        if (0 < (int)puVar24) {
          pcStack_248 = (char *)auStack_cc;
          unaff_s4 = auStack_ec;
          uVar26 = ssl_get_algorithm2(param_1);
          local_124 = (int)puVar24 << 1;
          pcVar39 = &DAT_00000008;
          in_t1 = param_1[0x16] + 0xa0;
          puStack_3fc = (uint *)(param_1[0x16] + 0xc0);
          local_134 = (uint *)&empty_15910;
          pcStack_250 = "IV block";
          local_130 = (uint *)0x0;
          local_138 = 0;
          local_13c = 0;
          local_140 = local_10c;
          local_148 = local_10c;
          in_t0 = local_10c;
          local_144 = in_t1;
          local_12c = unaff_s4;
          local_128 = (uint *)pcStack_248;
          iVar25 = tls1_PRF_constprop_1(uVar26);
          if (iVar25 == 0) goto LAB_00499df4;
          local_104 = (uint *)((int)unaff_s4 + (int)puVar24);
          puVar53 = puStack_1f8;
          if (local_f4 != 0) {
            puVar53 = puStack_1f8;
            local_104 = unaff_s4;
          }
        }
      }
      local_10c = puVar53;
      pcStack_248 = (char *)auStack_cc;
      unaff_s4 = auStack_ec;
      puStack_1f8 = auStack_ac;
      pcVar54 = *(code **)(local_120 + -0x6c70);
      param_2 = param_2 & 2;
      *(undefined4 *)(param_1[0x30] + 4) = 0;
      uVar23 = (*pcVar54)(uStack_174);
      pcVar39 = (char *)0x0;
      local_144 = param_2;
      if ((uVar23 & 0xf0007) == 6) {
        local_148 = (uint *)0x0;
        (**(code **)(local_120 + -0x7894))(uStack_1f4,uStack_174,0,local_10c);
        puStack_3fc = local_104;
        (**(code **)(local_120 + -0x6bc0))(uStack_1f4,0x12);
        pcVar39 = (char *)puVar24;
      }
      else {
        local_148 = local_104;
        puStack_3fc = local_10c;
        (**(code **)(local_120 + -0x7894))(uStack_1f4,uStack_174);
      }
      iVar25 = (**(code **)(local_120 + -0x6c70))(uStack_174);
      if (iVar25 << 10 < 0) {
        pcVar39 = (char *)*local_110;
        if ((uint *)pcVar39 != (uint *)0x0) {
          puStack_3fc = local_108;
          (**(code **)(local_120 + -0x6bc0))(uStack_1f4,0x17);
        }
      }
      uStack_3f4 = 1;
      (**(code **)(local_120 + -0x7d6c))(puStack_1f8,0x40);
      (**(code **)(local_120 + -0x7d6c))(local_114,0x40);
      (**(code **)(local_120 + -0x7d6c))(unaff_s4,0x20);
      pcStack_250 = &DAT_00000020;
      (**(code **)(local_120 + -0x7d6c))(pcStack_248);
    }
    else {
      uVar23 = (**(code **)(local_120 + -0x6ccc))(*(uint *)((int)pcStack_248 + 8));
      param_1[0x22] = uVar23;
      if (uVar23 != 0) {
        pcStack_248 = (char *)param_1[0x16];
        if (*(uint *)((int)pcStack_248 + 0x120) == 0) {
          uVar23 = (**(code **)(local_120 + -0x7dd8))(0x4540,&DAT_00647bcc,400);
          *(uint *)((int)pcStack_248 + 0x120) = uVar23;
          pcStack_248 = (char *)param_1[0x16];
          if (*(uint *)((int)pcStack_248 + 0x120) == 0) goto LAB_0049a0a8;
        }
        goto LAB_004999ec;
      }
      pcVar54 = *(code **)(local_120 + -0x6eb0);
      pcVar39 = (char *)0x8e;
      local_148 = (uint *)0x18b;
LAB_00499de0:
      puStack_3fc = (uint *)&DAT_00647bcc;
      pcStack_250 = (char *)0xd1;
      (*pcVar54)(0x14);
LAB_00499df4:
      uStack_3f4 = 0;
    }
  }
LAB_00499c3c:
  if (local_2c == *(uint *)puStack_2b0) {
    return uStack_3f4;
  }
  pcStack_15c = tls1_setup_key_block;
  uVar34 = local_2c;
  (**(code **)(local_120 + -0x5328))();
  puStack_1fc = PTR___stack_chk_guard_006aabf0;
  puStack_1a0 = &_gp;
  uStack_184 = 0;
  iStack_180 = 0;
  piStack_17c = *(int **)PTR___stack_chk_guard_006aabf0;
  uVar23 = 1;
  uStack_200 = uStack_174;
  uStack_170 = param_2;
  puStack_16c = puStack_1f8;
  uStack_168 = uStack_1f4;
  puStack_164 = unaff_s4;
  puStack_160 = (uint *)pcStack_248;
  if (*(int *)(*(int *)(uVar34 + 0x58) + 0x374) == 0) {
    puStack_1c4 = &uStack_188;
    piStack_1c8 = &iStack_180;
    uVar23 = ssl_cipher_get_evp(*(undefined4 *)(uVar34 + 0xc0),&uStack_190,&uStack_18c,&uStack_184);
    uStack_200 = uVar34;
    if (uVar23 == 0) {
      pcVar39 = (char *)0x8a;
      puStack_3fc = (uint *)&DAT_00647bcc;
      piStack_1c8 = (int *)0x25a;
      pcStack_250 = (char *)0xd3;
      uStack_194 = uVar23;
      (**(code **)(puStack_1a0 + -0x6eb0))(0x14);
      uVar23 = uStack_194;
    }
    else {
      pcStack_248 = "s\n";
      iVar25 = *(int *)(uVar34 + 0x58);
      pcVar54 = *(code **)(puStack_1a0 + -0x6ea4);
      *(undefined4 *)(iVar25 + 0x37c) = uStack_190;
      *(undefined4 *)(iVar25 + 0x380) = uStack_18c;
      *(undefined4 *)(iVar25 + 900) = uStack_184;
      *(int *)(iVar25 + 0x388) = iStack_180;
      iVar25 = (*pcVar54)(uStack_190);
      iVar25 = iVar25 + iStack_180;
      iVar27 = (**(code **)(puStack_1a0 + -0x7884))(uStack_190);
      puStack_1f8 = (uint *)((iVar25 + iVar27) * 2);
      ssl3_cleanup_key_block(uVar34);
      unaff_s4 = (uint *)(**(code **)(puStack_1a0 + -0x7dd8))(puStack_1f8,&DAT_00647bcc,0x267);
      if (unaff_s4 == (uint *)0x0) {
        puStack_3fc = (uint *)&DAT_00647bcc;
        pcVar39 = &DAT_00000041;
        pcStack_250 = (char *)0xd3;
        piStack_1c8 = (int *)0x269;
        (**(code **)(puStack_1a0 + -0x6eb0))(0x14);
        uVar23 = 0;
      }
      else {
        iVar25 = *(int *)(uVar34 + 0x58);
        pcVar54 = *(code **)(puStack_1a0 + -0x7dd8);
        *(uint **)(iVar25 + 0x374) = puStack_1f8;
        *(uint **)(iVar25 + 0x378) = unaff_s4;
        uStack_1f4 = (*pcVar54)(puStack_1f8,&DAT_00647bcc,0x270);
        if (uStack_1f4 == 0) {
          puStack_3fc = (uint *)&DAT_00647bcc;
          pcVar39 = &DAT_00000041;
          pcStack_250 = (char *)0xd3;
          piStack_1c8 = (int *)0x272;
          (**(code **)(puStack_1a0 + -0x6eb0))(0x14);
          uVar23 = 0;
        }
        else {
          pcStack_248 = &DAT_00000020;
          uVar26 = ssl_get_algorithm2(uVar34);
          pcVar39 = &DAT_0000000d;
          iStack_1b4 = *(int *)(uVar34 + 0xc0) + 0x14;
          in_t0 = (uint *)(*(int *)(uVar34 + 0x58) + 0xc0);
          uStack_1b0 = *(undefined4 *)(*(int *)(uVar34 + 0xc0) + 0x10);
          puStack_3fc = (uint *)(*(int *)(uVar34 + 0x58) + 0xa0);
          uStack_1b8 = 0;
          uStack_1bc = 0;
          uStack_1c0 = 0x20;
          piStack_1c8 = (int *)0x20;
          puStack_1c4 = in_t0;
          puStack_1ac = unaff_s4;
          uStack_1a8 = uStack_1f4;
          puStack_1a4 = puStack_1f8;
          iVar25 = tls1_PRF_constprop_1(uVar26,"key expansion");
          if (iVar25 == 0) {
            uVar23 = 0;
          }
          else {
            if (((*(uint *)(uVar34 + 0x100) & 0x800) == 0) && (**(int **)(uVar34 + 8) < 0x302)) {
              iVar27 = *(int *)(uVar34 + 0x58);
              iVar25 = *(int *)(*(int *)(uVar34 + 0xc0) + 0xb4);
              *(undefined4 *)(iVar27 + 0xe0) = 1;
              if (iVar25 != 0) {
                iVar25 = *(int *)(iVar25 + 0x14);
                if (iVar25 == 0x20) {
                  *(undefined4 *)(iVar27 + 0xe0) = 0;
                }
                else {
                  uVar23 = 1;
                  if (iVar25 == 4) {
                    *(undefined4 *)(iVar27 + 0xe0) = 0;
                    goto LAB_0049a378;
                  }
                }
              }
            }
            uVar23 = 1;
          }
LAB_0049a378:
          pcStack_250 = (char *)puStack_1f8;
          (**(code **)(puStack_1a0 + -0x7d6c))(uStack_1f4);
          (**(code **)(puStack_1a0 + -0x7f58))(uStack_1f4);
          uStack_200 = uVar23;
        }
      }
    }
  }
  if (piStack_17c == *(int **)puStack_1fc) {
    return uVar23;
  }
  pcStack_1dc = tls1_enc;
  piStack_258 = piStack_17c;
  (**(code **)(puStack_1a0 + -0x5328))();
  puStack_24c = PTR___stack_chk_guard_006aabf0;
  puStack_1e8 = puStack_2b0;
  puStack_228 = &_gp;
  uStack_204 = *(uint *)PTR___stack_chk_guard_006aabf0;
  puStack_404 = (uint *)pcStack_250;
  puStack_1f0 = unaff_s4;
  puStack_1ec = (uint *)pcStack_248;
  uStack_1e4 = uStack_3f4;
  puStack_1e0 = param_1;
  if ((uint *)pcStack_250 == (uint *)0x0) {
    iVar25 = (*(code *)PTR_EVP_MD_CTX_md_006a85fc)(piStack_258[0x21]);
    if (iVar25 != 0) {
      uVar26 = (**(code **)(puStack_228 + -0x78e4))(piStack_258[0x21]);
      iVar25 = (**(code **)(puStack_228 + -0x6fb4))(uVar26);
      if (iVar25 < 0) {
        pcVar39 = "n >= 0";
        puStack_404 = (uint *)0x2dc;
        (**(code **)(puStack_228 + -0x7194))(&DAT_00647bcc);
      }
    }
    piVar40 = (int *)piStack_258[0x20];
    puStack_410 = (uint *)(piStack_258[0x16] + 0x10c);
    if (piVar40 != (int *)0x0) {
      puStack_2b0 = (undefined *)(**(code **)(puStack_228 + -0x6cc8))(piVar40);
      goto LAB_0049a5c4;
    }
LAB_0049a50c:
    pcVar54 = *(code **)(puStack_228 + -0x52e4);
LAB_0049a510:
    pcVar39 = (char *)puStack_410[1];
    puStack_404 = (uint *)puStack_410[4];
    (*pcVar54)(puStack_410[3]);
    uVar23 = 1;
    puStack_410[4] = puStack_410[3];
    piStack_408 = piVar40;
  }
  else {
    iVar25 = (*(code *)PTR_EVP_MD_CTX_md_006a85fc)(piStack_258[0x24]);
    if (iVar25 != 0) {
      uVar26 = (**(code **)(puStack_228 + -0x78e4))(piStack_258[0x24]);
      iVar25 = (**(code **)(puStack_228 + -0x6fb4))(uVar26);
      if (iVar25 < 0) {
        pcVar39 = "n >= 0";
        puStack_404 = (uint *)0x2b9;
        (**(code **)(puStack_228 + -0x7194))(&DAT_00647bcc);
      }
    }
    pcStack_248 = (char *)piStack_258[0x16];
    piStack_408 = (int *)piStack_258[0x23];
    puStack_410 = (uint *)((int)pcStack_248 + 0x130);
    piVar40 = piStack_408;
    if (piStack_408 == (int *)0x0) goto LAB_0049a50c;
    puStack_2b0 = (undefined *)(**(code **)(puStack_228 + -0x6cc8))(piStack_408);
    if ((0x301 < *piStack_258) &&
       (uVar23 = (**(code **)(puStack_228 + -0x6c70))(puStack_2b0), (uVar23 & 0xf0007) == 2)) {
      puStack_404 = (uint *)(**(code **)(puStack_228 + -0x7884))(puStack_2b0);
      if (1 < (int)puStack_404) {
        if (*(uint *)((int)pcStack_248 + 0x13c) != *(uint *)((int)pcStack_248 + 0x140)) {
          uStack_230 = 0x2d1;
          puStack_3fc = (uint *)&DAT_00647bcc;
          pcVar39 = "%s:%d: rec->data != rec->input\n";
          puStack_404 = (uint *)0x1;
          (**(code **)(puStack_228 + -0x5454))(**(undefined4 **)(puStack_228 + -0x52e0));
          goto LAB_0049a5c4;
        }
        iVar25 = (**(code **)(puStack_228 + -0x719c))();
        if (0 < iVar25) goto LAB_0049a5c4;
LAB_0049aa84:
        uVar23 = 0xffffffff;
        goto LAB_0049a530;
      }
LAB_0049a5c4:
      pcVar54 = *(code **)(puStack_228 + -0x52e4);
      if (piStack_258[0x30] != 0) goto LAB_0049a5d0;
      goto LAB_0049a510;
    }
    if (piStack_258[0x30] == 0) goto LAB_0049a50c;
LAB_0049a5d0:
    if (puStack_2b0 == (undefined *)0x0) goto LAB_0049a50c;
    param_1 = (uint *)puStack_410[1];
    pcStack_248 = (char *)(**(code **)(puStack_228 + -0x6cc4))(*piVar40);
    iVar25 = (**(code **)(puStack_228 + -0x6c70))(*piVar40);
    piStack_408 = piVar40;
    if (iVar25 << 10 < 0) {
      iVar25 = *piStack_258;
      if ((uint *)pcStack_250 == (uint *)0x0) {
        puVar24 = (uint *)(piStack_258[0x16] + 8);
        if ((iVar25 == 0xfeff) || (iVar25 == 0x100)) {
          uVar3 = *(undefined2 *)(piStack_258[0x17] + 0x208);
          uVar37 = (undefined)((ushort)uVar3 >> 8);
          goto LAB_0049a62c;
        }
LAB_0049a88c:
        uStack_214 = *puVar24;
        uStack_210 = puVar24[1];
        cVar32 = *(char *)((int)puVar24 + 7) + '\x01';
        *(char *)((int)puVar24 + 7) = cVar32;
        if ((cVar32 == '\0') &&
           (((((cVar32 = *(char *)((int)puVar24 + 6) + '\x01', *(char *)((int)puVar24 + 6) = cVar32,
               cVar32 == '\0' &&
               (cVar32 = *(char *)((int)puVar24 + 5) + '\x01', *(char *)((int)puVar24 + 5) = cVar32,
               cVar32 == '\0')) &&
              (cVar32 = *(char *)(puVar24 + 1), *(char *)(puVar24 + 1) = cVar32 + '\x01',
              (char)(cVar32 + '\x01') == '\0')) &&
             ((cVar32 = *(char *)((int)puVar24 + 3) + '\x01', *(char *)((int)puVar24 + 3) = cVar32,
              cVar32 == '\0' &&
              (cVar32 = *(char *)((int)puVar24 + 2) + '\x01', *(char *)((int)puVar24 + 2) = cVar32,
              cVar32 == '\0')))) &&
            (cVar32 = *(char *)((int)puVar24 + 1) + '\x01', *(char *)((int)puVar24 + 1) = cVar32,
            cVar32 == '\0')))) {
          *(char *)puVar24 = *(char *)puVar24 + '\x01';
        }
        iVar25 = *piStack_258;
      }
      else {
        puVar24 = (uint *)(piStack_258[0x16] + 0x54);
        if ((iVar25 != 0xfeff) && (iVar25 != 0x100)) goto LAB_0049a88c;
        uVar3 = *(undefined2 *)(piStack_258[0x17] + 0x20a);
        uVar37 = (undefined)((ushort)uVar3 >> 8);
LAB_0049a62c:
        bVar2 = *(byte *)((int)puVar24 + 6);
        in_t0 = (uint *)(uint)bVar2;
        cVar32 = *(char *)((int)puVar24 + 7);
        uVar34 = *(uint *)((int)puVar24 + 2);
        uStack_214 = CONCAT13(uVar37,CONCAT12((char)uVar3,SUB42(auStack_220,0)));
        auStack_220 = (undefined  [4])uStack_214;
        puVar51 = auStack_220 + 2;
        uVar23 = (uint)puVar51 & 3;
        *(uint *)(puVar51 + -uVar23) =
             *(uint *)(puVar51 + -uVar23) & -1 << (4 - uVar23) * 8 | uVar34 >> uVar23 * 8;
        puVar51 = auStack_21c + 1;
        uVar23 = (uint)puVar51 & 3;
        *(uint *)(puVar51 + -uVar23) =
             *(uint *)(puVar51 + -uVar23) & 0xffffffffU >> (uVar23 + 1) * 8 |
             uVar34 << (3 - uVar23) * 8;
        auStack_21c._0_4_ = CONCAT31(CONCAT21(auStack_21c._0_2_,bVar2),cVar32);
        uStack_210 = auStack_21c._0_4_;
      }
      puStack_3fc = &uStack_214;
      uStack_20a = (undefined)iVar25;
      pcVar39 = &DAT_0000000d;
      puStack_404 = (uint *)&DAT_00000016;
      uStack_20b = (undefined)((uint)iVar25 >> 8);
      uStack_20c = (undefined)*puStack_410;
      uStack_208 = (undefined)puStack_410[1];
      uStack_209 = (undefined)(puStack_410[1] >> 8);
      uStack_3f4 = (**(code **)(puStack_228 + -0x6bc0))(piVar40);
      if ((uint *)pcStack_250 != (uint *)0x0) {
        puVar24 = (uint *)((int)param_1 + uStack_3f4);
        puStack_410[1] = puStack_410[1] + uStack_3f4;
        param_1 = puVar24;
        if ((uint *)pcStack_250 != (uint *)0x0) goto LAB_0049a6e4;
      }
LAB_0049a6c8:
      uVar23 = 0;
      puVar24 = param_1;
      if (param_1 != (uint *)0x0) {
LAB_0049a6d0:
        if ((uint *)pcStack_248 == (uint *)0x0) {
          trap(7);
        }
        uVar23 = 0;
        param_1 = puVar24;
        if ((uint)puVar24 % (uint)pcStack_248 == 0) {
LAB_0049a6e4:
          pcVar54 = *(code **)(puStack_228 + -0x6e30);
          param_1 = puVar24;
          goto LAB_0049a6e8;
        }
      }
    }
    else if ((uint *)pcStack_248 == (uint *)0x1) {
      uStack_3f4 = 0;
      if ((uint *)pcStack_250 == (uint *)0x0) goto LAB_0049a6c8;
      pcVar54 = *(code **)(puStack_228 + -0x6e30);
LAB_0049a6e8:
      pcVar39 = (char *)puStack_410[4];
      puStack_404 = (uint *)puStack_410[3];
      puStack_3fc = param_1;
      piStack_408 = (int *)(*pcVar54)(piVar40);
      iVar25 = (**(code **)(puStack_228 + -0x6c70))(*piVar40);
      if (iVar25 << 0xb < 0) {
        uVar23 = (uint)piStack_408 >> 0x1f;
      }
      else {
        uVar23 = (uint)(piStack_408 == (int *)0x0);
      }
      if (uVar23 != 0) goto LAB_0049aa84;
      uVar23 = (**(code **)(puStack_228 + -0x6c70))(puStack_2b0);
      if ((uVar23 & 0xf0007) == 6) {
        pcVar54 = *(code **)(puStack_228 + -0x78e4);
        if ((uint *)pcStack_250 == (uint *)0x0) {
          puStack_410[3] = puStack_410[3] + 8;
          puStack_410[4] = puStack_410[4] + 8;
          puStack_410[1] = puStack_410[1] - 8;
        }
      }
      else {
        pcVar54 = *(code **)(puStack_228 + -0x78e4);
      }
      iVar25 = (*pcVar54)(piStack_258[0x21]);
      if (iVar25 == 0) {
        puVar24 = (uint *)0x0;
      }
      else {
        uVar26 = (**(code **)(puStack_228 + -0x78e4))(piStack_258[0x21]);
        puVar24 = (uint *)(**(code **)(puStack_228 + -0x6fb4))(uVar26);
      }
      if ((uint *)pcStack_248 == (uint *)0x1) {
        if (uStack_3f4 == 0) goto LAB_0049a790;
        uVar23 = 1;
        if ((uint *)pcStack_250 == (uint *)0x0) goto LAB_0049a868;
      }
      else if ((uint *)pcStack_250 == (uint *)0x0) {
        puStack_404 = puStack_410;
        pcVar39 = pcStack_248;
        uVar23 = tls1_cbc_remove_padding(piStack_258);
        puStack_3fc = puVar24;
        if (uStack_3f4 != 0) {
LAB_0049a868:
          uStack_3f4 = puStack_410[1] - uStack_3f4;
          puStack_410[1] = uStack_3f4;
        }
      }
      else {
LAB_0049a790:
        uVar23 = 1;
      }
    }
    else {
      if ((uint *)pcStack_250 != (uint *)0x0) {
        if ((uint *)pcStack_248 == (uint *)0x0) {
          trap(7);
        }
        iVar27 = (int)pcStack_248 - (int)param_1 % (int)pcStack_248;
        iVar25 = iVar27 + -1;
        if (((piStack_258[0x40] & 0x200U) != 0) && ((*(uint *)piStack_258[0x16] & 8) != 0)) {
          iVar25 = iVar27;
        }
        puVar24 = (uint *)((int)param_1 + iVar27);
        if ((int)param_1 < (int)puVar24) {
          do {
            pbVar52 = (byte *)(puStack_410[4] + (int)param_1);
            param_1 = (uint *)((int)param_1 + 1);
            *pbVar52 = (byte)iVar25;
          } while (puVar24 != param_1);
        }
        uStack_3f4 = 0;
        puStack_410[1] = puStack_410[1] + iVar27;
        goto LAB_0049a6e4;
      }
      uStack_3f4 = 0;
      puVar24 = param_1;
      if (param_1 != (uint *)0x0) goto LAB_0049a6d0;
      uVar23 = 0;
    }
  }
LAB_0049a530:
  if (uStack_204 == *(uint *)puStack_24c) {
    return uVar23;
  }
  pcStack_244 = tls1_cert_verify_mac;
  uStack_2c4 = uStack_204;
  (**(code **)(puStack_228 + -0x5328))();
  piStack_400 = (int *)PTR___stack_chk_guard_006aabf0;
  iVar25 = *(int *)(uStack_2c4 + 0x58);
  puStack_288 = &_gp;
  puStack_3a4 = *(uint **)PTR___stack_chk_guard_006aabf0;
  puStack_264 = puStack_3a4;
  puStack_25c = puStack_410;
  piStack_254 = piStack_408;
  if (*(int *)(iVar25 + 0x178) == 0) {
LAB_0049ab00:
    puStack_410 = (uint *)0x0;
    piStack_408 = (int *)&DAT_00000018;
    puVar51 = puStack_288;
LAB_0049ab10:
    if (*(int *)(*(int *)(iVar25 + 0x17c) + (int)puStack_410) == 0) {
LAB_0049ab44:
      puStack_410 = puStack_410 + 1;
      if (puStack_410 == (uint *)&DAT_00000018) goto LAB_0049ab50;
      iVar25 = *(int *)(uStack_2c4 + 0x58);
      goto LAB_0049ab10;
    }
    uVar26 = (**(code **)(puVar51 + -0x78e4))();
    puVar24 = (uint *)(**(code **)(puStack_288 + -0x7a14))(uVar26);
    puVar51 = puStack_288;
    if (puVar24 != puStack_404) goto LAB_0049ab44;
    puStack_410 = (uint *)(*(int *)(*(int *)(uStack_2c4 + 0x58) + 0x17c) + (int)puStack_410);
    uStack_2c4 = *puStack_410;
    if (uStack_2c4 != 0) {
      puStack_410 = auStack_27c;
      (**(code **)(puStack_288 + -0x7fc4))(puStack_410);
      (**(code **)(puStack_288 + -0x6cb4))(puStack_410,uStack_2c4);
      puStack_490 = &uStack_280;
      puStack_3a4 = (uint *)pcVar39;
      (**(code **)(puStack_288 + -0x7868))(puStack_410);
      (**(code **)(puStack_288 + -0x7fac))(puStack_410);
      uVar23 = uStack_280;
      goto LAB_0049ab7c;
    }
LAB_0049ab50:
    puStack_490 = (uint *)0x144;
    puStack_3fc = (uint *)&DAT_00647bcc;
    uStack_290 = 0x377;
    puStack_3a4 = (uint *)0x11e;
    (**(code **)(puVar51 + -0x6eb0))(0x14);
    uVar23 = 0;
  }
  else {
    puStack_490 = (uint *)pcVar39;
    uVar23 = ssl3_digest_cached_records();
    if (uVar23 != 0) {
      iVar25 = *(int *)(uStack_2c4 + 0x58);
      goto LAB_0049ab00;
    }
  }
LAB_0049ab7c:
  if (puStack_264 == (uint *)*piStack_400) {
    return uVar23;
  }
  pcStack_2a4 = tls1_final_finish_mac;
  puVar24 = puStack_264;
  (**(code **)(puStack_288 + -0x5328))();
  ppiStack_398 = (int **)PTR___stack_chk_guard_006aabf0;
  piStack_498 = *(int **)PTR___stack_chk_guard_006aabf0;
  puStack_2b8 = (undefined *)piStack_400;
  puStack_3b0 = &_gp;
  piStack_2cc = piStack_498;
  puStack_2c8 = puStack_410;
  piStack_2c0 = piStack_408;
  puStack_2bc = puStack_404;
  puStack_2b4 = (uint *)pcVar39;
  uStack_2ac = uStack_3f4;
  puStack_2a8 = param_1;
  puStack_298 = puStack_490;
  if ((*(int *)(puVar24[0x16] + 0x178) == 0) ||
     (iVar25 = ssl3_digest_cached_records(), puStack_3f8 = puStack_3fc, iVar25 != 0)) {
    puStack_394 = auStack_370;
    puVar53 = auStack_34c;
    puStack_390 = puVar53;
    (**(code **)(puStack_3b0 + -0x7fc4))(puStack_394);
    iVar25 = 0;
    iStack_39c = 0;
    iStack_3a8 = 0;
    while (iVar27 = ssl_get_handshake_digest(iVar25,&uStack_380,&uStack_37c), iVar27 != 0) {
      uVar23 = ssl_get_algorithm2(puVar24);
      if ((uVar23 & uStack_380) == 0) {
        iVar25 = iVar25 + 1;
      }
      else {
        iVar27 = (**(code **)(puStack_3b0 + -0x6fb4))(uStack_37c);
        if (((*(int *)(*(int *)(puVar24[0x16] + 0x17c) + iVar25 * 4) == 0) || (iVar27 < 0)) ||
           (0x80 - iStack_3a8 < iVar27)) {
          iVar25 = iVar25 + 1;
          iStack_39c = 1;
        }
        else {
          iVar28 = (**(code **)(puStack_3b0 + -0x6cb4))(puStack_394);
          if (((iVar28 == 0) ||
              (iVar28 = (**(code **)(puStack_3b0 + -0x7868))(puStack_394,puVar53,&iStack_384),
              iVar28 == 0)) || (iVar28 = iStack_384, iStack_384 != iVar27)) {
            iStack_39c = 1;
            iVar28 = iVar27;
          }
          puVar53 = (uint *)((int)puVar53 + iVar28);
          iVar25 = iVar25 + 1;
          iStack_3a8 = (int)puVar53 - (int)puStack_390;
        }
      }
    }
    puStack_404 = &uStack_374;
    puStack_410 = (uint *)ssl_get_algorithm2(puVar24);
    piStack_400 = &iStack_378;
    iVar27 = 0;
    piStack_408 = (int *)(puVar24[0x30] + 0x14);
    uVar23 = *(uint *)(puVar24[0x30] + 0x10);
    iVar25 = 0;
    while (uStack_38c = ssl_get_handshake_digest(iVar27,piStack_400,puStack_404),
          param_1 = puStack_390, uStack_38c != 0) {
      iVar27 = iVar27 + 1;
      if ((iStack_378 << 10 & (uint)puStack_410) != 0) {
        iVar25 = iVar25 + 1;
      }
    }
    if (iVar25 == 0) {
      trap(7);
    }
    uStack_3f4 = (int)uVar23 / iVar25;
    *(byte *)puStack_3fc = 0;
    if (iVar25 == 1) {
      uVar23 = 0;
    }
    puStack_3f8 = (uint *)&bStack_358;
    iVar25 = 0;
    *(byte *)((int)puStack_3fc + 1) = 0;
    *(byte *)((int)puStack_3fc + 2) = 0;
    *(byte *)((int)puStack_3fc + 3) = 0;
    *(byte *)(puStack_3fc + 1) = 0;
    *(byte *)((int)puStack_3fc + 5) = 0;
    *(byte *)((int)puStack_3fc + 6) = 0;
    *(byte *)((int)puStack_3fc + 7) = 0;
    *(byte *)(puStack_3fc + 2) = 0;
    *(byte *)((int)puStack_3fc + 9) = 0;
    *(byte *)((int)puStack_3fc + 10) = 0;
    *(byte *)((int)puStack_3fc + 0xb) = 0;
    puStack_3a0 = (uint *)((uVar23 & 1) + uStack_3f4);
    piStack_498 = piStack_400;
    puStack_490 = puStack_404;
    iVar27 = ssl_get_handshake_digest(0);
    puVar24 = puStack_3a0;
    uStack_40c = uStack_38c;
    while (puStack_3a0 = puVar24, uStack_38c = uStack_40c, iVar27 != 0) {
      if ((iStack_378 << 10 & (uint)puStack_410) != 0) {
        if (uStack_374 == 0) {
          puStack_490 = (uint *)0x146;
          puStack_3d8 = (uint *)0x114;
          piStack_498 = (int *)0x11c;
          (**(code **)(puStack_3b0 + -0x6eb0))(0x14,0x11c,0x146,&DAT_00647bcc);
        }
        else {
          uStack_3b8 = 0xc;
          uStack_3c0 = 0;
          uStack_3c4 = 0;
          uStack_3c8 = 0;
          uStack_3cc = 0;
          puStack_3d4 = param_1;
          piStack_498 = piStack_408;
          puStack_3d8 = puStack_298;
          iStack_3d0 = iStack_3a8;
          puStack_3bc = puStack_3f8;
          iVar27 = tls1_P_hash_constprop_2();
          puStack_490 = puVar24;
          uStack_40c = uStack_38c;
          if (iVar27 != 0) {
            piStack_408 = (int *)((int)piStack_408 + uStack_3f4);
            bVar2 = *(byte *)((int)puStack_3fc + 3) ^ bStack_355;
            in_t3 = (uint)bVar2;
            in_t2 = (uint *)(uint)(*(byte *)(puStack_3fc + 1) ^ bStack_354);
            bVar22 = *(byte *)((int)puStack_3fc + 5) ^ bStack_353;
            in_t1 = (uint)bVar22;
            *(byte *)puStack_3fc = *(byte *)puStack_3fc ^ bStack_358;
            *(byte *)((int)puStack_3fc + 1) = *(byte *)((int)puStack_3fc + 1) ^ bStack_357;
            *(byte *)((int)puStack_3fc + 9) = *(byte *)((int)puStack_3fc + 9) ^ bStack_34f;
            *(byte *)((int)puStack_3fc + 2) = *(byte *)((int)puStack_3fc + 2) ^ bStack_356;
            *(byte *)((int)puStack_3fc + 3) = bVar2;
            *(byte *)(puStack_3fc + 1) = *(byte *)(puStack_3fc + 1) ^ bStack_354;
            *(byte *)((int)puStack_3fc + 5) = bVar22;
            *(byte *)((int)puStack_3fc + 6) = *(byte *)((int)puStack_3fc + 6) ^ bStack_352;
            *(byte *)((int)puStack_3fc + 7) = *(byte *)((int)puStack_3fc + 7) ^ bStack_351;
            *(byte *)(puStack_3fc + 2) = *(byte *)(puStack_3fc + 2) ^ bStack_350;
            *(byte *)((int)puStack_3fc + 10) = *(byte *)((int)puStack_3fc + 10) ^ bStack_34e;
            *(byte *)((int)puStack_3fc + 0xb) = *(byte *)((int)puStack_3fc + 0xb) ^ bStack_34d;
            goto LAB_0049af98;
          }
        }
        (**(code **)(puStack_3b0 + -0x7fac))(puStack_394);
        goto LAB_0049afd0;
      }
LAB_0049af98:
      iVar25 = iVar25 + 1;
      piStack_498 = piStack_400;
      puStack_490 = puStack_404;
      iVar27 = ssl_get_handshake_digest(iVar25);
      puVar24 = puStack_3a0;
      uStack_40c = uStack_38c;
    }
    (**(code **)(puStack_3b0 + -0x7fac))(puStack_394);
    pcVar39 = (char *)puStack_3fc;
    if (iStack_39c == 0) {
      uStack_40c = 0xc;
      goto LAB_0049afd0;
    }
  }
  uStack_40c = 0;
  puStack_3fc = (uint *)pcVar39;
LAB_0049afd0:
  if (piStack_2cc == *ppiStack_398) {
    return uStack_40c;
  }
  pcStack_3ec = tls1_mac;
  piStack_4ac = piStack_2cc;
  (**(code **)(puStack_3b0 + -0x5328))();
  puStack_49c = PTR___stack_chk_guard_006aabf0;
  puStack_460 = &_gp;
  iStack_414 = *(int *)PTR___stack_chk_guard_006aabf0;
  iVar25 = piStack_4ac[0x16];
  puStack_4a8 = (uint *)(iVar25 + 0x10c);
  if (puStack_490 == (uint *)0x0) {
    puVar51 = (undefined *)piStack_4ac[0x21];
    puStack_4b0 = (undefined4 *)(iVar25 + 8);
    uStack_4a0 = piStack_4ac[0x1f] & 1;
  }
  else {
    puVar51 = (undefined *)piStack_4ac[0x24];
    puStack_4a8 = (uint *)(iVar25 + 0x130);
    puStack_4b0 = (undefined4 *)(iVar25 + 0x54);
    uStack_4a0 = piStack_4ac[0x1f] & 2;
  }
  puStack_3f0 = param_1;
  uVar26 = (*(code *)PTR_EVP_MD_CTX_md_006a85fc)(puVar51);
  uStack_448 = (**(code **)(puStack_460 + -0x6fb4))(uVar26);
  if ((int)uStack_448 < 0) {
    uStack_454 = uStack_448;
    (**(code **)(puStack_460 + -0x7194))(&DAT_00647bcc,0x3d3,"t >= 0");
    uStack_448 = uStack_454;
  }
  puStack_4a4 = puVar51;
  if (uStack_4a0 == 0) {
    puStack_4a4 = auStack_444;
    (**(code **)(puStack_460 + -0x6e2c))(puStack_4a4,puVar51);
  }
  iVar25 = *piStack_4ac;
  if ((iVar25 == 0xfeff) || (iVar25 == 0x100)) {
    if (puStack_490 == (uint *)0x0) {
      uVar3 = *(undefined2 *)(piStack_4ac[0x17] + 0x208);
      uVar37 = (undefined)((ushort)uVar3 >> 8);
    }
    else {
      uVar3 = *(undefined2 *)(piStack_4ac[0x17] + 0x20a);
      uVar37 = (undefined)((ushort)uVar3 >> 8);
    }
    auStack_42c = (undefined  [4])CONCAT13(uVar37,CONCAT12((char)uVar3,SUB42(auStack_42c,0)));
    bVar2 = *(byte *)((int)puStack_4b0 + 6);
    in_t0 = (uint *)(uint)bVar2;
    uVar34 = *(uint *)((int)puStack_4b0 + 2);
    cVar32 = *(char *)((int)puStack_4b0 + 7);
    puVar51 = auStack_42c + 2;
    uVar23 = (uint)puVar51 & 3;
    *(uint *)(puVar51 + -uVar23) =
         *(uint *)(puVar51 + -uVar23) & -1 << (4 - uVar23) * 8 | uVar34 >> uVar23 * 8;
    puVar51 = auStack_428 + 1;
    uVar23 = (uint)puVar51 & 3;
    *(uint *)(puVar51 + -uVar23) =
         *(uint *)(puVar51 + -uVar23) & 0xffffffffU >> (uVar23 + 1) * 8 | uVar34 << (3 - uVar23) * 8
    ;
    auStack_428 = (undefined  [4])CONCAT31(CONCAT21(auStack_428._0_2_,bVar2),cVar32);
    uStack_420 = auStack_428;
    uStack_424 = auStack_42c;
  }
  else {
    uStack_424 = *puStack_4b0;
    uStack_420 = puStack_4b0[1];
  }
  uStack_454 = puStack_4a8[1];
  uStack_494 = *puStack_4a8;
  uStack_450 = uStack_448;
  puVar43 = (undefined4 *)(uStack_494 & 0xff);
  *puStack_4a8 = (uint)puVar43;
  uStack_41c = (undefined)uStack_494;
  uStack_41b = (undefined)((uint)iVar25 >> 8);
  uStack_41a = (undefined)iVar25;
  uStack_419 = (undefined)(uStack_454 >> 8);
  uStack_418 = (undefined)uStack_454;
  puVar44 = &uStack_424;
  if (((puStack_490 == (uint *)0x0) &&
      (puStack_44c = &uStack_424, uVar23 = (**(code **)(puStack_460 + -0x6cb0))(piStack_4ac[0x20]),
      puVar44 = puStack_44c, (uVar23 & 0xf0007) == 2)) &&
     (iVar25 = ssl3_cbc_record_digest_supported(puStack_4a4,puStack_44c), puVar44 = puStack_44c,
     iVar25 != 0)) {
    uStack_464 = 0;
    iStack_46c = piStack_4ac[0x16] + 0x14;
    uStack_468 = *(undefined4 *)(piStack_4ac[0x16] + 0x10);
    pcVar39 = (char *)&uStack_448;
    iStack_470 = uStack_454 + uStack_450 + (uStack_494 >> 8);
    iStack_474 = puStack_4a8[1] + uStack_448;
    uStack_478 = puStack_4a8[4];
    puVar43 = puStack_44c;
    ssl3_cbc_digest_record(puStack_4a4,piStack_498);
  }
  else {
    (**(code **)(puStack_460 + -0x786c))(puStack_4a4,puVar44,0xd);
    (**(code **)(puStack_460 + -0x786c))(puStack_4a4,puStack_4a8[4],puStack_4a8[1]);
    pcVar39 = (char *)&uStack_448;
    iVar25 = (**(code **)(puStack_460 + -0x7914))(puStack_4a4,piStack_498);
    if (iVar25 < 1) {
      pcVar39 = "t > 0";
      (**(code **)(puStack_460 + -0x7194))(&DAT_00647bcc,0x40d);
    }
  }
  if (uStack_4a0 == 0) {
    (**(code **)(puStack_460 + -0x7fac))(auStack_444);
  }
  if (((*piStack_4ac != 0xfeff) && (*piStack_4ac != 0x100)) &&
     ((((cVar32 = *(char *)((int)puStack_4b0 + 7) + '\x01', *(char *)((int)puStack_4b0 + 7) = cVar32
        , cVar32 == '\0' &&
        ((cVar32 = *(char *)((int)puStack_4b0 + 6) + '\x01',
         *(char *)((int)puStack_4b0 + 6) = cVar32, cVar32 == '\0' &&
         (cVar32 = *(char *)((int)puStack_4b0 + 5) + '\x01',
         *(char *)((int)puStack_4b0 + 5) = cVar32, cVar32 == '\0')))) &&
       (cVar32 = *(char *)(puStack_4b0 + 1), *(char *)(puStack_4b0 + 1) = cVar32 + '\x01',
       (char)(cVar32 + '\x01') == '\0')) &&
      (((cVar32 = *(char *)((int)puStack_4b0 + 3) + '\x01', *(char *)((int)puStack_4b0 + 3) = cVar32
        , cVar32 == '\0' &&
        (cVar32 = *(char *)((int)puStack_4b0 + 2) + '\x01', *(char *)((int)puStack_4b0 + 2) = cVar32
        , cVar32 == '\0')) &&
       (cVar32 = *(char *)((int)puStack_4b0 + 1) + '\x01', *(char *)((int)puStack_4b0 + 1) = cVar32,
       cVar32 == '\0')))))) {
    *(char *)puStack_4b0 = *(char *)puStack_4b0 + '\x01';
  }
  if (iStack_414 == *(int *)puStack_49c) {
    return uStack_448;
  }
  pcStack_48c = tls1_generate_master_secret;
  iVar25 = iStack_414;
  (**(code **)(puStack_460 + -0x5328))();
  puVar51 = PTR___stack_chk_guard_006aabf0;
  uStack_4b4 = *(uint *)PTR___stack_chk_guard_006aabf0;
  puVar44 = puVar43;
  uVar23 = ssl_get_algorithm2();
  iVar55 = *(int *)(iVar25 + 0xc0);
  iVar28 = 0;
  iVar27 = *(int *)(iVar25 + 0x58) + 0xc0;
  puVar24 = (uint *)(iVar55 + 0x14);
  iVar25 = 0;
  while (iVar29 = ssl_get_handshake_digest(iVar28,&uStack_4ec,&iStack_4e8), iVar29 != 0) {
    iVar28 = iVar28 + 1;
    if ((uStack_4ec << 10 & uVar23) != 0) {
      iVar25 = iVar25 + 1;
    }
  }
  if (iVar25 == 0) {
    trap(7);
  }
  iVar28 = (int)puVar43 / iVar25;
  if (iVar25 == 1) {
    puVar43 = (undefined4 *)0x0;
  }
  (*(code *)PTR_memset_006aab00)(puVar24,0,0x30);
  iVar25 = 0;
  pcStack_500 = "master secret";
  puVar53 = &uStack_4ec;
  piVar40 = &iStack_4e8;
  iVar29 = ssl_get_handshake_digest(0);
  do {
    if (iVar29 == 0) {
LAB_0049b79c:
      if (uStack_4b4 == *(uint *)puVar51) {
        return 0x30;
      }
      uVar23 = uStack_4b4;
      (*(code *)PTR___stack_chk_fail_006aabb8)();
      puVar43 = puVar44;
      iVar25 = (*(code *)PTR_CRYPTO_malloc_006a8108)(piVar40,&DAT_00647bcc,0x471);
      if (iVar25 == 0) {
        uVar23 = 0;
        (*(code *)PTR_ERR_put_error_006a9030)(0x14,0x13a,0x41,&DAT_00647bcc,0x4b5);
      }
      else {
        iVar27 = uStack_540 + 0x40;
        if (iStack_534 == 0) {
          iVar55 = (*(code *)PTR_CRYPTO_malloc_006a8108)(iVar27,&DAT_00647bcc,0x47f);
          iVar28 = iVar27;
        }
        else {
          iVar28 = uStack_538 + 2 + iVar27;
          iVar55 = (*(code *)PTR_CRYPTO_malloc_006a8108)(iVar28,&DAT_00647bcc,0x47f);
        }
        if (iVar55 == 0) {
          (*(code *)PTR_ERR_put_error_006a9030)(0x14,0x13a,0x41,&DAT_00647bcc,0x4b5);
          (*(code *)PTR_CRYPTO_free_006a7f88)(iVar25);
          return 0;
        }
        uVar41 = uStack_540;
        (*(code *)PTR_memcpy_006aabf4)(iVar55);
        puVar31 = (uint *)(iVar55 + uStack_540);
        iVar35 = *(int *)(uVar23 + 0x58);
        puVar24 = (uint *)(iVar55 + uStack_540 + 0x20);
        uVar50 = *(uint *)(iVar35 + 0xc0);
        uVar34 = iVar35 + 0xc4U & 3;
        uVar4 = iVar35 + 200U & 3;
        uVar5 = iVar35 + 0xccU & 3;
        uVar6 = iVar35 + 0xd0U & 3;
        uVar7 = iVar35 + 0xd4U & 3;
        uVar8 = iVar35 + 0xd8U & 3;
        iVar29 = *(int *)((iVar35 + 0xd8U) - uVar8);
        uVar9 = iVar35 + 0xdcU & 3;
        iVar10 = *(int *)((iVar35 + 0xdcU) - uVar9);
        uVar13 = iVar35 + 199U & 3;
        uVar49 = (*(int *)((iVar35 + 0xc4U) - uVar34) << uVar34 * 8 |
                 in_t3 & 0xffffffffU >> (4 - uVar34) * 8) & -1 << (uVar13 + 1) * 8 |
                 *(uint *)((iVar35 + 199U) - uVar13) >> (3 - uVar13) * 8;
        uVar34 = iVar35 + 0xcbU & 3;
        uVar48 = (*(int *)((iVar35 + 200U) - uVar4) << uVar4 * 8 |
                 (uint)in_t2 & 0xffffffffU >> (4 - uVar4) * 8) & -1 << (uVar34 + 1) * 8 |
                 *(uint *)((iVar35 + 0xcbU) - uVar34) >> (3 - uVar34) * 8;
        uVar34 = iVar35 + 0xcfU & 3;
        uVar47 = (*(int *)((iVar35 + 0xccU) - uVar5) << uVar5 * 8 |
                 in_t1 & 0xffffffffU >> (4 - uVar5) * 8) & -1 << (uVar34 + 1) * 8 |
                 *(uint *)((iVar35 + 0xcfU) - uVar34) >> (3 - uVar34) * 8;
        uVar34 = iVar35 + 0xd3U & 3;
        uVar46 = (*(int *)((iVar35 + 0xd0U) - uVar6) << uVar6 * 8 |
                 (uint)in_t0 & 0xffffffffU >> (4 - uVar6) * 8) & -1 << (uVar34 + 1) * 8 |
                 *(uint *)((iVar35 + 0xd3U) - uVar34) >> (3 - uVar34) * 8;
        uVar34 = iVar35 + 0xd7U & 3;
        uVar45 = (*(int *)((iVar35 + 0xd4U) - uVar7) << uVar7 * 8 |
                 (uint)puVar43 & 0xffffffffU >> (4 - uVar7) * 8) & -1 << (uVar34 + 1) * 8 |
                 *(uint *)((iVar35 + 0xd7U) - uVar34) >> (3 - uVar34) * 8;
        uVar34 = iVar35 + 0xdbU & 3;
        uVar5 = *(uint *)((iVar35 + 0xdbU) - uVar34);
        uVar4 = iVar35 + 0xdfU & 3;
        uVar6 = *(uint *)((iVar35 + 0xdfU) - uVar4);
        *puVar31 = uVar50;
        puVar31[1] = uVar49;
        puVar31[2] = uVar48;
        puVar31[3] = uVar47;
        puVar31[4] = uVar46;
        puVar31[5] = uVar45;
        puVar31[6] = (iVar29 << uVar8 * 8 | uVar41 & 0xffffffffU >> (4 - uVar8) * 8) &
                     -1 << (uVar34 + 1) * 8 | uVar5 >> (3 - uVar34) * 8;
        puVar31[7] = (iVar10 << uVar9 * 8 | (uint)puVar44 & 0xffffffffU >> (4 - uVar9) * 8) &
                     -1 << (uVar4 + 1) * 8 | uVar6 >> (3 - uVar4) * 8;
        iVar36 = *(int *)(uVar23 + 0x58);
        uVar34 = iVar36 + 0xa0U & 3;
        uVar4 = iVar36 + 0xa4U & 3;
        iVar29 = *(int *)((iVar36 + 0xa4U) - uVar4);
        uVar5 = iVar36 + 0xa8U & 3;
        iVar10 = *(int *)((iVar36 + 0xa8U) - uVar5);
        uVar6 = iVar36 + 0xacU & 3;
        iVar35 = *(int *)((iVar36 + 0xacU) - uVar6);
        uVar7 = iVar36 + 0xb0U & 3;
        iVar11 = *(int *)((iVar36 + 0xb0U) - uVar7);
        uVar8 = iVar36 + 0xb4U & 3;
        iVar12 = *(int *)((iVar36 + 0xb4U) - uVar8);
        uVar9 = iVar36 + 0xa3U & 3;
        uVar13 = iVar36 + 0xa7U & 3;
        uVar17 = *(uint *)((iVar36 + 0xa7U) - uVar13);
        uVar41 = iVar36 + 0xabU & 3;
        uVar18 = *(uint *)((iVar36 + 0xabU) - uVar41);
        uVar14 = iVar36 + 0xafU & 3;
        uVar19 = *(uint *)((iVar36 + 0xafU) - uVar14);
        uVar15 = iVar36 + 0xb3U & 3;
        uVar20 = *(uint *)((iVar36 + 0xb3U) - uVar15);
        uVar16 = iVar36 + 0xb7U & 3;
        uVar21 = *(uint *)((iVar36 + 0xb7U) - uVar16);
        uVar42 = *(uint *)(iVar36 + 0xb8);
        uVar38 = *(uint *)(iVar36 + 0xbc);
        *puVar24 = (*(int *)((iVar36 + 0xa0U) - uVar34) << uVar34 * 8 |
                   uVar50 & 0xffffffffU >> (4 - uVar34) * 8) & -1 << (uVar9 + 1) * 8 |
                   *(uint *)((iVar36 + 0xa3U) - uVar9) >> (3 - uVar9) * 8;
        puVar24[1] = (iVar29 << uVar4 * 8 | uVar49 & 0xffffffffU >> (4 - uVar4) * 8) &
                     -1 << (uVar13 + 1) * 8 | uVar17 >> (3 - uVar13) * 8;
        puVar24[2] = (iVar10 << uVar5 * 8 | uVar48 & 0xffffffffU >> (4 - uVar5) * 8) &
                     -1 << (uVar41 + 1) * 8 | uVar18 >> (3 - uVar41) * 8;
        puVar24[3] = (iVar35 << uVar6 * 8 | uVar47 & 0xffffffffU >> (4 - uVar6) * 8) &
                     -1 << (uVar14 + 1) * 8 | uVar19 >> (3 - uVar14) * 8;
        puVar24[4] = (iVar11 << uVar7 * 8 | uVar46 & 0xffffffffU >> (4 - uVar7) * 8) &
                     -1 << (uVar15 + 1) * 8 | uVar20 >> (3 - uVar15) * 8;
        puVar24[5] = (iVar12 << uVar8 * 8 | uVar45 & 0xffffffffU >> (4 - uVar8) * 8) &
                     -1 << (uVar16 + 1) * 8 | uVar21 >> (3 - uVar16) * 8;
        puVar24[6] = uVar42;
        puVar24[7] = uVar38;
        if (iStack_534 != 0) {
          *(char *)(iVar55 + iVar27) = (char)((uint)uStack_538 >> 8);
          *(undefined *)((int)puVar31 + 0x41) = (undefined)uStack_538;
          if ((uStack_538 != 0) || (iStack_53c != 0)) {
            (*(code *)PTR_memcpy_006aabf4)(iVar55 + uStack_540 + 0x42,iStack_53c,uStack_538);
          }
        }
        iVar27 = (*(code *)PTR_memcmp_006aabd8)(iVar55,"client finished",0xf);
        if (((iVar27 == 0) ||
            (iVar27 = (*(code *)PTR_memcmp_006aabd8)(iVar55,"server finished",0xf), iVar27 == 0)) ||
           ((iVar27 = (*(code *)PTR_memcmp_006aabd8)(iVar55,"master secret",0xd), iVar27 == 0 ||
            (iVar27 = (*(code *)PTR_memcmp_006aabd8)(iVar55,"key expansion",0xd), iVar27 == 0)))) {
          uVar23 = 0;
          (*(code *)PTR_ERR_put_error_006a9030)(0x14,0x13a,0x16f,&DAT_00647bcc,0x4b1);
        }
        else {
          uVar23 = tls1_PRF_constprop_1
                             (*(undefined4 *)(*(int *)(*(int *)(uVar23 + 0x58) + 0x344) + 0x24),
                              iVar55,iVar28,0,0,0,0,0,0,*(int *)(uVar23 + 0xc0) + 0x14,
                              *(undefined4 *)(*(int *)(uVar23 + 0xc0) + 0x10),puVar53,iVar25,piVar40
                             );
        }
        (*(code *)PTR_CRYPTO_free_006a7f88)(iVar25);
        (*(code *)PTR_CRYPTO_free_006a7f88)(iVar55);
      }
      return uVar23;
    }
    if ((uStack_4ec << 10 & uVar23) != 0) {
      if (iStack_4e8 == 0) {
        piVar40 = (int *)0x146;
        puVar44 = (undefined4 *)&DAT_00647bcc;
        uStack_540 = 0x114;
        puVar53 = (uint *)0x11c;
        (*(code *)PTR_ERR_put_error_006a9030)(0x14);
        goto LAB_0049b79c;
      }
      uStack_538 = 0x20;
      iStack_534 = 0;
      uStack_540 = 0xd;
      puVar53 = (uint *)pcVar39;
      piVar40 = (int *)(((uint)puVar43 & 1) + iVar28);
      puVar44 = (undefined4 *)pcStack_500;
      iVar29 = tls1_P_hash_constprop_2();
      iStack_53c = iVar27;
      if (iVar29 == 0) goto LAB_0049b79c;
      pcVar39 = (char *)((int)pcVar39 + iVar28);
      puVar53 = &uStack_4e4;
      puVar31 = puVar24;
      if (((uint)puVar24 & 3) == 0 &&
          ((uint *)(iVar55 + 0x18) <= &uStack_4e4 || &uStack_4e0 <= puVar24)) {
        *(uint *)(iVar55 + 0x14) = *(uint *)(iVar55 + 0x14) ^ uStack_4e4;
        *(uint *)(iVar55 + 0x18) = uStack_4e0 ^ *(uint *)(iVar55 + 0x18);
        puVar44 = (undefined4 *)(uStack_4cc ^ *(uint *)(iVar55 + 0x2c));
        in_t3 = uStack_4d0 ^ *(uint *)(iVar55 + 0x28);
        *(uint *)(iVar55 + 0x1c) = uStack_4dc ^ *(uint *)(iVar55 + 0x1c);
        *(uint *)(iVar55 + 0x20) = uStack_4d8 ^ *(uint *)(iVar55 + 0x20);
        *(uint *)(iVar55 + 0x24) = uStack_4d4 ^ *(uint *)(iVar55 + 0x24);
        *(uint *)(iVar55 + 0x28) = in_t3;
        *(undefined4 **)(iVar55 + 0x2c) = puVar44;
        *(uint *)(iVar55 + 0x30) = uStack_4c8 ^ *(uint *)(iVar55 + 0x30);
        *(uint *)(iVar55 + 0x38) = uStack_4c0 ^ *(uint *)(iVar55 + 0x38);
        *(uint *)(iVar55 + 0x34) = uStack_4c4 ^ *(uint *)(iVar55 + 0x34);
        *(uint *)(iVar55 + 0x3c) = uStack_4bc ^ *(uint *)(iVar55 + 0x3c);
        *(uint *)(iVar55 + 0x40) = *(uint *)(iVar55 + 0x40) ^ uStack_4b8;
      }
      else {
        do {
          puVar30 = (uint *)((int)puVar53 + 1);
          *(byte *)puVar31 = *(byte *)puVar31 ^ *(byte *)puVar53;
          puVar53 = puVar30;
          puVar31 = (uint *)((int)puVar31 + 1);
        } while (puVar30 != &uStack_4b4);
      }
    }
    iVar25 = iVar25 + 1;
    puVar53 = &uStack_4ec;
    piVar40 = &iStack_4e8;
    iVar29 = ssl_get_handshake_digest(iVar25);
  } while( true );
}

