
/* WARNING: Could not reconcile some variable overlaps */

int ****** tls1_change_cipher_state(int *****param_1,int ******param_2)

{
  byte bVar1;
  undefined2 uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  byte bVar21;
  byte bVar22;
  int ****ppppiVar23;
  uint uVar24;
  int ******ppppppiVar25;
  int iVar26;
  undefined4 uVar27;
  int ***pppiVar28;
  undefined4 *puVar29;
  int ******ppppppiVar30;
  uint *puVar31;
  int iVar32;
  uint *puVar33;
  undefined4 uVar34;
  char cVar36;
  uint *puVar35;
  int iVar37;
  undefined uVar42;
  uint uVar38;
  uint *puVar39;
  int iVar40;
  int iVar41;
  uint uVar43;
  char *pcVar44;
  int *piVar45;
  uint uVar46;
  uint uVar47;
  int ******ppppppiVar48;
  uint uVar49;
  int ******in_t0;
  uint uVar50;
  uint in_t1;
  uint uVar51;
  uint in_t2;
  uint uVar52;
  uint in_t3;
  uint uVar53;
  uint uVar54;
  int ******unaff_s4;
  int iVar55;
  undefined *puVar56;
  int *****pppppiVar57;
  code *pcVar58;
  int *****pppppiVar59;
  int ******ppppppiVar60;
  int iVar61;
  uint uStack_540;
  int iStack_53c;
  undefined4 uStack_538;
  int iStack_534;
  char *pcStack_500;
  int iStack_4ec;
  int iStack_4e8;
  uint uStack_4e4;
  uint uStack_4e0;
  uint uStack_4dc;
  uint uStack_4d8;
  uint uStack_4d4;
  uint uStack_4d0;
  uint uStack_4cc;
  uint uStack_4c8;
  uint uStack_4c4;
  uint uStack_4c0;
  uint uStack_4bc;
  uint uStack_4b8;
  uint uStack_4b4;
  undefined4 *puStack_4b0;
  int *piStack_4ac;
  int **ppiStack_4a8;
  uint uStack_4a4;
  undefined *puStack_4a0;
  undefined *puStack_49c;
  int *piStack_498;
  int *****pppppiStack_494;
  int ******ppppppiStack_490;
  code *pcStack_48c;
  int *piStack_478;
  int iStack_474;
  int *****pppppiStack_470;
  int iStack_46c;
  undefined4 uStack_468;
  undefined4 uStack_464;
  undefined *puStack_460;
  int ******ppppppiStack_454;
  int ******ppppppiStack_450;
  int ******ppppppiStack_44c;
  int ******ppppppiStack_448;
  undefined auStack_444 [24];
  undefined auStack_42c [4];
  undefined auStack_428 [4];
  int *****pppppiStack_424;
  undefined4 uStack_420;
  undefined uStack_41c;
  undefined uStack_41b;
  undefined uStack_41a;
  undefined uStack_419;
  undefined uStack_418;
  int iStack_414;
  int ******ppppppiStack_410;
  int ******ppppppiStack_40c;
  int *****pppppiStack_408;
  int ******ppppppiStack_404;
  int *piStack_400;
  char *pcStack_3fc;
  int ******ppppppiStack_3f8;
  int *****pppppiStack_3f4;
  int ******ppppppiStack_3f0;
  code *pcStack_3ec;
  int ******ppppppiStack_3d8;
  undefined *puStack_3d4;
  int iStack_3d0;
  undefined4 uStack_3cc;
  undefined4 uStack_3c8;
  undefined4 uStack_3c4;
  undefined4 uStack_3c0;
  int ******ppppppiStack_3bc;
  undefined4 uStack_3b8;
  undefined *puStack_3b0;
  int iStack_3a8;
  undefined *puStack_3a4;
  int ******ppppppiStack_3a0;
  int iStack_39c;
  int iStack_398;
  int **ppiStack_394;
  undefined *puStack_390;
  int ******ppppppiStack_38c;
  int ******ppppppiStack_384;
  uint uStack_380;
  undefined4 uStack_37c;
  int iStack_378;
  int *****pppppiStack_374;
  undefined auStack_370 [24];
  byte bStack_358;
  byte bStack_357;
  byte bStack_356;
  byte bStack_355;
  byte bStack_354;
  byte bStack_353;
  byte bStack_352;
  byte bStack_351;
  byte bStack_350;
  byte bStack_34f;
  byte bStack_34e;
  byte bStack_34d;
  undefined auStack_34c [128];
  int *piStack_2cc;
  int ******ppppppiStack_2c8;
  int ******ppppppiStack_2c4;
  int *****pppppiStack_2c0;
  int ******ppppppiStack_2bc;
  undefined *puStack_2b8;
  int ******ppppppiStack_2b4;
  char *pcStack_2b0;
  int *****pppppiStack_2ac;
  int ******ppppppiStack_2a8;
  code *pcStack_2a4;
  int ******ppppppiStack_298;
  undefined4 uStack_290;
  undefined *puStack_288;
  int ******ppppppiStack_280;
  int *****apppppiStack_27c [6];
  int ******ppppppiStack_264;
  int ******ppppppiStack_25c;
  int *piStack_258;
  int *****pppppiStack_254;
  char *pcStack_250;
  undefined *puStack_24c;
  char *pcStack_248;
  code *pcStack_244;
  undefined4 uStack_230;
  undefined *puStack_228;
  undefined auStack_220 [4];
  undefined auStack_21c [8];
  int *****pppppiStack_214;
  undefined4 uStack_210;
  undefined uStack_20c;
  undefined uStack_20b;
  undefined uStack_20a;
  undefined uStack_209;
  undefined uStack_208;
  int ******ppppppiStack_204;
  int ******ppppppiStack_200;
  undefined *puStack_1fc;
  int ******ppppppiStack_1f8;
  int **ppiStack_1f4;
  int ******ppppppiStack_1f0;
  int ******ppppppiStack_1ec;
  int ******ppppppiStack_1e8;
  int *****pppppiStack_1e4;
  int ******ppppppiStack_1e0;
  code *pcStack_1dc;
  int ****ppppiStack_1c8;
  int ******ppppppiStack_1c4;
  undefined4 uStack_1c0;
  undefined4 uStack_1bc;
  undefined4 uStack_1b8;
  int *****pppppiStack_1b4;
  int ****ppppiStack_1b0;
  int ******ppppppiStack_1ac;
  int **ppiStack_1a8;
  int ******ppppppiStack_1a4;
  undefined *puStack_1a0;
  int ******ppppppiStack_194;
  int ****ppppiStack_190;
  int ****ppppiStack_18c;
  int *****pppppiStack_188;
  int ****ppppiStack_184;
  int ****ppppiStack_180;
  int *piStack_17c;
  int ******ppppppiStack_174;
  int ******ppppppiStack_170;
  int ******ppppppiStack_16c;
  int **ppiStack_168;
  int ******ppppppiStack_164;
  undefined *puStack_160;
  code *pcStack_15c;
  int ******local_148;
  int ******local_144;
  undefined4 local_140;
  undefined4 local_13c;
  undefined4 local_138;
  int ******local_134;
  int ******local_130;
  int ******local_12c;
  undefined *local_128;
  int local_124;
  undefined *local_120;
  int ******local_114;
  int ******local_110;
  int ******local_10c;
  int ******local_108;
  int ******local_104;
  int ******local_100;
  int ***local_fc;
  int ******local_f8;
  int local_f4;
  int *****apppppiStack_ec [8];
  undefined auStack_cc [32];
  int *****apppppiStack_ac [16];
  undefined auStack_6c [64];
  int ******local_2c;
  
  pcStack_248 = PTR___stack_chk_guard_006a9ae8;
  ppppiVar23 = param_1[0x16];
  ppppppiStack_3f0 = (int ******)((uint)param_2 & 1);
  local_fc = ppppiVar23[0xe0];
  local_120 = &_gp;
  local_100 = (int ******)ppppiVar23[0xe1];
  local_2c = *(int *******)PTR___stack_chk_guard_006a9ae8;
  ppppppiStack_174 = (int ******)ppppiVar23[0xdf];
  pcStack_2b0 = (char *)ppppiVar23[0xe3];
  ppiStack_1f4 = ppppiVar23[0xd1][8];
  uVar24 = (uint)ppppiVar23[0xd1][9] & 4;
  if (ppppppiStack_3f0 == (int ******)0x0) {
    if (uVar24 == 0) {
      ppppiVar23 = (int ****)((uint)param_1[0x1f] & 0xfffffffd);
    }
    else {
      ppppiVar23 = (int ****)((uint)param_1[0x1f] | 2);
    }
    ppppppiStack_1f8 = (int ******)param_1[0x23];
    param_1[0x1f] = ppppiVar23;
    if ((ppppppiStack_1f8 == (int ******)0x0) ||
       (unaff_s4 = (int ******)0x1, *param_1[2] == (int ***)0xfeff)) {
      ppppppiStack_1f8 = (int ******)(*(code *)PTR_EVP_CIPHER_CTX_new_006a81f8)();
      param_1[0x23] = (int ****)ppppppiStack_1f8;
      if (ppppppiStack_1f8 != (int ******)0x0) {
        if (*param_1[2] != (int ***)0xfeff) {
          unaff_s4 = (int ******)0x0;
          goto LAB_004960b8;
        }
        local_104 = (int ******)(**(code **)(local_120 + -0x6d5c))();
        if (local_104 == (int ******)0x0) goto LAB_004962d8;
        param_1[0x24] = (int ****)local_104;
        unaff_s4 = (int ******)0x0;
        goto LAB_004960d4;
      }
    }
    else {
LAB_004960b8:
      local_104 = (int ******)ssl_replace_hash(param_1 + 0x24,0);
      if (local_104 != (int ******)0x0) {
LAB_004960d4:
        if (param_1[0x25] != (int ****)0x0) {
          (**(code **)(local_120 + -0x6d00))();
          param_1[0x25] = (int ****)0x0;
        }
        if ((int ******)pcStack_2b0 == (int ******)0x0) {
LAB_0049610c:
          if (*param_1 != (int ****)0xfeff) {
            ppppiVar23 = param_1[0x16];
            *(undefined *)(ppppiVar23 + 0x15) = 0;
            *(undefined *)((int)ppppiVar23 + 0x55) = 0;
            *(undefined *)((int)ppppiVar23 + 0x56) = 0;
            *(undefined *)((int)ppppiVar23 + 0x57) = 0;
            *(undefined *)(ppppiVar23 + 0x16) = 0;
            *(undefined *)((int)ppppiVar23 + 0x59) = 0;
            *(undefined *)((int)ppppiVar23 + 0x5a) = 0;
            *(undefined *)((int)ppppiVar23 + 0x5b) = 0;
          }
          pcStack_2b0 = (char *)param_1[0x16];
          local_10c = (int ******)((int)pcStack_2b0 + 0x60);
          local_114 = (int ******)((int)pcStack_2b0 + 0x5c);
          goto joined_r0x00496150;
        }
        ppppiVar23 = (int ****)
                     (**(code **)(local_120 + -0x6cfc))(*(int ******)((int)pcStack_2b0 + 8));
        param_1[0x25] = ppppiVar23;
        if (ppppiVar23 != (int ****)0x0) goto LAB_0049610c;
        pcVar58 = *(code **)(local_120 + -0x6eac);
        pcStack_3fc = (char *)0x8e;
        local_148 = (int ******)0x1bd;
LAB_0049646c:
        ppppppiVar48 = (int ******)&DAT_0064760c;
        pcStack_250 = (char *)0xd1;
        (*pcVar58)(0x14);
        goto LAB_00496214;
      }
    }
LAB_004962d8:
    ppppppiVar48 = (int ******)&DAT_0064760c;
    pcStack_3fc = &DAT_00000041;
    pcStack_250 = (char *)0xd1;
    local_148 = (int ******)0x262;
    ppppppiStack_3f0 = (int ******)0x0;
    (**(code **)(local_120 + -0x6eac))(0x14);
  }
  else {
    if (uVar24 == 0) {
      ppppiVar23 = (int ****)((uint)param_1[0x1f] & 0xfffffffe);
    }
    else {
      ppppiVar23 = (int ****)((uint)param_1[0x1f] | 1);
    }
    ppppppiStack_1f8 = (int ******)param_1[0x20];
    param_1[0x1f] = ppppiVar23;
    if (ppppppiStack_1f8 == (int ******)0x0) {
      ppppiVar23 = (int ****)(*(code *)PTR_CRYPTO_malloc_006a7008)(0x8c,&DAT_0064760c,0x17b);
      param_1[0x20] = ppppiVar23;
      if (ppppiVar23 == (int ****)0x0) goto LAB_004962d8;
      unaff_s4 = (int ******)0x0;
      (**(code **)(local_120 + -0x737c))(ppppiVar23);
      ppppppiStack_1f8 = (int ******)param_1[0x20];
    }
    else {
      unaff_s4 = (int ******)0x1;
    }
    local_104 = (int ******)ssl_replace_hash(param_1 + 0x21,0);
    if (local_104 == (int ******)0x0) goto LAB_004962d8;
    if (param_1[0x22] != (int ****)0x0) {
      (**(code **)(local_120 + -0x6d00))();
      param_1[0x22] = (int ****)0x0;
    }
    if ((int ******)pcStack_2b0 == (int ******)0x0) {
      pcStack_2b0 = (char *)param_1[0x16];
LAB_00495d24:
      ppppiVar23 = *param_1;
LAB_00495d28:
      if (ppppiVar23 != (int ****)0xfeff) {
        *(undefined *)((int)pcStack_2b0 + 8) = 0;
        *(undefined *)((int)pcStack_2b0 + 9) = 0;
        *(undefined *)((int)pcStack_2b0 + 10) = 0;
        *(undefined *)((int)pcStack_2b0 + 0xb) = 0;
        *(undefined *)((int)pcStack_2b0 + 0xc) = 0;
        *(undefined *)((int)pcStack_2b0 + 0xd) = 0;
        *(undefined *)((int)pcStack_2b0 + 0xe) = 0;
        *(undefined *)((int)pcStack_2b0 + 0xf) = 0;
        pcStack_2b0 = (char *)param_1[0x16];
      }
      local_10c = (int ******)((int)pcStack_2b0 + 0x14);
      local_114 = (int ******)((int)pcStack_2b0 + 0x10);
joined_r0x00496150:
      if (unaff_s4 != (int ******)0x0) {
        (**(code **)(local_120 + -0x736c))(ppppppiStack_1f8);
        pcStack_2b0 = (char *)param_1[0x16];
      }
      pppppiVar59 = *(int ******)((int)pcStack_2b0 + 0x388);
      ppiStack_1f4 = (int **)((uint)ppiStack_1f4 & 2);
      pcVar58 = *(code **)(local_120 + -0x788c);
      pppppiVar57 = *(int ******)((int)pcStack_2b0 + 0x378);
      *local_114 = pppppiVar59;
      unaff_s4 = (int ******)(*pcVar58)(ppppppiStack_174);
      if (ppiStack_1f4 != (int **)0x0) {
        if (((uint)param_1[0x16][0xd1][8] & 8) == 0) {
          ppppppiVar25 = (int ******)&DAT_00000008;
          if (param_1[0x16][0xd1][5] != (int **)0x1) {
            ppppppiVar25 = (int ******)&DAT_00000007;
          }
          if ((int)ppppppiVar25 < (int)unaff_s4) {
            unaff_s4 = ppppppiVar25;
          }
        }
        else if (5 < (int)unaff_s4) {
          unaff_s4 = (int ******)&DAT_00000005;
        }
      }
      uVar24 = (**(code **)(local_120 + -0x789c))(ppppppiStack_174);
      if ((uVar24 & 0xf0007) == 6) {
        local_110 = (int ******)&SUB_00000004;
        if (param_2 != (int ******)&DAT_00000012) goto LAB_00495e14;
LAB_004961a0:
        local_108 = (int ******)((int)pppppiVar57 + (int)pppppiVar59 * 2);
        iVar26 = (int)unaff_s4 * 2 + (int)pppppiVar59 * 2;
        local_f8 = (int ******)((int)pppppiVar57 + iVar26);
        local_f4 = 1;
        pcStack_2b0 = (char *)((int)&PTR_s__00647617 + 1);
        if ((int)param_1[0x16][0xdd] < (int)local_110 * 2 + iVar26) {
LAB_004961e8:
          pcVar58 = *(code **)(local_120 + -0x6eac);
          pcStack_3fc = (char *)0x44;
          local_148 = (int ******)0x1f3;
          goto LAB_004961fc;
        }
      }
      else {
        local_110 = (int ******)(**(code **)(local_120 + -0x7890))(ppppppiStack_174);
        if (param_2 == (int ******)&DAT_00000012) goto LAB_004961a0;
LAB_00495e14:
        if (param_2 == (int ******)0x21) goto LAB_004961a0;
        iVar37 = (int)unaff_s4 + (int)pppppiVar59 * 2;
        local_f4 = 0;
        iVar26 = (int)local_110 + (int)unaff_s4 + iVar37;
        local_108 = (int ******)((int)pppppiVar57 + iVar37);
        local_f8 = (int ******)((int)pppppiVar57 + iVar26);
        pcStack_2b0 = "server write key";
        pppppiVar57 = (int *****)((int)pppppiVar57 + (int)pppppiVar59);
        if ((int)param_1[0x16][0xdd] < (int)local_110 + iVar26) goto LAB_004961e8;
      }
      (**(code **)(local_120 + -0x52f4))(local_10c,pppppiVar57,pppppiVar59);
      iVar26 = (**(code **)(local_120 + -0x789c))(ppppppiStack_174);
      ppppppiVar25 = (int ******)pcStack_2b0;
      if (-1 < iVar26 << 10) {
        in_t0 = (int ******)(**(code **)(local_120 + -0x78f0))(local_100,0,local_10c,*local_114);
        if ((in_t0 != (int ******)0x0) &&
           (local_148 = in_t0, local_100 = in_t0,
           iVar26 = (**(code **)(local_120 + -0x7fc0))(local_104,0,local_fc,0), in_t0 = local_100,
           0 < iVar26)) {
          (**(code **)(local_120 + -0x7f68))(local_100);
          ppppppiVar48 = local_f8;
          if (ppiStack_1f4 != (int **)0x0) goto LAB_00495e98;
          goto LAB_00495fa8;
        }
        (**(code **)(local_120 + -0x7f68))(in_t0);
        pcStack_3fc = (char *)0x44;
        local_148 = (int ******)0x1ff;
        pcVar58 = *(code **)(local_120 + -0x6eac);
        goto LAB_004961fc;
      }
      ppppppiVar48 = local_f8;
      if (ppiStack_1f4 == (int **)0x0) {
LAB_00495fa8:
        local_f8 = ppppppiVar48;
        pcVar58 = *(code **)(local_120 + -0x789c);
        param_2 = (int ******)((uint)param_2 & 2);
        param_1[0x30][1] = (int ***)0x0;
        uVar24 = (*pcVar58)(ppppppiStack_174);
        pcStack_3fc = (char *)0x0;
        pcStack_2b0 = (char *)ppppppiVar25;
        local_144 = param_2;
        if ((uVar24 & 0xf0007) == 6) {
          local_148 = (int ******)0x0;
          iVar26 = (**(code **)(local_120 + -0x7880))(ppppppiStack_1f8,ppppppiStack_174,0,local_108)
          ;
          if ((iVar26 == 0) ||
             (pcStack_3fc = (char *)local_110, ppppppiVar48 = local_f8,
             iVar26 = (**(code **)(local_120 + -0x6bec))(ppppppiStack_1f8,0x12), iVar26 == 0)) {
            pcVar58 = *(code **)(local_120 + -0x6eac);
            pcStack_3fc = (char *)0x44;
            local_148 = (int ******)0x23b;
            goto LAB_004961fc;
          }
        }
        else {
          local_148 = local_f8;
          ppppppiVar48 = local_108;
          ppppppiStack_3f0 =
               (int ******)(**(code **)(local_120 + -0x7880))(ppppppiStack_1f8,ppppppiStack_174);
          if (ppppppiStack_3f0 == (int ******)0x0) {
            pcVar58 = *(code **)(local_120 + -0x6eac);
            pcStack_3fc = (char *)0x44;
            local_148 = (int ******)0x240;
            goto LAB_0049646c;
          }
        }
        iVar26 = (**(code **)(local_120 + -0x789c))(ppppppiStack_174);
        if (iVar26 << 10 < 0) {
          pcStack_3fc = (char *)*local_114;
          if (((int ******)pcStack_3fc != (int ******)0x0) &&
             (ppppppiVar48 = local_10c,
             ppppppiStack_3f0 =
                  (int ******)(**(code **)(local_120 + -0x6bec))(ppppppiStack_1f8,0x17),
             ppppppiStack_3f0 == (int ******)0x0)) {
            pcVar58 = *(code **)(local_120 + -0x6eac);
            pcStack_3fc = (char *)0x44;
            local_148 = (int ******)0x248;
            goto LAB_0049646c;
          }
        }
        ppppppiStack_3f0 = (int ******)0x1;
        (**(code **)(local_120 + -0x7d6c))(apppppiStack_ac,0x40);
        (**(code **)(local_120 + -0x7d6c))(auStack_6c,0x40);
        (**(code **)(local_120 + -0x7d6c))(apppppiStack_ec,0x20);
        pcStack_250 = &DAT_00000020;
        (**(code **)(local_120 + -0x7d6c))(auStack_cc);
        goto LAB_00496214;
      }
LAB_00495e98:
      ppiStack_1f4 = (int **)0x20;
      local_104 = (int ******)ssl_get_algorithm2(param_1);
      local_100 = (int ******)param_1[0x16];
      local_124 = (**(code **)(local_120 + -0x788c))(ppppppiStack_174);
      local_128 = auStack_6c;
      pcStack_3fc = &SUB_00000010;
      local_144 = local_100 + 0x28;
      ppppppiVar48 = local_100 + 0x30;
      local_134 = local_108;
      local_138 = 0;
      local_13c = 0;
      local_140 = 0x20;
      local_148 = (int ******)&DAT_00000020;
      pcStack_250 = pcStack_2b0;
      in_t0 = local_104;
      local_130 = unaff_s4;
      local_12c = apppppiStack_ac;
      iVar26 = tls1_PRF_constprop_1(local_104);
      ppppppiVar25 = local_110;
      if (iVar26 != 0) {
        if (0 < (int)local_110) {
          unaff_s4 = apppppiStack_ec;
          uVar27 = ssl_get_algorithm2(param_1);
          local_124 = (int)ppppppiVar25 << 1;
          pcStack_3fc = &DAT_00000008;
          local_130 = (int ******)0x0;
          in_t0 = (int ******)(param_1[0x16] + 0x28);
          local_134 = (int ******)&empty_15940;
          local_128 = auStack_cc;
          local_138 = 0;
          ppppppiVar48 = (int ******)(param_1[0x16] + 0x30);
          local_13c = 0;
          pcStack_250 = "IV block";
          local_140 = 0x20;
          local_148 = (int ******)&DAT_00000020;
          local_144 = in_t0;
          local_12c = unaff_s4;
          iVar26 = tls1_PRF_constprop_1(uVar27);
          pcStack_2b0 = (char *)ppppppiVar25;
          if (iVar26 == 0) goto LAB_00496210;
          local_108 = apppppiStack_ac;
          local_f8 = unaff_s4;
          ppppppiVar48 = (int ******)((int)unaff_s4 + (int)ppppppiVar25);
          if (local_f4 == 0) goto LAB_00495fa8;
        }
        local_108 = apppppiStack_ac;
        ppppppiVar48 = local_f8;
        goto LAB_00495fa8;
      }
    }
    else {
      ppppiVar23 = (int ****)(**(code **)(local_120 + -0x6cfc))(*(int ******)((int)pcStack_2b0 + 8))
      ;
      param_1[0x22] = ppppiVar23;
      if (ppppiVar23 != (int ****)0x0) {
        pcStack_2b0 = (char *)param_1[0x16];
        if (*(int ******)((int)pcStack_2b0 + 0x120) != (int *****)0x0) goto LAB_00495d24;
        pppppiVar57 = (int *****)(**(code **)(local_120 + -0x7dd8))(0x4540,&DAT_0064760c,0x194);
        *(int ******)((int)pcStack_2b0 + 0x120) = pppppiVar57;
        pcStack_2b0 = (char *)param_1[0x16];
        if (*(int ******)((int)pcStack_2b0 + 0x120) == (int *****)0x0) goto LAB_004962d8;
        ppppiVar23 = *param_1;
        goto LAB_00495d28;
      }
      pcVar58 = *(code **)(local_120 + -0x6eac);
      pcStack_3fc = (char *)0x8e;
      local_148 = (int ******)0x18f;
LAB_004961fc:
      ppppppiVar48 = (int ******)&DAT_0064760c;
      pcStack_250 = (char *)0xd1;
      (*pcVar58)(0x14);
    }
LAB_00496210:
    ppppppiStack_3f0 = (int ******)0x0;
  }
LAB_00496214:
  if (local_2c == *(int *******)pcStack_248) {
    return ppppppiStack_3f0;
  }
  pcStack_15c = tls1_setup_key_block;
  ppppppiVar60 = local_2c;
  (**(code **)(local_120 + -0x5330))();
  puStack_1fc = PTR___stack_chk_guard_006a9ae8;
  puStack_160 = pcStack_248;
  puStack_1a0 = &_gp;
  ppppiStack_184 = (int ****)0x0;
  ppppiStack_180 = (int ****)0x0;
  piStack_17c = *(int **)PTR___stack_chk_guard_006a9ae8;
  ppppppiVar25 = (int ******)0x1;
  ppppppiStack_200 = ppppppiStack_174;
  ppppppiStack_170 = param_2;
  ppppppiStack_16c = ppppppiStack_1f8;
  ppiStack_168 = ppiStack_1f4;
  ppppppiStack_164 = unaff_s4;
  if (ppppppiVar60[0x16][0xdd] == (int ****)0x0) {
    ppppppiStack_1c4 = &pppppiStack_188;
    ppppiStack_1c8 = (int ****)&ppppiStack_180;
    ppppppiVar25 = (int ******)
                   ssl_cipher_get_evp(ppppppiVar60[0x30],&ppppiStack_190,&ppppiStack_18c,
                                      &ppppiStack_184);
    ppppppiStack_200 = ppppppiVar60;
    if (ppppppiVar25 == (int ******)0x0) {
      pcStack_3fc = (char *)0x8a;
      ppppppiVar48 = (int ******)&DAT_0064760c;
      ppppiStack_1c8 = (int ****)0x27a;
      pcStack_250 = (char *)0xd3;
      ppppppiStack_194 = ppppppiVar25;
      (**(code **)(puStack_1a0 + -0x6eac))(0x14);
      ppppppiVar25 = ppppppiStack_194;
    }
    else {
      pcStack_248 = "-check_ss_sig";
      pppppiVar57 = ppppppiVar60[0x16];
      pcVar58 = *(code **)(puStack_1a0 + -0x788c);
      pppppiVar57[0xdf] = ppppiStack_190;
      pppppiVar57[0xe0] = ppppiStack_18c;
      pppppiVar57[0xe1] = ppppiStack_184;
      pppppiVar57[0xe2] = ppppiStack_180;
      iVar26 = (*pcVar58)(ppppiStack_190);
      ppppiVar23 = ppppiStack_180;
      iVar37 = (**(code **)(puStack_1a0 + -0x7890))(ppppiStack_190);
      ppppppiStack_1f8 = (int ******)(((int)ppppiVar23 + iVar37 + iVar26) * 2);
      ssl3_cleanup_key_block(ppppppiVar60);
      unaff_s4 = (int ******)
                 (**(code **)(puStack_1a0 + -0x7dd8))(ppppppiStack_1f8,&DAT_0064760c,0x288);
      if (unaff_s4 == (int ******)0x0) {
        ppppppiVar48 = (int ******)&DAT_0064760c;
        pcStack_3fc = &DAT_00000041;
        pcStack_250 = (char *)0xd3;
        ppppiStack_1c8 = (int ****)0x289;
        (**(code **)(puStack_1a0 + -0x6eac))(0x14);
        ppppppiVar25 = (int ******)0x0;
      }
      else {
        pppppiVar57 = ppppppiVar60[0x16];
        pcVar58 = *(code **)(puStack_1a0 + -0x7dd8);
        pppppiVar57[0xdd] = (int ****)ppppppiStack_1f8;
        pppppiVar57[0xde] = (int ****)unaff_s4;
        ppiStack_1f4 = (int **)(*pcVar58)(ppppppiStack_1f8,&DAT_0064760c,0x290);
        if (ppiStack_1f4 == (int **)0x0) {
          ppppppiVar48 = (int ******)&DAT_0064760c;
          pcStack_3fc = &DAT_00000041;
          pcStack_250 = (char *)0xd3;
          ppppiStack_1c8 = (int ****)0x291;
          (**(code **)(puStack_1a0 + -0x6eac))(0x14);
          (**(code **)(puStack_1a0 + -0x7f58))(unaff_s4);
          ppppppiVar25 = (int ******)0x0;
        }
        else {
          pcStack_248 = &DAT_00000020;
          uVar27 = ssl_get_algorithm2(ppppppiVar60);
          pcStack_3fc = &DAT_0000000d;
          pppppiStack_1b4 = ppppppiVar60[0x30] + 5;
          in_t0 = (int ******)(ppppppiVar60[0x16] + 0x30);
          ppppiStack_1b0 = ppppppiVar60[0x30][4];
          ppppppiVar48 = (int ******)(ppppppiVar60[0x16] + 0x28);
          uStack_1b8 = 0;
          uStack_1bc = 0;
          uStack_1c0 = 0x20;
          ppppiStack_1c8 = (int ****)0x20;
          ppppppiStack_1c4 = in_t0;
          ppppppiStack_1ac = unaff_s4;
          ppiStack_1a8 = ppiStack_1f4;
          ppppppiStack_1a4 = ppppppiStack_1f8;
          iVar26 = tls1_PRF_constprop_1(uVar27,"key expansion");
          if (iVar26 == 0) {
            ppppppiVar25 = (int ******)0x0;
          }
          else {
            if ((((uint)ppppppiVar60[0x40] & 0x800) == 0) && ((int)*ppppppiVar60[2] < 0x302)) {
              pppppiVar57 = ppppppiVar60[0x16];
              ppppiVar23 = ppppppiVar60[0x30][0x2d];
              pppppiVar57[0x38] = (int ****)0x1;
              if (ppppiVar23 != (int ****)0x0) {
                pppiVar28 = ppppiVar23[5];
                if (pppiVar28 == (int ***)0x20) {
                  pppppiVar57[0x38] = (int ****)0x0;
                }
                else {
                  ppppppiVar25 = (int ******)0x1;
                  if (pppiVar28 == (int ***)0x4) {
                    pppppiVar57[0x38] = (int ****)0x0;
                    goto LAB_00496734;
                  }
                }
              }
            }
            ppppppiVar25 = (int ******)0x1;
          }
LAB_00496734:
          pcStack_250 = (char *)ppppppiStack_1f8;
          (**(code **)(puStack_1a0 + -0x7d6c))(ppiStack_1f4);
          (**(code **)(puStack_1a0 + -0x7f58))(ppiStack_1f4);
          ppppppiStack_200 = ppppppiVar25;
        }
      }
    }
  }
  if (piStack_17c == *(int **)puStack_1fc) {
    return ppppppiVar25;
  }
  pcStack_1dc = tls1_enc;
  piStack_258 = piStack_17c;
  (**(code **)(puStack_1a0 + -0x5330))();
  puStack_24c = PTR___stack_chk_guard_006a9ae8;
  puStack_228 = &_gp;
  ppppppiStack_204 = *(int *******)PTR___stack_chk_guard_006a9ae8;
  ppppppiStack_404 = (int ******)pcStack_250;
  ppppppiStack_1f0 = unaff_s4;
  ppppppiStack_1ec = (int ******)pcStack_248;
  ppppppiStack_1e8 = (int ******)pcStack_2b0;
  pppppiStack_1e4 = param_1;
  ppppppiStack_1e0 = ppppppiStack_3f0;
  if ((int ******)pcStack_250 == (int ******)0x0) {
    iVar26 = (*(code *)PTR_EVP_MD_CTX_md_006a7500)(piStack_258[0x21]);
    if (iVar26 != 0) {
      uVar27 = (**(code **)(puStack_228 + -0x78e0))(piStack_258[0x21]);
      iVar26 = (**(code **)(puStack_228 + -0x6fa4))(uVar27);
      if (iVar26 < 0) {
        pcStack_3fc = "n >= 0";
        ppppppiStack_404 = (int ******)0x307;
        (**(code **)(puStack_228 + -0x7184))(&DAT_0064760c);
      }
    }
    pppppiStack_408 = (int *****)piStack_258[0x20];
    ppppppiStack_2c8 = (int ******)(piStack_258[0x16] + 0x10c);
    if (pppppiStack_408 != (int *****)0x0) {
      pcStack_2b0 = (char *)(**(code **)(puStack_228 + -0x6cf4))(pppppiStack_408);
      goto LAB_00496990;
    }
LAB_004968d8:
    pcVar58 = *(code **)(puStack_228 + -0x52ec);
LAB_004968dc:
    pcStack_3fc = (char *)ppppppiStack_2c8[1];
    ppppppiStack_404 = (int ******)ppppppiStack_2c8[4];
    (*pcVar58)(ppppppiStack_2c8[3]);
    ppppppiVar25 = (int ******)0x1;
    ppppppiStack_2c8[4] = ppppppiStack_2c8[3];
  }
  else {
    iVar26 = (*(code *)PTR_EVP_MD_CTX_md_006a7500)(piStack_258[0x24]);
    if (iVar26 != 0) {
      uVar27 = (**(code **)(puStack_228 + -0x78e0))(piStack_258[0x24]);
      iVar26 = (**(code **)(puStack_228 + -0x6fa4))(uVar27);
      if (iVar26 < 0) {
        pcStack_3fc = "n >= 0";
        ppppppiStack_404 = (int ******)0x2e8;
        (**(code **)(puStack_228 + -0x7184))(&DAT_0064760c);
      }
    }
    pcStack_248 = (char *)piStack_258[0x16];
    pppppiStack_408 = (int *****)piStack_258[0x23];
    ppppppiStack_2c8 = (int ******)((int)pcStack_248 + 0x130);
    if (pppppiStack_408 == (int *****)0x0) goto LAB_004968d8;
    pcStack_2b0 = (char *)(**(code **)(puStack_228 + -0x6cf4))(pppppiStack_408);
    if ((0x301 < *piStack_258) &&
       (uVar24 = (**(code **)(puStack_228 + -0x789c))(pcStack_2b0), (uVar24 & 0xf0007) == 2)) {
      ppppppiStack_404 = (int ******)(**(code **)(puStack_228 + -0x7890))(pcStack_2b0);
      if (1 < (int)ppppppiStack_404) {
        if (*(int ******)((int)pcStack_248 + 0x13c) != *(int ******)((int)pcStack_248 + 0x140)) {
          uStack_230 = 0x2ff;
          ppppppiVar48 = (int ******)&DAT_0064760c;
          pcStack_3fc = "%s:%d: rec->data != rec->input\n";
          ppppppiStack_404 = (int ******)0x1;
          (**(code **)(puStack_228 + -0x5460))(**(undefined4 **)(puStack_228 + -0x52e8));
          goto LAB_00496990;
        }
        iVar26 = (**(code **)(puStack_228 + -0x786c))();
        if (0 < iVar26) goto LAB_00496990;
LAB_00496e58:
        ppppppiVar25 = (int ******)0xffffffff;
        goto LAB_004968fc;
      }
LAB_00496990:
      pcVar58 = *(code **)(puStack_228 + -0x52ec);
      if (piStack_258[0x30] != 0) goto LAB_0049699c;
      goto LAB_004968dc;
    }
    if (piStack_258[0x30] == 0) goto LAB_004968d8;
LAB_0049699c:
    if ((int ******)pcStack_2b0 == (int ******)0x0) goto LAB_004968d8;
    ppppppiStack_3f0 = (int ******)ppppppiStack_2c8[1];
    pcStack_248 = (char *)(**(code **)(puStack_228 + -0x6cf0))(*pppppiStack_408);
    iVar26 = (**(code **)(puStack_228 + -0x789c))(*pppppiStack_408);
    if (iVar26 << 10 < 0) {
      iVar26 = *piStack_258;
      if ((int ******)pcStack_250 == (int ******)0x0) {
        puVar29 = (undefined4 *)(piStack_258[0x16] + 8);
        if ((iVar26 == 0xfeff) || (iVar26 == 0x100)) {
          uVar2 = *(undefined2 *)(piStack_258[0x17] + 0x208);
          uVar42 = (undefined)((ushort)uVar2 >> 8);
          goto LAB_004969f8;
        }
LAB_00496c60:
        pppppiStack_214 = (int *****)*puVar29;
        uStack_210 = puVar29[1];
        cVar36 = *(char *)((int)puVar29 + 7) + '\x01';
        *(char *)((int)puVar29 + 7) = cVar36;
        if ((cVar36 == '\0') &&
           (((((cVar36 = *(char *)((int)puVar29 + 6) + '\x01', *(char *)((int)puVar29 + 6) = cVar36,
               cVar36 == '\0' &&
               (cVar36 = *(char *)((int)puVar29 + 5) + '\x01', *(char *)((int)puVar29 + 5) = cVar36,
               cVar36 == '\0')) &&
              (cVar36 = *(char *)(puVar29 + 1), *(char *)(puVar29 + 1) = cVar36 + '\x01',
              (char)(cVar36 + '\x01') == '\0')) &&
             ((cVar36 = *(char *)((int)puVar29 + 3) + '\x01', *(char *)((int)puVar29 + 3) = cVar36,
              cVar36 == '\0' &&
              (cVar36 = *(char *)((int)puVar29 + 2) + '\x01', *(char *)((int)puVar29 + 2) = cVar36,
              cVar36 == '\0')))) &&
            (cVar36 = *(char *)((int)puVar29 + 1) + '\x01', *(char *)((int)puVar29 + 1) = cVar36,
            cVar36 == '\0')))) {
          *(char *)puVar29 = *(char *)puVar29 + '\x01';
        }
        iVar26 = *piStack_258;
      }
      else {
        puVar29 = (undefined4 *)(piStack_258[0x16] + 0x54);
        if ((iVar26 != 0xfeff) && (iVar26 != 0x100)) goto LAB_00496c60;
        uVar2 = *(undefined2 *)(piStack_258[0x17] + 0x20a);
        uVar42 = (undefined)((ushort)uVar2 >> 8);
LAB_004969f8:
        bVar1 = *(byte *)((int)puVar29 + 6);
        in_t0 = (int ******)(uint)bVar1;
        cVar36 = *(char *)((int)puVar29 + 7);
        uVar38 = *(uint *)((int)puVar29 + 2);
        pppppiStack_214 = (int *****)CONCAT13(uVar42,CONCAT12((char)uVar2,SUB42(auStack_220,0)));
        auStack_220 = (undefined  [4])pppppiStack_214;
        puVar56 = auStack_220 + 2;
        uVar24 = (uint)puVar56 & 3;
        *(uint *)(puVar56 + -uVar24) =
             *(uint *)(puVar56 + -uVar24) & -1 << (4 - uVar24) * 8 | uVar38 >> uVar24 * 8;
        puVar56 = auStack_21c + 1;
        uVar24 = (uint)puVar56 & 3;
        *(uint *)(puVar56 + -uVar24) =
             *(uint *)(puVar56 + -uVar24) & 0xffffffffU >> (uVar24 + 1) * 8 |
             uVar38 << (3 - uVar24) * 8;
        auStack_21c._0_4_ = CONCAT31(CONCAT21(auStack_21c._0_2_,bVar1),cVar36);
        uStack_210 = auStack_21c._0_4_;
      }
      ppppppiVar48 = &pppppiStack_214;
      uStack_20a = (undefined)iVar26;
      pcStack_3fc = &DAT_0000000d;
      ppppppiStack_404 = (int ******)&DAT_00000016;
      uStack_20b = (undefined)((uint)iVar26 >> 8);
      uStack_20c = SUB41(*ppppppiStack_2c8,0);
      uStack_208 = SUB41(ppppppiStack_2c8[1],0);
      uStack_209 = (undefined)((uint)ppppppiStack_2c8[1] >> 8);
      param_1 = (int *****)(**(code **)(puStack_228 + -0x6bec))(pppppiStack_408);
      if ((int)param_1 < 1) goto LAB_00496e58;
      if ((int ******)pcStack_250 != (int ******)0x0) {
        ppppppiVar60 = (int ******)((int)ppppppiStack_3f0 + (int)param_1);
        ppppppiStack_2c8[1] = (int *****)((int)ppppppiStack_2c8[1] + (int)param_1);
        ppppppiStack_3f0 = ppppppiVar60;
        if ((int ******)pcStack_250 != (int ******)0x0) goto LAB_00496ab8;
      }
LAB_00496a9c:
      ppppppiVar25 = (int ******)0x0;
      ppppppiVar60 = ppppppiStack_3f0;
      if (ppppppiStack_3f0 != (int ******)0x0) {
LAB_00496aa4:
        if ((int ******)pcStack_248 == (int ******)0x0) {
          trap(7);
        }
        ppppppiVar25 = (int ******)0x0;
        ppppppiStack_3f0 = ppppppiVar60;
        if ((uint)ppppppiVar60 % (uint)pcStack_248 == 0) {
LAB_00496ab8:
          pcVar58 = *(code **)(puStack_228 + -0x6cec);
          ppppppiStack_3f0 = ppppppiVar60;
          goto LAB_00496abc;
        }
      }
    }
    else if ((int ******)pcStack_248 == (int ******)0x1) {
      param_1 = (int *****)0x0;
      if ((int ******)pcStack_250 == (int ******)0x0) goto LAB_00496a9c;
      pcVar58 = *(code **)(puStack_228 + -0x6cec);
LAB_00496abc:
      pcStack_3fc = (char *)ppppppiStack_2c8[4];
      ppppppiStack_404 = (int ******)ppppppiStack_2c8[3];
      ppppppiVar48 = ppppppiStack_3f0;
      uVar24 = (*pcVar58)(pppppiStack_408);
      iVar26 = (**(code **)(puStack_228 + -0x789c))(*pppppiStack_408);
      if (iVar26 << 0xb < 0) {
        pppppiStack_408 = (int *****)(uVar24 >> 0x1f);
      }
      else {
        pppppiStack_408 = (int *****)(uint)(uVar24 == 0);
      }
      if (pppppiStack_408 != (int *****)0x0) goto LAB_00496e58;
      uVar24 = (**(code **)(puStack_228 + -0x789c))(pcStack_2b0);
      if ((uVar24 & 0xf0007) == 6) {
        pcVar58 = *(code **)(puStack_228 + -0x78e0);
        if ((int ******)pcStack_250 == (int ******)0x0) {
          ppppppiStack_2c8[3] = ppppppiStack_2c8[3] + 2;
          ppppppiStack_2c8[4] = ppppppiStack_2c8[4] + 2;
          ppppppiStack_2c8[1] = ppppppiStack_2c8[1] + -2;
        }
      }
      else {
        pcVar58 = *(code **)(puStack_228 + -0x78e0);
      }
      iVar26 = (*pcVar58)(piStack_258[0x21]);
      if (iVar26 == 0) {
        ppppppiVar60 = (int ******)0x0;
      }
      else {
        uVar27 = (**(code **)(puStack_228 + -0x78e0))(piStack_258[0x21]);
        ppppppiVar60 = (int ******)(**(code **)(puStack_228 + -0x6fa4))(uVar27);
      }
      if ((int ******)pcStack_248 == (int ******)0x1) {
        if (param_1 == (int *****)0x0) goto LAB_00496b64;
        ppppppiVar25 = (int ******)0x1;
        if ((int ******)pcStack_250 == (int ******)0x0) goto LAB_00496c3c;
      }
      else if ((int ******)pcStack_250 == (int ******)0x0) {
        ppppppiStack_404 = ppppppiStack_2c8;
        pcStack_3fc = pcStack_248;
        ppppppiVar25 = (int ******)tls1_cbc_remove_padding(piStack_258);
        ppppppiVar48 = ppppppiVar60;
        if (param_1 != (int *****)0x0) {
LAB_00496c3c:
          param_1 = (int *****)((int)ppppppiStack_2c8[1] - (int)param_1);
          ppppppiStack_2c8[1] = param_1;
        }
      }
      else {
LAB_00496b64:
        ppppppiVar25 = (int ******)0x1;
      }
    }
    else {
      if ((int ******)pcStack_250 != (int ******)0x0) {
        if ((int ******)pcStack_248 == (int ******)0x0) {
          trap(7);
        }
        iVar37 = (int)pcStack_248 - (int)ppppppiStack_3f0 % (int)pcStack_248;
        iVar26 = iVar37 + -1;
        if (((piStack_258[0x40] & 0x200U) != 0) && ((*(uint *)piStack_258[0x16] & 8) != 0)) {
          iVar26 = iVar37;
        }
        ppppppiVar60 = (int ******)((int)ppppppiStack_3f0 + iVar37);
        if ((int)ppppppiStack_3f0 < (int)ppppppiVar60) {
          do {
            puVar56 = (undefined *)((int)ppppppiStack_2c8[4] + (int)ppppppiStack_3f0);
            ppppppiStack_3f0 = (int ******)((int)ppppppiStack_3f0 + 1);
            *puVar56 = (char)iVar26;
          } while (ppppppiVar60 != ppppppiStack_3f0);
        }
        param_1 = (int *****)0x0;
        ppppppiStack_2c8[1] = (int *****)((int)ppppppiStack_2c8[1] + iVar37);
        goto LAB_00496ab8;
      }
      param_1 = (int *****)0x0;
      ppppppiVar60 = ppppppiStack_3f0;
      if (ppppppiStack_3f0 != (int ******)0x0) goto LAB_00496aa4;
      ppppppiVar25 = (int ******)0x0;
    }
  }
LAB_004968fc:
  if (ppppppiStack_204 == *(int *******)puStack_24c) {
    return ppppppiVar25;
  }
  pcStack_244 = tls1_cert_verify_mac;
  ppppppiStack_2c4 = ppppppiStack_204;
  (**(code **)(puStack_228 + -0x5330))();
  piStack_400 = (int *)PTR___stack_chk_guard_006a9ae8;
  pppppiVar57 = ppppppiStack_2c4[0x16];
  puStack_288 = &_gp;
  ppppppiStack_3a0 = *(int *******)PTR___stack_chk_guard_006a9ae8;
  ppppppiStack_490 = (int ******)pcStack_3fc;
  ppppppiStack_264 = ppppppiStack_3a0;
  ppppppiStack_25c = ppppppiStack_2c8;
  pppppiStack_254 = pppppiStack_408;
  if (pppppiVar57[0x5e] == (int ****)0x0) {
LAB_00496ed4:
    ppppppiStack_2c8 = (int ******)0x0;
    pppppiStack_408 = (int *****)&DAT_00000018;
    puVar56 = puStack_288;
LAB_00496ee4:
    if (*(int *)((int)pppppiVar57[0x5f] + (int)ppppppiStack_2c8) == 0) {
LAB_00496f18:
      ppppppiStack_2c8 = ppppppiStack_2c8 + 1;
      if (ppppppiStack_2c8 == (int ******)&DAT_00000018) goto LAB_00496f24;
      pppppiVar57 = ppppppiStack_2c4[0x16];
      goto LAB_00496ee4;
    }
    uVar27 = (**(code **)(puVar56 + -0x78e0))();
    ppppppiVar25 = (int ******)(**(code **)(puStack_288 + -0x7a14))(uVar27);
    puVar56 = puStack_288;
    if (ppppppiVar25 != ppppppiStack_404) goto LAB_00496f18;
    ppppppiStack_2c8 = (int ******)((int)ppppppiStack_2c4[0x16][0x5f] + (int)ppppppiStack_2c8);
    ppppppiStack_2c4 = (int ******)*ppppppiStack_2c8;
    if (ppppppiStack_2c4 != (int ******)0x0) {
      ppppppiStack_2c8 = apppppiStack_27c;
      (**(code **)(puStack_288 + -0x7fc4))(ppppppiStack_2c8);
      ppppppiStack_3a0 = ppppppiStack_2c4;
      iVar26 = (**(code **)(puStack_288 + -0x6cdc))(ppppppiStack_2c8);
      if (iVar26 < 1) {
LAB_00496ff4:
        ppppppiStack_280 = (int ******)0x0;
      }
      else {
        ppppppiStack_490 = (int ******)&ppppppiStack_280;
        ppppppiStack_3a0 = (int ******)pcStack_3fc;
        iVar26 = (**(code **)(puStack_288 + -0x785c))(ppppppiStack_2c8);
        if (iVar26 < 1) goto LAB_00496ff4;
      }
      (**(code **)(puStack_288 + -0x7fac))(ppppppiStack_2c8);
      ppppppiVar25 = ppppppiStack_280;
      goto LAB_00496f50;
    }
LAB_00496f24:
    ppppppiStack_490 = (int ******)0x144;
    ppppppiVar48 = (int ******)&DAT_0064760c;
    uStack_290 = 0x399;
    ppppppiStack_3a0 = (int ******)0x11e;
    (**(code **)(puVar56 + -0x6eac))(0x14);
    ppppppiVar25 = (int ******)0x0;
  }
  else {
    ppppppiVar25 = (int ******)ssl3_digest_cached_records();
    if (ppppppiVar25 != (int ******)0x0) {
      pppppiVar57 = ppppppiStack_2c4[0x16];
      goto LAB_00496ed4;
    }
  }
LAB_00496f50:
  if (ppppppiStack_264 == (int ******)*piStack_400) {
    return ppppppiVar25;
  }
  pcStack_2a4 = tls1_final_finish_mac;
  ppppppiVar60 = ppppppiStack_264;
  (**(code **)(puStack_288 + -0x5330))();
  ppiStack_394 = (int **)PTR___stack_chk_guard_006a9ae8;
  piStack_498 = *(int **)PTR___stack_chk_guard_006a9ae8;
  puStack_2b8 = (undefined *)piStack_400;
  puStack_3b0 = &_gp;
  ppppppiVar25 = ppppppiVar48;
  piStack_2cc = piStack_498;
  pppppiStack_2c0 = pppppiStack_408;
  ppppppiStack_2bc = ppppppiStack_404;
  ppppppiStack_2b4 = (int ******)pcStack_3fc;
  pppppiStack_2ac = param_1;
  ppppppiStack_2a8 = ppppppiStack_3f0;
  ppppppiStack_298 = ppppppiStack_490;
  ppppppiStack_3f8 = ppppppiVar48;
  if ((ppppppiVar60[0x16][0x5e] == (int ****)0x0) ||
     (iVar26 = ssl3_digest_cached_records(), ppppppiStack_40c = ppppppiVar60, iVar26 != 0)) {
    puStack_390 = auStack_370;
    puVar56 = auStack_34c;
    puStack_3a4 = puVar56;
    (**(code **)(puStack_3b0 + -0x7fc4))(puStack_390);
    iVar26 = 0;
    iStack_398 = 0;
    iStack_3a8 = 0;
    while (iVar37 = ssl_get_handshake_digest(iVar26,&uStack_380,&uStack_37c), iVar37 != 0) {
      uVar24 = ssl_get_algorithm2(ppppppiVar60);
      if ((uVar24 & uStack_380) == 0) {
        iVar26 = iVar26 + 1;
      }
      else {
        ppppppiVar30 = (int ******)(**(code **)(puStack_3b0 + -0x6fa4))(uStack_37c);
        if (((ppppppiVar60[0x16][0x5f][iVar26] == (int ***)0x0) || ((int)ppppppiVar30 < 0)) ||
           (0x80 - iStack_3a8 < (int)ppppppiVar30)) {
          iVar26 = iVar26 + 1;
          iStack_398 = 1;
        }
        else {
          iVar37 = (**(code **)(puStack_3b0 + -0x6cdc))(puStack_390);
          if (((iVar37 == 0) ||
              (iVar37 = (**(code **)(puStack_3b0 + -0x785c))(puStack_390,puVar56,&ppppppiStack_384),
              iVar37 == 0)) || (ppppppiVar25 = ppppppiStack_384, ppppppiStack_384 != ppppppiVar30))
          {
            iStack_398 = 1;
            ppppppiVar25 = ppppppiVar30;
          }
          puVar56 = puVar56 + (int)ppppppiVar25;
          iVar26 = iVar26 + 1;
          iStack_3a8 = (int)puVar56 - (int)puStack_3a4;
        }
      }
    }
    ppppppiStack_404 = &pppppiStack_374;
    ppppppiStack_40c = (int ******)ssl_get_algorithm2(ppppppiVar60);
    piStack_400 = &iStack_378;
    param_1 = (int *****)0x0;
    pppppiStack_408 = ppppppiVar60[0x30] + 5;
    ppppppiVar60 = (int ******)ppppppiVar60[0x30][4];
    iVar26 = 0;
    while (ppppppiStack_410 =
                (int ******)ssl_get_handshake_digest(param_1,piStack_400,ppppppiStack_404),
          ppppppiStack_3f0 = ppppppiStack_298, ppppppiStack_410 != (int ******)0x0) {
      param_1 = (int *****)((int)param_1 + 1);
      if ((iStack_378 << 10 & (uint)ppppppiStack_40c) != 0) {
        iVar26 = iVar26 + 1;
      }
    }
    if (iVar26 == 0) {
      ppppppiStack_490 = (int ******)0x44;
      ppppppiVar30 = (int ******)&DAT_0064760c;
      ppppppiStack_3d8 = (int ******)0x10a;
      (**(code **)(puStack_3b0 + -0x6eac))(0x14,0x11c);
      ppppppiStack_3f0 = ppppppiVar60;
LAB_0049748c:
      pcStack_3fc = (char *)&bStack_358;
      (**(code **)(puStack_3b0 + -0x7fac))(puStack_390);
      (**(code **)(puStack_3b0 + -0x7d6c))(puStack_3a4,iStack_3a8);
      piStack_498 = (int *)&SUB_0000000c;
      (**(code **)(puStack_3b0 + -0x7d6c))(pcStack_3fc);
    }
    else {
      if (iVar26 == 0) {
        trap(7);
      }
      iStack_39c = (int)ppppppiVar60 / iVar26;
      *(undefined *)ppppppiVar48 = 0;
      if (iVar26 == 1) {
        ppppppiVar60 = (int ******)0x0;
      }
      param_1 = (int *****)0x0;
      *(undefined *)((int)ppppppiVar48 + 1) = 0;
      *(undefined *)((int)ppppppiVar48 + 2) = 0;
      *(undefined *)((int)ppppppiVar48 + 3) = 0;
      *(undefined *)(ppppppiVar48 + 1) = 0;
      pcStack_3fc = (char *)&bStack_358;
      *(undefined *)((int)ppppppiVar48 + 5) = 0;
      *(undefined *)((int)ppppppiVar48 + 6) = 0;
      *(undefined *)((int)ppppppiVar48 + 7) = 0;
      *(undefined *)(ppppppiVar48 + 2) = 0;
      *(undefined *)((int)ppppppiVar48 + 9) = 0;
      *(undefined *)((int)ppppppiVar48 + 10) = 0;
      *(undefined *)((int)ppppppiVar48 + 0xb) = 0;
      ppppppiStack_3f8 = (int ******)(((uint)ppppppiVar60 & 1) + iStack_39c);
      ppppppiStack_490 = ppppppiStack_404;
      ppppppiStack_38c = ppppppiStack_410;
      iVar26 = ssl_get_handshake_digest(0,piStack_400);
      ppppppiVar30 = ppppppiStack_3a0;
      ppppppiStack_410 = ppppppiStack_38c;
      while (ppppppiStack_3a0 = ppppppiVar30, ppppppiStack_38c = ppppppiStack_410, iVar26 != 0) {
        if ((iStack_378 << 10 & (uint)ppppppiStack_40c) != 0) {
          if (pppppiStack_374 == (int *****)0x0) {
            ppppppiStack_490 = (int ******)0x146;
            ppppppiVar30 = (int ******)&DAT_0064760c;
            ppppppiStack_3d8 = (int ******)0x115;
            (**(code **)(puStack_3b0 + -0x6eac))(0x14,0x11c);
            goto LAB_0049748c;
          }
          uStack_3c0 = 0;
          uStack_3b8 = 0xc;
          uStack_3c4 = 0;
          uStack_3c8 = 0;
          uStack_3cc = 0;
          ppppppiStack_3d8 = ppppppiStack_3f0;
          ppppppiStack_490 = ppppppiStack_3f8;
          puStack_3d4 = puStack_3a4;
          iStack_3d0 = iStack_3a8;
          ppppppiStack_3bc = (int ******)pcStack_3fc;
          iVar26 = tls1_P_hash_constprop_2(pppppiStack_374,pppppiStack_408);
          ppppppiStack_410 = ppppppiStack_38c;
          if (iVar26 == 0) goto LAB_0049748c;
          pppppiStack_408 = (int *****)((int)pppppiStack_408 + iStack_39c);
          bVar1 = *(byte *)((int)ppppppiVar48 + 3) ^ bStack_355;
          in_t3 = (uint)bVar1;
          bVar21 = *(byte *)((int)ppppppiVar48 + 6) ^ bStack_352;
          ppppppiVar25 = (int ******)(uint)bVar21;
          in_t2 = (uint)(*(byte *)(ppppppiVar48 + 1) ^ bStack_354);
          bVar22 = *(byte *)((int)ppppppiVar48 + 5) ^ bStack_353;
          in_t1 = (uint)bVar22;
          *(byte *)ppppppiVar48 = *(byte *)ppppppiVar48 ^ bStack_358;
          *(byte *)((int)ppppppiVar48 + 1) = *(byte *)((int)ppppppiVar48 + 1) ^ bStack_357;
          *(byte *)((int)ppppppiVar48 + 2) = *(byte *)((int)ppppppiVar48 + 2) ^ bStack_356;
          *(byte *)((int)ppppppiVar48 + 3) = bVar1;
          *(byte *)(ppppppiVar48 + 1) = *(byte *)(ppppppiVar48 + 1) ^ bStack_354;
          *(byte *)((int)ppppppiVar48 + 5) = bVar22;
          *(byte *)((int)ppppppiVar48 + 6) = bVar21;
          *(byte *)((int)ppppppiVar48 + 7) = *(byte *)((int)ppppppiVar48 + 7) ^ bStack_351;
          *(byte *)(ppppppiVar48 + 2) = *(byte *)(ppppppiVar48 + 2) ^ bStack_350;
          *(byte *)((int)ppppppiVar48 + 9) = *(byte *)((int)ppppppiVar48 + 9) ^ bStack_34f;
          *(byte *)((int)ppppppiVar48 + 10) = *(byte *)((int)ppppppiVar48 + 10) ^ bStack_34e;
          *(byte *)((int)ppppppiVar48 + 0xb) = *(byte *)((int)ppppppiVar48 + 0xb) ^ bStack_34d;
        }
        param_1 = (int *****)((int)param_1 + 1);
        ppppppiStack_490 = ppppppiStack_404;
        iVar26 = ssl_get_handshake_digest(param_1,piStack_400);
        ppppppiVar30 = ppppppiStack_3a0;
        ppppppiStack_410 = ppppppiStack_38c;
      }
      (**(code **)(puStack_3b0 + -0x7fac))(puStack_390);
      (**(code **)(puStack_3b0 + -0x7d6c))(puStack_3a4,iStack_3a8);
      piStack_498 = (int *)&SUB_0000000c;
      (**(code **)(puStack_3b0 + -0x7d6c))(pcStack_3fc);
      if (iStack_398 != 0) goto LAB_00497418;
      ppppppiStack_410 = (int ******)&SUB_0000000c;
      ppppppiVar30 = ppppppiVar25;
    }
  }
  else {
LAB_00497418:
    ppppppiStack_410 = (int ******)0x0;
    ppppppiVar30 = ppppppiVar25;
  }
  if (piStack_2cc == *ppiStack_394) {
    return ppppppiStack_410;
  }
  pcStack_3ec = tls1_mac;
  piStack_4ac = piStack_2cc;
  (**(code **)(puStack_3b0 + -0x5330))();
  puStack_49c = PTR___stack_chk_guard_006a9ae8;
  puStack_460 = &_gp;
  iStack_414 = *(int *)PTR___stack_chk_guard_006a9ae8;
  iVar26 = piStack_4ac[0x16];
  ppiStack_4a8 = (int **)(iVar26 + 0x10c);
  if (ppppppiStack_490 == (int ******)0x0) {
    puVar56 = (undefined *)piStack_4ac[0x21];
    puStack_4b0 = (undefined4 *)(iVar26 + 8);
    uStack_4a4 = piStack_4ac[0x1f] & 1;
  }
  else {
    puVar56 = (undefined *)piStack_4ac[0x24];
    ppiStack_4a8 = (int **)(iVar26 + 0x130);
    puStack_4b0 = (undefined4 *)(iVar26 + 0x54);
    uStack_4a4 = piStack_4ac[0x1f] & 2;
  }
  pcVar44 = (char *)ppppppiStack_490;
  pppppiStack_3f4 = param_1;
  uVar27 = (*(code *)PTR_EVP_MD_CTX_md_006a7500)(puVar56);
  ppppppiStack_448 = (int ******)(**(code **)(puStack_460 + -0x6fa4))(uVar27);
  if ((int)ppppppiStack_448 < 0) {
    pcVar44 = "t >= 0";
    ppppppiStack_454 = ppppppiStack_448;
    (**(code **)(puStack_460 + -0x7184))(&DAT_0064760c,0x3f4);
    ppppppiStack_448 = ppppppiStack_454;
  }
  puStack_4a0 = puVar56;
  if (uStack_4a4 == 0) {
    puStack_4a0 = auStack_444;
    iVar26 = (**(code **)(puStack_460 + -0x6be0))(puStack_4a0,puVar56);
    if (iVar26 == 0) {
      ppppppiVar25 = (int ******)0xffffffff;
      goto LAB_0049788c;
    }
  }
  iVar26 = *piStack_4ac;
  if ((iVar26 == 0xfeff) || (iVar26 == 0x100)) {
    if (ppppppiStack_490 == (int ******)0x0) {
      uVar2 = *(undefined2 *)(piStack_4ac[0x17] + 0x208);
      uVar42 = (undefined)((ushort)uVar2 >> 8);
    }
    else {
      uVar2 = *(undefined2 *)(piStack_4ac[0x17] + 0x20a);
      uVar42 = (undefined)((ushort)uVar2 >> 8);
    }
    auStack_42c = (undefined  [4])CONCAT13(uVar42,CONCAT12((char)uVar2,SUB42(auStack_42c,0)));
    bVar1 = *(byte *)((int)puStack_4b0 + 6);
    in_t0 = (int ******)(uint)bVar1;
    uVar38 = *(uint *)((int)puStack_4b0 + 2);
    cVar36 = *(char *)((int)puStack_4b0 + 7);
    puVar56 = auStack_42c + 2;
    uVar24 = (uint)puVar56 & 3;
    *(uint *)(puVar56 + -uVar24) =
         *(uint *)(puVar56 + -uVar24) & -1 << (4 - uVar24) * 8 | uVar38 >> uVar24 * 8;
    puVar56 = auStack_428 + 1;
    uVar24 = (uint)puVar56 & 3;
    *(uint *)(puVar56 + -uVar24) =
         *(uint *)(puVar56 + -uVar24) & 0xffffffffU >> (uVar24 + 1) * 8 | uVar38 << (3 - uVar24) * 8
    ;
    auStack_428 = (undefined  [4])CONCAT31(CONCAT21(auStack_428._0_2_,bVar1),cVar36);
    uStack_420 = auStack_428;
    pppppiStack_424 = (int *****)auStack_42c;
  }
  else {
    pppppiStack_424 = (int *****)*puStack_4b0;
    uStack_420 = puStack_4b0[1];
  }
  ppppppiStack_454 = (int ******)ppiStack_4a8[1];
  param_1 = (int *****)*ppiStack_4a8;
  ppppppiStack_450 = ppppppiStack_448;
  ppppppiVar30 = (int ******)((uint)param_1 & 0xff);
  *ppiStack_4a8 = (int *)ppppppiVar30;
  uStack_41c = SUB41(param_1,0);
  uStack_41b = (undefined)((uint)iVar26 >> 8);
  uStack_41a = (undefined)iVar26;
  uStack_419 = (undefined)((uint)ppppppiStack_454 >> 8);
  uStack_418 = SUB41(ppppppiStack_454,0);
  if (((ppppppiStack_490 == (int ******)0x0) &&
      (ppppppiStack_44c = &pppppiStack_424,
      uVar24 = (**(code **)(puStack_460 + -0x6cd8))(piStack_4ac[0x20]), (uVar24 & 0xf0007) == 2)) &&
     (iVar26 = ssl3_cbc_record_digest_supported(puStack_4a0,ppppppiStack_44c), iVar26 != 0)) {
    in_t0 = (int ******)((uint)param_1 >> 8);
    uStack_464 = 0;
    iStack_46c = piStack_4ac[0x16] + 0x14;
    uStack_468 = *(undefined4 *)(piStack_4ac[0x16] + 0x10);
    param_1 = (int *****)((int)ppppppiStack_454 + (int)ppppppiStack_450 + (int)in_t0);
    pcVar44 = (char *)&ppppppiStack_448;
    iStack_474 = (int)ppiStack_4a8[1] + (int)ppppppiStack_448;
    piStack_478 = ppiStack_4a8[4];
    ppppppiVar30 = ppppppiStack_44c;
    pppppiStack_470 = param_1;
    iVar26 = ssl3_cbc_digest_record(puStack_4a0,piStack_498);
joined_r0x004976bc:
    if (0 < iVar26) {
      if (uStack_4a4 == 0) {
        (**(code **)(puStack_460 + -0x7fac))(auStack_444);
      }
      ppppppiVar25 = ppppppiStack_448;
      if (((*piStack_4ac != 0xfeff) && (*piStack_4ac != 0x100)) &&
         ((((cVar36 = *(char *)((int)puStack_4b0 + 7) + '\x01',
            *(char *)((int)puStack_4b0 + 7) = cVar36, cVar36 == '\0' &&
            ((cVar36 = *(char *)((int)puStack_4b0 + 6) + '\x01',
             *(char *)((int)puStack_4b0 + 6) = cVar36, cVar36 == '\0' &&
             (cVar36 = *(char *)((int)puStack_4b0 + 5) + '\x01',
             *(char *)((int)puStack_4b0 + 5) = cVar36, cVar36 == '\0')))) &&
           (cVar36 = *(char *)(puStack_4b0 + 1), *(char *)(puStack_4b0 + 1) = cVar36 + '\x01',
           (char)(cVar36 + '\x01') == '\0')) &&
          (((cVar36 = *(char *)((int)puStack_4b0 + 3) + '\x01',
            *(char *)((int)puStack_4b0 + 3) = cVar36, cVar36 == '\0' &&
            (cVar36 = *(char *)((int)puStack_4b0 + 2) + '\x01',
            *(char *)((int)puStack_4b0 + 2) = cVar36, cVar36 == '\0')) &&
           (cVar36 = *(char *)((int)puStack_4b0 + 1) + '\x01',
           *(char *)((int)puStack_4b0 + 1) = cVar36, cVar36 == '\0')))))) {
        *(char *)puStack_4b0 = *(char *)puStack_4b0 + '\x01';
      }
      goto LAB_0049788c;
    }
  }
  else {
    pcVar44 = &DAT_0000000d;
    iVar26 = (**(code **)(puStack_460 + -0x7860))(puStack_4a0);
    if (0 < iVar26) {
      pcVar44 = (char *)ppiStack_4a8[1];
      iVar26 = (**(code **)(puStack_460 + -0x7860))(puStack_4a0,ppiStack_4a8[4]);
      if (0 < iVar26) {
        pcVar44 = (char *)&ppppppiStack_448;
        iVar26 = (**(code **)(puStack_460 + -0x7910))(puStack_4a0,piStack_498);
        goto joined_r0x004976bc;
      }
    }
  }
  if (uStack_4a4 == 0) {
    (**(code **)(puStack_460 + -0x7fac))(auStack_444);
  }
  ppppppiVar25 = (int ******)0xffffffff;
LAB_0049788c:
  if (iStack_414 == *(int *)puStack_49c) {
    return ppppppiVar25;
  }
  pcStack_48c = tls1_generate_master_secret;
  iVar26 = iStack_414;
  (**(code **)(puStack_460 + -0x5330))();
  puVar56 = PTR___stack_chk_guard_006a9ae8;
  uStack_4b4 = *(uint *)PTR___stack_chk_guard_006a9ae8;
  ppppppiVar25 = ppppppiVar30;
  pppppiStack_494 = param_1;
  uVar24 = ssl_get_algorithm2();
  iVar61 = *(int *)(iVar26 + 0xc0);
  iVar55 = 0;
  iVar37 = *(int *)(iVar26 + 0x58) + 0xc0;
  puVar31 = (uint *)(iVar61 + 0x14);
  iVar26 = 0;
  while (iVar32 = ssl_get_handshake_digest(iVar55,&iStack_4ec,&iStack_4e8), iVar32 != 0) {
    iVar55 = iVar55 + 1;
    if ((iStack_4ec << 10 & uVar24) != 0) {
      iVar26 = iVar26 + 1;
    }
  }
  if (iVar26 == 0) {
    piVar45 = (int *)0x44;
    ppppppiVar25 = (int ******)&DAT_0064760c;
    uStack_540 = 0x10a;
    (*(code *)PTR_ERR_put_error_006a7f34)(0x14,0x11c);
  }
  else {
    if (iVar26 == 0) {
      trap(7);
    }
    iVar55 = (int)ppppppiVar30 / iVar26;
    if (iVar26 == 1) {
      ppppppiVar30 = (int ******)0x0;
    }
    (*(code *)PTR_memset_006a99f4)(puVar31,0,0x30);
    iVar26 = 0;
    pcStack_500 = "master secret";
    piVar45 = &iStack_4e8;
    iVar32 = ssl_get_handshake_digest(0,&iStack_4ec);
    while (iVar32 != 0) {
      if ((iStack_4ec << 10 & uVar24) != 0) {
        if (iStack_4e8 == 0) {
          piVar45 = (int *)0x146;
          ppppppiVar25 = (int ******)&DAT_0064760c;
          uStack_540 = 0x115;
          (*(code *)PTR_ERR_put_error_006a7f34)(0x14,0x11c);
          break;
        }
        uStack_538 = 0x20;
        iStack_534 = 0;
        uStack_540 = 0xd;
        piVar45 = (int *)(((uint)ppppppiVar30 & 1) + iVar55);
        ppppppiVar25 = (int ******)pcStack_500;
        iVar32 = tls1_P_hash_constprop_2(iStack_4e8,pcVar44);
        iStack_53c = iVar37;
        if (iVar32 == 0) break;
        pcVar44 = (char *)((int)pcVar44 + iVar55);
        puVar35 = &uStack_4e4;
        puVar39 = puVar31;
        if (((uint)puVar31 & 3) == 0 &&
            ((uint *)(iVar61 + 0x18) <= &uStack_4e4 || &uStack_4e0 <= puVar31)) {
          *(uint *)(iVar61 + 0x14) = *(uint *)(iVar61 + 0x14) ^ uStack_4e4;
          *(uint *)(iVar61 + 0x18) = uStack_4e0 ^ *(uint *)(iVar61 + 0x18);
          ppppppiVar25 = (int ******)(uStack_4cc ^ *(uint *)(iVar61 + 0x2c));
          in_t3 = uStack_4d0 ^ *(uint *)(iVar61 + 0x28);
          *(uint *)(iVar61 + 0x1c) = uStack_4dc ^ *(uint *)(iVar61 + 0x1c);
          *(uint *)(iVar61 + 0x20) = uStack_4d8 ^ *(uint *)(iVar61 + 0x20);
          *(uint *)(iVar61 + 0x24) = uStack_4d4 ^ *(uint *)(iVar61 + 0x24);
          *(uint *)(iVar61 + 0x28) = in_t3;
          *(int *******)(iVar61 + 0x2c) = ppppppiVar25;
          *(uint *)(iVar61 + 0x30) = uStack_4c8 ^ *(uint *)(iVar61 + 0x30);
          *(uint *)(iVar61 + 0x38) = uStack_4c0 ^ *(uint *)(iVar61 + 0x38);
          *(uint *)(iVar61 + 0x34) = uStack_4c4 ^ *(uint *)(iVar61 + 0x34);
          *(uint *)(iVar61 + 0x3c) = uStack_4bc ^ *(uint *)(iVar61 + 0x3c);
          *(uint *)(iVar61 + 0x40) = *(uint *)(iVar61 + 0x40) ^ uStack_4b8;
        }
        else {
          do {
            puVar33 = (uint *)((int)puVar35 + 1);
            *(byte *)puVar39 = *(byte *)puVar39 ^ *(byte *)puVar35;
            puVar35 = puVar33;
            puVar39 = (uint *)((int)puVar39 + 1);
          } while (puVar33 != &uStack_4b4);
        }
      }
      iVar26 = iVar26 + 1;
      piVar45 = &iStack_4e8;
      iVar32 = ssl_get_handshake_digest(iVar26,&iStack_4ec);
    }
  }
  uVar27 = 0x30;
  (*(code *)PTR_OPENSSL_cleanse_006a7074)(&uStack_4e4);
  if (uStack_4b4 == *(uint *)puVar56) {
    return (int ******)&DAT_00000030;
  }
  uVar24 = uStack_4b4;
  (*(code *)PTR___stack_chk_fail_006a9ab0)();
  ppppppiVar48 = ppppppiVar25;
  iVar26 = (*(code *)PTR_CRYPTO_malloc_006a7008)(piVar45,&DAT_0064760c,0x4a2);
  if (iVar26 == 0) {
    ppppppiVar25 = (int ******)0x0;
    (*(code *)PTR_ERR_put_error_006a7f34)(0x14,0x13a,0x41,&DAT_0064760c,0x4ec);
  }
  else {
    iVar37 = uStack_540 + 0x40;
    if (iStack_534 == 0) {
      iVar61 = (*(code *)PTR_CRYPTO_malloc_006a7008)(iVar37,&DAT_0064760c,0x4b0);
      iVar55 = iVar37;
    }
    else {
      iVar55 = uStack_538 + 2 + iVar37;
      iVar61 = (*(code *)PTR_CRYPTO_malloc_006a7008)(iVar55,&DAT_0064760c,0x4b0);
    }
    if (iVar61 == 0) {
      (*(code *)PTR_ERR_put_error_006a7f34)(0x14,0x13a,0x41,&DAT_0064760c,0x4ec);
      (*(code *)PTR_CRYPTO_free_006a6e88)(iVar26);
      return (int ******)0x0;
    }
    uVar46 = uStack_540;
    (*(code *)PTR_memcpy_006a9aec)(iVar61);
    puVar35 = (uint *)(iVar61 + uStack_540);
    iVar40 = *(int *)(uVar24 + 0x58);
    puVar31 = (uint *)(iVar61 + uStack_540 + 0x20);
    uVar54 = *(uint *)(iVar40 + 0xc0);
    uVar38 = iVar40 + 0xc4U & 3;
    uVar3 = iVar40 + 200U & 3;
    uVar4 = iVar40 + 0xccU & 3;
    uVar5 = iVar40 + 0xd0U & 3;
    uVar6 = iVar40 + 0xd4U & 3;
    uVar7 = iVar40 + 0xd8U & 3;
    iVar32 = *(int *)((iVar40 + 0xd8U) - uVar7);
    uVar8 = iVar40 + 0xdcU & 3;
    iVar9 = *(int *)((iVar40 + 0xdcU) - uVar8);
    uVar12 = iVar40 + 199U & 3;
    uVar53 = (*(int *)((iVar40 + 0xc4U) - uVar38) << uVar38 * 8 |
             in_t3 & 0xffffffffU >> (4 - uVar38) * 8) & -1 << (uVar12 + 1) * 8 |
             *(uint *)((iVar40 + 199U) - uVar12) >> (3 - uVar12) * 8;
    uVar38 = iVar40 + 0xcbU & 3;
    uVar52 = (*(int *)((iVar40 + 200U) - uVar3) << uVar3 * 8 |
             in_t2 & 0xffffffffU >> (4 - uVar3) * 8) & -1 << (uVar38 + 1) * 8 |
             *(uint *)((iVar40 + 0xcbU) - uVar38) >> (3 - uVar38) * 8;
    uVar38 = iVar40 + 0xcfU & 3;
    uVar51 = (*(int *)((iVar40 + 0xccU) - uVar4) << uVar4 * 8 |
             in_t1 & 0xffffffffU >> (4 - uVar4) * 8) & -1 << (uVar38 + 1) * 8 |
             *(uint *)((iVar40 + 0xcfU) - uVar38) >> (3 - uVar38) * 8;
    uVar38 = iVar40 + 0xd3U & 3;
    uVar50 = (*(int *)((iVar40 + 0xd0U) - uVar5) << uVar5 * 8 |
             (uint)in_t0 & 0xffffffffU >> (4 - uVar5) * 8) & -1 << (uVar38 + 1) * 8 |
             *(uint *)((iVar40 + 0xd3U) - uVar38) >> (3 - uVar38) * 8;
    uVar38 = iVar40 + 0xd7U & 3;
    uVar49 = (*(int *)((iVar40 + 0xd4U) - uVar6) << uVar6 * 8 |
             (uint)ppppppiVar48 & 0xffffffffU >> (4 - uVar6) * 8) & -1 << (uVar38 + 1) * 8 |
             *(uint *)((iVar40 + 0xd7U) - uVar38) >> (3 - uVar38) * 8;
    uVar38 = iVar40 + 0xdbU & 3;
    uVar4 = *(uint *)((iVar40 + 0xdbU) - uVar38);
    uVar3 = iVar40 + 0xdfU & 3;
    uVar5 = *(uint *)((iVar40 + 0xdfU) - uVar3);
    *puVar35 = uVar54;
    puVar35[1] = uVar53;
    puVar35[2] = uVar52;
    puVar35[3] = uVar51;
    puVar35[4] = uVar50;
    puVar35[5] = uVar49;
    puVar35[6] = (iVar32 << uVar7 * 8 | uVar46 & 0xffffffffU >> (4 - uVar7) * 8) &
                 -1 << (uVar38 + 1) * 8 | uVar4 >> (3 - uVar38) * 8;
    puVar35[7] = (iVar9 << uVar8 * 8 | (uint)ppppppiVar25 & 0xffffffffU >> (4 - uVar8) * 8) &
                 -1 << (uVar3 + 1) * 8 | uVar5 >> (3 - uVar3) * 8;
    iVar41 = *(int *)(uVar24 + 0x58);
    uVar38 = iVar41 + 0xa0U & 3;
    uVar3 = iVar41 + 0xa4U & 3;
    iVar32 = *(int *)((iVar41 + 0xa4U) - uVar3);
    uVar4 = iVar41 + 0xa8U & 3;
    iVar9 = *(int *)((iVar41 + 0xa8U) - uVar4);
    uVar5 = iVar41 + 0xacU & 3;
    iVar40 = *(int *)((iVar41 + 0xacU) - uVar5);
    uVar6 = iVar41 + 0xb0U & 3;
    iVar10 = *(int *)((iVar41 + 0xb0U) - uVar6);
    uVar7 = iVar41 + 0xb4U & 3;
    iVar11 = *(int *)((iVar41 + 0xb4U) - uVar7);
    uVar8 = iVar41 + 0xa3U & 3;
    uVar12 = iVar41 + 0xa7U & 3;
    uVar16 = *(uint *)((iVar41 + 0xa7U) - uVar12);
    uVar46 = iVar41 + 0xabU & 3;
    uVar17 = *(uint *)((iVar41 + 0xabU) - uVar46);
    uVar13 = iVar41 + 0xafU & 3;
    uVar18 = *(uint *)((iVar41 + 0xafU) - uVar13);
    uVar14 = iVar41 + 0xb3U & 3;
    uVar19 = *(uint *)((iVar41 + 0xb3U) - uVar14);
    uVar15 = iVar41 + 0xb7U & 3;
    uVar20 = *(uint *)((iVar41 + 0xb7U) - uVar15);
    uVar47 = *(uint *)(iVar41 + 0xb8);
    uVar43 = *(uint *)(iVar41 + 0xbc);
    *puVar31 = (*(int *)((iVar41 + 0xa0U) - uVar38) << uVar38 * 8 |
               uVar54 & 0xffffffffU >> (4 - uVar38) * 8) & -1 << (uVar8 + 1) * 8 |
               *(uint *)((iVar41 + 0xa3U) - uVar8) >> (3 - uVar8) * 8;
    puVar31[1] = (iVar32 << uVar3 * 8 | uVar53 & 0xffffffffU >> (4 - uVar3) * 8) &
                 -1 << (uVar12 + 1) * 8 | uVar16 >> (3 - uVar12) * 8;
    puVar31[2] = (iVar9 << uVar4 * 8 | uVar52 & 0xffffffffU >> (4 - uVar4) * 8) &
                 -1 << (uVar46 + 1) * 8 | uVar17 >> (3 - uVar46) * 8;
    puVar31[3] = (iVar40 << uVar5 * 8 | uVar51 & 0xffffffffU >> (4 - uVar5) * 8) &
                 -1 << (uVar13 + 1) * 8 | uVar18 >> (3 - uVar13) * 8;
    puVar31[4] = (iVar10 << uVar6 * 8 | uVar50 & 0xffffffffU >> (4 - uVar6) * 8) &
                 -1 << (uVar14 + 1) * 8 | uVar19 >> (3 - uVar14) * 8;
    puVar31[5] = (iVar11 << uVar7 * 8 | uVar49 & 0xffffffffU >> (4 - uVar7) * 8) &
                 -1 << (uVar15 + 1) * 8 | uVar20 >> (3 - uVar15) * 8;
    puVar31[6] = uVar47;
    puVar31[7] = uVar43;
    if (iStack_534 != 0) {
      *(char *)(iVar61 + iVar37) = (char)((uint)uStack_538 >> 8);
      *(undefined *)((int)puVar35 + 0x41) = (undefined)uStack_538;
      if ((uStack_538 != 0) || (iStack_53c != 0)) {
        (*(code *)PTR_memcpy_006a9aec)(iVar61 + uStack_540 + 0x42,iStack_53c,uStack_538);
      }
    }
    iVar37 = (*(code *)PTR_memcmp_006a9ad0)(iVar61,"client finished",0xf);
    if (((iVar37 == 0) ||
        (iVar37 = (*(code *)PTR_memcmp_006a9ad0)(iVar61,"server finished",0xf), iVar37 == 0)) ||
       ((iVar37 = (*(code *)PTR_memcmp_006a9ad0)(iVar61,"master secret",0xd), iVar37 == 0 ||
        (iVar37 = (*(code *)PTR_memcmp_006a9ad0)(iVar61,"key expansion",0xd), iVar37 == 0)))) {
      ppppppiVar25 = (int ******)0x0;
      (*(code *)PTR_ERR_put_error_006a7f34)(0x14,0x13a,0x16f,&DAT_0064760c,0x4e8);
    }
    else {
      uVar34 = ssl_get_algorithm2(uVar24);
      ppppppiVar25 = (int ******)
                     tls1_PRF_constprop_1
                               (uVar34,iVar61,iVar55,0,0,0,0,0,0,*(int *)(uVar24 + 0xc0) + 0x14,
                                *(undefined4 *)(*(int *)(uVar24 + 0xc0) + 0x10),uVar27,iVar26,
                                piVar45);
      (*(code *)PTR_OPENSSL_cleanse_006a7074)(iVar61,iVar55);
      (*(code *)PTR_OPENSSL_cleanse_006a7074)(iVar26,piVar45);
    }
    (*(code *)PTR_CRYPTO_free_006a6e88)(iVar26);
    (*(code *)PTR_CRYPTO_free_006a6e88)(iVar61);
  }
  return ppppppiVar25;
}

