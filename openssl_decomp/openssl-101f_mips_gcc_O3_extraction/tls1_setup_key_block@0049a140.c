
/* WARNING: Could not reconcile some variable overlaps */

int tls1_setup_key_block(int param_1,int *param_2,char *param_3,int *param_4)

{
  byte bVar1;
  undefined2 uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  byte bVar21;
  int iVar22;
  undefined4 uVar23;
  int *piVar24;
  int iVar25;
  uint uVar26;
  int iVar27;
  uint *puVar28;
  int iVar29;
  uint *puVar30;
  byte *pbVar31;
  char cVar33;
  uint *puVar32;
  undefined uVar38;
  uint uVar34;
  uint *puVar35;
  int iVar36;
  int iVar37;
  uint uVar39;
  uint uVar40;
  uint uVar41;
  undefined4 *puVar42;
  undefined4 *puVar43;
  uint uVar44;
  uint in_t0;
  uint uVar45;
  uint in_t1;
  uint uVar46;
  uint in_t2;
  uint uVar47;
  uint in_t3;
  uint uVar48;
  uint uVar49;
  int unaff_s0;
  char *pcVar50;
  int *unaff_s2;
  int unaff_s3;
  undefined *puVar51;
  int unaff_s4;
  int *unaff_s5;
  int *piVar52;
  int unaff_s6;
  int unaff_s7;
  code *pcVar53;
  int *unaff_s8;
  int iVar54;
  uint uStack_3e8;
  int iStack_3e4;
  undefined4 uStack_3e0;
  int iStack_3dc;
  char *pcStack_3a8;
  int iStack_394;
  int iStack_390;
  uint uStack_38c;
  uint uStack_388;
  uint uStack_384;
  uint uStack_380;
  uint uStack_37c;
  uint uStack_378;
  uint uStack_374;
  uint uStack_370;
  uint uStack_36c;
  uint uStack_368;
  uint uStack_364;
  uint uStack_360;
  uint uStack_35c;
  undefined4 *puStack_358;
  int *piStack_354;
  uint *puStack_350;
  undefined *puStack_34c;
  uint uStack_348;
  undefined *puStack_344;
  int *piStack_340;
  uint uStack_33c;
  int *piStack_338;
  code *pcStack_334;
  uint uStack_320;
  int iStack_31c;
  int iStack_318;
  int iStack_314;
  undefined4 uStack_310;
  undefined4 uStack_30c;
  undefined *puStack_308;
  uint uStack_2fc;
  int iStack_2f8;
  undefined4 *puStack_2f4;
  int iStack_2f0;
  undefined auStack_2ec [24];
  undefined auStack_2d4 [4];
  undefined auStack_2d0 [4];
  undefined4 uStack_2cc;
  undefined4 uStack_2c8;
  undefined uStack_2c4;
  undefined uStack_2c3;
  undefined uStack_2c2;
  undefined uStack_2c1;
  undefined uStack_2c0;
  int iStack_2bc;
  int *piStack_2b8;
  int iStack_2b4;
  int *piStack_2b0;
  int *piStack_2ac;
  int *piStack_2a8;
  int *piStack_2a4;
  int *piStack_2a0;
  int iStack_29c;
  int *piStack_298;
  code *pcStack_294;
  int *piStack_280;
  int *piStack_27c;
  int iStack_278;
  undefined4 uStack_274;
  undefined4 uStack_270;
  undefined4 uStack_26c;
  undefined4 uStack_268;
  int *piStack_264;
  undefined4 uStack_260;
  undefined *puStack_258;
  int iStack_250;
  int *piStack_24c;
  int *piStack_248;
  int iStack_244;
  int **ppiStack_240;
  undefined *puStack_23c;
  int *piStack_238;
  int iStack_234;
  int iStack_22c;
  uint uStack_228;
  undefined4 uStack_224;
  int iStack_220;
  int iStack_21c;
  undefined auStack_218 [24];
  byte bStack_200;
  byte bStack_1ff;
  byte bStack_1fe;
  byte bStack_1fd;
  byte bStack_1fc;
  byte bStack_1fb;
  byte bStack_1fa;
  byte bStack_1f9;
  byte bStack_1f8;
  byte bStack_1f7;
  byte bStack_1f6;
  byte bStack_1f5;
  int aiStack_1f4 [32];
  int *piStack_174;
  int *piStack_170;
  int iStack_16c;
  int *piStack_168;
  int *piStack_164;
  undefined *puStack_160;
  int *piStack_15c;
  int iStack_158;
  int iStack_154;
  int *piStack_150;
  code *pcStack_14c;
  int *piStack_140;
  undefined4 uStack_138;
  undefined *puStack_130;
  int iStack_128;
  int aiStack_124 [6];
  int *piStack_10c;
  int *piStack_104;
  int *piStack_100;
  int *piStack_fc;
  int *piStack_f8;
  undefined *puStack_f4;
  int *piStack_f0;
  code *pcStack_ec;
  undefined4 uStack_d8;
  undefined *puStack_d0;
  undefined auStack_c8 [4];
  undefined auStack_c4 [8];
  int iStack_bc;
  int iStack_b8;
  undefined uStack_b4;
  undefined uStack_b3;
  undefined uStack_b2;
  undefined uStack_b1;
  undefined uStack_b0;
  int iStack_ac;
  int iStack_a8;
  undefined *puStack_a4;
  int *piStack_a0;
  int iStack_9c;
  int iStack_98;
  int *piStack_94;
  undefined4 local_38;
  undefined4 local_34 [2];
  undefined4 local_2c;
  int local_28;
  int *local_24;
  
  puStack_a4 = PTR___stack_chk_guard_006aabf0;
  local_2c = 0;
  local_28 = 0;
  local_24 = *(int **)PTR___stack_chk_guard_006aabf0;
  iVar22 = 1;
  iStack_a8 = unaff_s0;
  if (*(int *)(*(int *)(param_1 + 0x58) + 0x374) == 0) {
    iVar22 = ssl_cipher_get_evp(*(undefined4 *)(param_1 + 0xc0),&local_38,local_34,&local_2c);
    puVar51 = PTR_EVP_CIPHER_key_length_006a903c;
    iStack_a8 = param_1;
    if (iVar22 == 0) {
      param_3 = (char *)0x8a;
      param_4 = (int *)&DAT_00647bcc;
      param_2 = (int *)0xd3;
      (*(code *)PTR_ERR_put_error_006a9030)(0x14);
    }
    else {
      unaff_s5 = (int *)0x640000;
      iVar22 = *(int *)(param_1 + 0x58);
      *(undefined4 *)(iVar22 + 0x37c) = local_38;
      *(undefined4 *)(iVar22 + 0x380) = local_34[0];
      *(undefined4 *)(iVar22 + 900) = local_2c;
      *(int *)(iVar22 + 0x388) = local_28;
      iVar22 = (*(code *)puVar51)(local_38);
      iVar22 = iVar22 + local_28;
      iVar25 = (*(code *)PTR_EVP_CIPHER_iv_length_006a865c)(local_38);
      unaff_s2 = (int *)((iVar22 + iVar25) * 2);
      ssl3_cleanup_key_block(param_1);
      unaff_s4 = (*(code *)PTR_CRYPTO_malloc_006a8108)(unaff_s2,&DAT_00647bcc,0x267);
      puVar51 = PTR_CRYPTO_malloc_006a8108;
      if (unaff_s4 == 0) {
        param_4 = (int *)&DAT_00647bcc;
        param_3 = &DAT_00000041;
        param_2 = (int *)0xd3;
        (*(code *)PTR_ERR_put_error_006a9030)(0x14);
        iVar22 = 0;
      }
      else {
        iVar22 = *(int *)(param_1 + 0x58);
        *(int **)(iVar22 + 0x374) = unaff_s2;
        *(int *)(iVar22 + 0x378) = unaff_s4;
        unaff_s3 = (*(code *)puVar51)(unaff_s2,&DAT_00647bcc,0x270);
        if (unaff_s3 == 0) {
          param_4 = (int *)&DAT_00647bcc;
          param_3 = &DAT_00000041;
          param_2 = (int *)0xd3;
          (*(code *)PTR_ERR_put_error_006a9030)(0x14);
          iVar22 = 0;
        }
        else {
          unaff_s5 = (int *)&DAT_00000020;
          uVar23 = ssl_get_algorithm2(param_1);
          param_3 = &DAT_0000000d;
          in_t0 = *(int *)(param_1 + 0x58) + 0xc0;
          param_4 = (int *)(*(int *)(param_1 + 0x58) + 0xa0);
          iVar22 = tls1_PRF_constprop_1(uVar23,"key expansion");
          if (iVar22 == 0) {
            iVar22 = 0;
          }
          else {
            if (((*(uint *)(param_1 + 0x100) & 0x800) == 0) && (**(int **)(param_1 + 8) < 0x302)) {
              iVar25 = *(int *)(param_1 + 0x58);
              iVar22 = *(int *)(*(int *)(param_1 + 0xc0) + 0xb4);
              *(undefined4 *)(iVar25 + 0xe0) = 1;
              if (iVar22 != 0) {
                iVar27 = *(int *)(iVar22 + 0x14);
                if (iVar27 == 0x20) {
                  *(undefined4 *)(iVar25 + 0xe0) = 0;
                }
                else {
                  iVar22 = 1;
                  if (iVar27 == 4) {
                    *(undefined4 *)(iVar25 + 0xe0) = 0;
                    goto LAB_0049a378;
                  }
                }
              }
            }
            iVar22 = 1;
          }
LAB_0049a378:
          param_2 = unaff_s2;
          (*(code *)PTR_OPENSSL_cleanse_006a8174)(unaff_s3);
          (*(code *)PTR_CRYPTO_free_006a7f88)(unaff_s3);
          iStack_a8 = iVar22;
        }
      }
    }
  }
  if (local_24 == *(int **)puStack_a4) {
    return iVar22;
  }
  piStack_100 = local_24;
  (*(code *)PTR___stack_chk_fail_006aabb8)();
  puStack_f4 = PTR___stack_chk_guard_006aabf0;
  puStack_d0 = &_gp;
  iStack_ac = *(int *)PTR___stack_chk_guard_006aabf0;
  piStack_2ac = param_2;
  piStack_a0 = unaff_s2;
  iStack_9c = unaff_s3;
  iStack_98 = unaff_s4;
  piStack_94 = unaff_s5;
  if (param_2 == (int *)0x0) {
    iVar22 = (*(code *)PTR_EVP_MD_CTX_md_006a85fc)(piStack_100[0x21]);
    if (iVar22 != 0) {
      uVar23 = (**(code **)(puStack_d0 + -0x78e4))(piStack_100[0x21]);
      iVar22 = (**(code **)(puStack_d0 + -0x6fb4))(uVar23);
      if (iVar22 < 0) {
        param_3 = "n >= 0";
        piStack_2ac = (int *)0x2dc;
        (**(code **)(puStack_d0 + -0x7194))(&DAT_00647bcc);
      }
    }
    piVar24 = (int *)piStack_100[0x20];
    piStack_2b8 = (int *)(piStack_100[0x16] + 0x10c);
    if (piVar24 != (int *)0x0) {
      unaff_s6 = (**(code **)(puStack_d0 + -0x6cc8))(piVar24);
      goto LAB_0049a5c4;
    }
LAB_0049a50c:
    pcVar53 = *(code **)(puStack_d0 + -0x52e4);
LAB_0049a510:
    param_3 = (char *)piStack_2b8[1];
    piStack_2ac = (int *)piStack_2b8[4];
    (*pcVar53)(piStack_2b8[3]);
    iVar22 = 1;
    piStack_2b8[4] = piStack_2b8[3];
    piStack_2b0 = piVar24;
  }
  else {
    iVar22 = (*(code *)PTR_EVP_MD_CTX_md_006a85fc)(piStack_100[0x24]);
    if (iVar22 != 0) {
      uVar23 = (**(code **)(puStack_d0 + -0x78e4))(piStack_100[0x24]);
      iVar22 = (**(code **)(puStack_d0 + -0x6fb4))(uVar23);
      if (iVar22 < 0) {
        param_3 = "n >= 0";
        piStack_2ac = (int *)0x2b9;
        (**(code **)(puStack_d0 + -0x7194))(&DAT_00647bcc);
      }
    }
    unaff_s5 = (int *)piStack_100[0x16];
    piStack_2b0 = (int *)piStack_100[0x23];
    piStack_2b8 = unaff_s5 + 0x4c;
    piVar24 = piStack_2b0;
    if (piStack_2b0 == (int *)0x0) goto LAB_0049a50c;
    unaff_s6 = (**(code **)(puStack_d0 + -0x6cc8))(piStack_2b0);
    if ((0x301 < *piStack_100) &&
       (uVar26 = (**(code **)(puStack_d0 + -0x6c70))(unaff_s6), (uVar26 & 0xf0007) == 2)) {
      piStack_2ac = (int *)(**(code **)(puStack_d0 + -0x7884))(unaff_s6);
      if (1 < (int)piStack_2ac) {
        if (unaff_s5[0x4f] != unaff_s5[0x50]) {
          uStack_d8 = 0x2d1;
          param_4 = (int *)&DAT_00647bcc;
          param_3 = "%s:%d: rec->data != rec->input\n";
          piStack_2ac = (int *)0x1;
          (**(code **)(puStack_d0 + -0x5454))(**(undefined4 **)(puStack_d0 + -0x52e0));
          goto LAB_0049a5c4;
        }
        iVar22 = (**(code **)(puStack_d0 + -0x719c))();
        if (0 < iVar22) goto LAB_0049a5c4;
LAB_0049aa84:
        iVar22 = -1;
        goto LAB_0049a530;
      }
LAB_0049a5c4:
      pcVar53 = *(code **)(puStack_d0 + -0x52e4);
      if (piStack_100[0x30] != 0) goto LAB_0049a5d0;
      goto LAB_0049a510;
    }
    if (piStack_100[0x30] == 0) goto LAB_0049a50c;
LAB_0049a5d0:
    if (unaff_s6 == 0) goto LAB_0049a50c;
    unaff_s8 = (int *)piStack_2b8[1];
    unaff_s5 = (int *)(**(code **)(puStack_d0 + -0x6cc4))(*piVar24);
    iVar22 = (**(code **)(puStack_d0 + -0x6c70))(*piVar24);
    piStack_2b0 = piVar24;
    if (iVar22 << 10 < 0) {
      iVar22 = *piStack_100;
      if (param_2 == (int *)0x0) {
        piVar52 = (int *)(piStack_100[0x16] + 8);
        if ((iVar22 == 0xfeff) || (iVar22 == 0x100)) {
          uVar2 = *(undefined2 *)(piStack_100[0x17] + 0x208);
          uVar38 = (undefined)((ushort)uVar2 >> 8);
          goto LAB_0049a62c;
        }
LAB_0049a88c:
        iStack_bc = *piVar52;
        iStack_b8 = piVar52[1];
        cVar33 = *(char *)((int)piVar52 + 7) + '\x01';
        *(char *)((int)piVar52 + 7) = cVar33;
        if ((cVar33 == '\0') &&
           (((((cVar33 = *(char *)((int)piVar52 + 6) + '\x01', *(char *)((int)piVar52 + 6) = cVar33,
               cVar33 == '\0' &&
               (cVar33 = *(char *)((int)piVar52 + 5) + '\x01', *(char *)((int)piVar52 + 5) = cVar33,
               cVar33 == '\0')) &&
              (cVar33 = *(char *)(piVar52 + 1), *(char *)(piVar52 + 1) = cVar33 + '\x01',
              (char)(cVar33 + '\x01') == '\0')) &&
             ((cVar33 = *(char *)((int)piVar52 + 3) + '\x01', *(char *)((int)piVar52 + 3) = cVar33,
              cVar33 == '\0' &&
              (cVar33 = *(char *)((int)piVar52 + 2) + '\x01', *(char *)((int)piVar52 + 2) = cVar33,
              cVar33 == '\0')))) &&
            (cVar33 = *(char *)((int)piVar52 + 1) + '\x01', *(char *)((int)piVar52 + 1) = cVar33,
            cVar33 == '\0')))) {
          *(char *)piVar52 = *(char *)piVar52 + '\x01';
        }
        iVar22 = *piStack_100;
      }
      else {
        piVar52 = (int *)(piStack_100[0x16] + 0x54);
        if ((iVar22 != 0xfeff) && (iVar22 != 0x100)) goto LAB_0049a88c;
        uVar2 = *(undefined2 *)(piStack_100[0x17] + 0x20a);
        uVar38 = (undefined)((ushort)uVar2 >> 8);
LAB_0049a62c:
        bVar1 = *(byte *)((int)piVar52 + 6);
        in_t0 = (uint)bVar1;
        cVar33 = *(char *)((int)piVar52 + 7);
        uVar34 = *(uint *)((int)piVar52 + 2);
        iStack_bc = CONCAT13(uVar38,CONCAT12((char)uVar2,SUB42(auStack_c8,0)));
        auStack_c8 = (undefined  [4])iStack_bc;
        puVar51 = auStack_c8 + 2;
        uVar26 = (uint)puVar51 & 3;
        *(uint *)(puVar51 + -uVar26) =
             *(uint *)(puVar51 + -uVar26) & -1 << (4 - uVar26) * 8 | uVar34 >> uVar26 * 8;
        puVar51 = auStack_c4 + 1;
        uVar26 = (uint)puVar51 & 3;
        *(uint *)(puVar51 + -uVar26) =
             *(uint *)(puVar51 + -uVar26) & 0xffffffffU >> (uVar26 + 1) * 8 |
             uVar34 << (3 - uVar26) * 8;
        auStack_c4._0_4_ = CONCAT31(CONCAT21(auStack_c4._0_2_,bVar1),cVar33);
        iStack_b8 = auStack_c4._0_4_;
      }
      param_4 = &iStack_bc;
      uStack_b2 = (undefined)iVar22;
      param_3 = &DAT_0000000d;
      piStack_2ac = (int *)&DAT_00000016;
      uStack_b3 = (undefined)((uint)iVar22 >> 8);
      uStack_b4 = (undefined)*piStack_2b8;
      uStack_b0 = (undefined)piStack_2b8[1];
      uStack_b1 = (undefined)((uint)piStack_2b8[1] >> 8);
      unaff_s7 = (**(code **)(puStack_d0 + -0x6bc0))(piVar24);
      if (param_2 != (int *)0x0) {
        piVar52 = (int *)((int)unaff_s8 + unaff_s7);
        piStack_2b8[1] = piStack_2b8[1] + unaff_s7;
        unaff_s8 = piVar52;
        if (param_2 != (int *)0x0) goto LAB_0049a6e4;
      }
LAB_0049a6c8:
      iVar22 = 0;
      piVar52 = unaff_s8;
      if (unaff_s8 != (int *)0x0) {
LAB_0049a6d0:
        if (unaff_s5 == (int *)0x0) {
          trap(7);
        }
        iVar22 = 0;
        unaff_s8 = piVar52;
        if ((uint)piVar52 % (uint)unaff_s5 == 0) {
LAB_0049a6e4:
          pcVar53 = *(code **)(puStack_d0 + -0x6e30);
          unaff_s8 = piVar52;
          goto LAB_0049a6e8;
        }
      }
    }
    else if (unaff_s5 == (int *)0x1) {
      unaff_s7 = 0;
      if (param_2 == (int *)0x0) goto LAB_0049a6c8;
      pcVar53 = *(code **)(puStack_d0 + -0x6e30);
LAB_0049a6e8:
      param_3 = (char *)piStack_2b8[4];
      piStack_2ac = (int *)piStack_2b8[3];
      param_4 = unaff_s8;
      piStack_2b0 = (int *)(*pcVar53)(piVar24);
      iVar22 = (**(code **)(puStack_d0 + -0x6c70))(*piVar24);
      if (iVar22 << 0xb < 0) {
        uVar26 = (uint)piStack_2b0 >> 0x1f;
      }
      else {
        uVar26 = (uint)(piStack_2b0 == (int *)0x0);
      }
      if (uVar26 != 0) goto LAB_0049aa84;
      uVar26 = (**(code **)(puStack_d0 + -0x6c70))(unaff_s6);
      if ((uVar26 & 0xf0007) == 6) {
        pcVar53 = *(code **)(puStack_d0 + -0x78e4);
        if (param_2 == (int *)0x0) {
          piStack_2b8[3] = piStack_2b8[3] + 8;
          piStack_2b8[4] = piStack_2b8[4] + 8;
          piStack_2b8[1] = piStack_2b8[1] + -8;
        }
      }
      else {
        pcVar53 = *(code **)(puStack_d0 + -0x78e4);
      }
      iVar22 = (*pcVar53)(piStack_100[0x21]);
      if (iVar22 == 0) {
        piVar24 = (int *)0x0;
      }
      else {
        uVar23 = (**(code **)(puStack_d0 + -0x78e4))(piStack_100[0x21]);
        piVar24 = (int *)(**(code **)(puStack_d0 + -0x6fb4))(uVar23);
      }
      if (unaff_s5 == (int *)0x1) {
        if (unaff_s7 == 0) goto LAB_0049a790;
        iVar22 = 1;
        if (param_2 == (int *)0x0) goto LAB_0049a868;
      }
      else if (param_2 == (int *)0x0) {
        piStack_2ac = piStack_2b8;
        param_3 = (char *)unaff_s5;
        iVar22 = tls1_cbc_remove_padding(piStack_100);
        param_4 = piVar24;
        if (unaff_s7 != 0) {
LAB_0049a868:
          unaff_s7 = piStack_2b8[1] - unaff_s7;
          piStack_2b8[1] = unaff_s7;
        }
      }
      else {
LAB_0049a790:
        iVar22 = 1;
      }
    }
    else {
      if (param_2 != (int *)0x0) {
        if (unaff_s5 == (int *)0x0) {
          trap(7);
        }
        iVar25 = (int)unaff_s5 - (int)unaff_s8 % (int)unaff_s5;
        iVar22 = iVar25 + -1;
        if (((piStack_100[0x40] & 0x200U) != 0) && ((*(uint *)piStack_100[0x16] & 8) != 0)) {
          iVar22 = iVar25;
        }
        piVar52 = (int *)((int)unaff_s8 + iVar25);
        if ((int)unaff_s8 < (int)piVar52) {
          do {
            pbVar31 = (byte *)(piStack_2b8[4] + (int)unaff_s8);
            unaff_s8 = (int *)((int)unaff_s8 + 1);
            *pbVar31 = (byte)iVar22;
          } while (piVar52 != unaff_s8);
        }
        unaff_s7 = 0;
        piStack_2b8[1] = piStack_2b8[1] + iVar25;
        goto LAB_0049a6e4;
      }
      unaff_s7 = 0;
      piVar52 = unaff_s8;
      if (unaff_s8 != (int *)0x0) goto LAB_0049a6d0;
      iVar22 = 0;
    }
  }
LAB_0049a530:
  if (iStack_ac == *(int *)puStack_f4) {
    return iVar22;
  }
  pcStack_ec = tls1_cert_verify_mac;
  iStack_16c = iStack_ac;
  (**(code **)(puStack_d0 + -0x5328))();
  piStack_2a8 = (int *)PTR___stack_chk_guard_006aabf0;
  iVar22 = *(int *)(iStack_16c + 0x58);
  puStack_130 = &_gp;
  piStack_24c = *(int **)PTR___stack_chk_guard_006aabf0;
  piStack_10c = piStack_24c;
  piStack_104 = piStack_2b8;
  piStack_fc = piStack_2b0;
  piStack_f8 = param_2;
  piStack_f0 = unaff_s5;
  if (*(int *)(iVar22 + 0x178) == 0) {
LAB_0049ab00:
    piStack_2b8 = (int *)0x0;
    piStack_2b0 = (int *)&DAT_00000018;
    puVar51 = puStack_130;
LAB_0049ab10:
    if (*(int *)(*(int *)(iVar22 + 0x17c) + (int)piStack_2b8) == 0) {
LAB_0049ab44:
      piStack_2b8 = piStack_2b8 + 1;
      if (piStack_2b8 == (int *)&DAT_00000018) goto LAB_0049ab50;
      iVar22 = *(int *)(iStack_16c + 0x58);
      goto LAB_0049ab10;
    }
    uVar23 = (**(code **)(puVar51 + -0x78e4))();
    piVar24 = (int *)(**(code **)(puStack_130 + -0x7a14))(uVar23);
    puVar51 = puStack_130;
    if (piVar24 != piStack_2ac) goto LAB_0049ab44;
    piStack_2b8 = (int *)(*(int *)(*(int *)(iStack_16c + 0x58) + 0x17c) + (int)piStack_2b8);
    iStack_16c = *piStack_2b8;
    if (iStack_16c != 0) {
      piStack_2b8 = aiStack_124;
      (**(code **)(puStack_130 + -0x7fc4))(piStack_2b8);
      (**(code **)(puStack_130 + -0x6cb4))(piStack_2b8,iStack_16c);
      piStack_338 = &iStack_128;
      piStack_24c = (int *)param_3;
      (**(code **)(puStack_130 + -0x7868))(piStack_2b8);
      (**(code **)(puStack_130 + -0x7fac))(piStack_2b8);
      iVar22 = iStack_128;
      goto LAB_0049ab7c;
    }
LAB_0049ab50:
    piStack_338 = (int *)0x144;
    param_4 = (int *)&DAT_00647bcc;
    uStack_138 = 0x377;
    piStack_24c = (int *)0x11e;
    (**(code **)(puVar51 + -0x6eb0))(0x14);
    iVar22 = 0;
  }
  else {
    piStack_338 = (int *)param_3;
    iVar22 = ssl3_digest_cached_records();
    if (iVar22 != 0) {
      iVar22 = *(int *)(iStack_16c + 0x58);
      goto LAB_0049ab00;
    }
  }
LAB_0049ab7c:
  if (piStack_10c == (int *)*piStack_2a8) {
    return iVar22;
  }
  pcStack_14c = tls1_final_finish_mac;
  piVar24 = piStack_10c;
  (**(code **)(puStack_130 + -0x5328))();
  ppiStack_240 = (int **)PTR___stack_chk_guard_006aabf0;
  piStack_340 = *(int **)PTR___stack_chk_guard_006aabf0;
  puStack_160 = (undefined *)piStack_2a8;
  puStack_258 = &_gp;
  piStack_174 = piStack_340;
  piStack_170 = piStack_2b8;
  piStack_168 = piStack_2b0;
  piStack_164 = piStack_2ac;
  piStack_15c = (int *)param_3;
  iStack_158 = unaff_s6;
  iStack_154 = unaff_s7;
  piStack_150 = unaff_s8;
  piStack_140 = piStack_338;
  if ((*(int *)(piVar24[0x16] + 0x178) == 0) ||
     (iVar22 = ssl3_digest_cached_records(), piStack_2a0 = param_4, iVar22 != 0)) {
    puStack_23c = auStack_218;
    piVar52 = aiStack_1f4;
    piStack_238 = piVar52;
    (**(code **)(puStack_258 + -0x7fc4))(puStack_23c);
    iVar22 = 0;
    iStack_244 = 0;
    iStack_250 = 0;
    while (iVar25 = ssl_get_handshake_digest(iVar22,&uStack_228,&uStack_224), iVar25 != 0) {
      uVar26 = ssl_get_algorithm2(piVar24);
      if ((uVar26 & uStack_228) == 0) {
        iVar22 = iVar22 + 1;
      }
      else {
        iVar25 = (**(code **)(puStack_258 + -0x6fb4))(uStack_224);
        if (((*(int *)(*(int *)(piVar24[0x16] + 0x17c) + iVar22 * 4) == 0) || (iVar25 < 0)) ||
           (0x80 - iStack_250 < iVar25)) {
          iVar22 = iVar22 + 1;
          iStack_244 = 1;
        }
        else {
          iVar27 = (**(code **)(puStack_258 + -0x6cb4))(puStack_23c);
          if (((iVar27 == 0) ||
              (iVar27 = (**(code **)(puStack_258 + -0x7868))(puStack_23c,piVar52,&iStack_22c),
              iVar27 == 0)) || (iVar27 = iStack_22c, iStack_22c != iVar25)) {
            iStack_244 = 1;
            iVar27 = iVar25;
          }
          piVar52 = (int *)((int)piVar52 + iVar27);
          iVar22 = iVar22 + 1;
          iStack_250 = (int)piVar52 - (int)piStack_238;
        }
      }
    }
    piStack_2ac = &iStack_21c;
    piStack_2b8 = (int *)ssl_get_algorithm2(piVar24);
    piStack_2a8 = &iStack_220;
    iVar25 = 0;
    piStack_2b0 = (int *)(piVar24[0x30] + 0x14);
    uVar26 = *(uint *)(piVar24[0x30] + 0x10);
    iVar22 = 0;
    while (iStack_234 = ssl_get_handshake_digest(iVar25,piStack_2a8,piStack_2ac),
          unaff_s8 = piStack_238, iStack_234 != 0) {
      iVar25 = iVar25 + 1;
      if ((iStack_220 << 10 & (uint)piStack_2b8) != 0) {
        iVar22 = iVar22 + 1;
      }
    }
    if (iVar22 == 0) {
      trap(7);
    }
    unaff_s7 = (int)uVar26 / iVar22;
    *(byte *)param_4 = 0;
    if (iVar22 == 1) {
      uVar26 = 0;
    }
    piStack_2a0 = (int *)&bStack_200;
    iVar22 = 0;
    *(byte *)((int)param_4 + 1) = 0;
    *(byte *)((int)param_4 + 2) = 0;
    *(byte *)((int)param_4 + 3) = 0;
    *(byte *)(param_4 + 1) = 0;
    *(byte *)((int)param_4 + 5) = 0;
    *(byte *)((int)param_4 + 6) = 0;
    *(byte *)((int)param_4 + 7) = 0;
    *(byte *)(param_4 + 2) = 0;
    *(byte *)((int)param_4 + 9) = 0;
    *(byte *)((int)param_4 + 10) = 0;
    *(byte *)((int)param_4 + 0xb) = 0;
    piStack_248 = (int *)((uVar26 & 1) + unaff_s7);
    piStack_340 = piStack_2a8;
    piStack_338 = piStack_2ac;
    iVar25 = ssl_get_handshake_digest(0);
    piVar24 = piStack_248;
    iStack_2b4 = iStack_234;
    while (piStack_248 = piVar24, iStack_234 = iStack_2b4, iVar25 != 0) {
      if ((iStack_220 << 10 & (uint)piStack_2b8) != 0) {
        if (iStack_21c == 0) {
          piStack_338 = (int *)0x146;
          piStack_280 = (int *)0x114;
          piStack_340 = (int *)0x11c;
          (**(code **)(puStack_258 + -0x6eb0))(0x14,0x11c,0x146,&DAT_00647bcc);
        }
        else {
          uStack_260 = 0xc;
          uStack_268 = 0;
          uStack_26c = 0;
          uStack_270 = 0;
          uStack_274 = 0;
          piStack_27c = unaff_s8;
          piStack_340 = piStack_2b0;
          piStack_280 = piStack_140;
          iStack_278 = iStack_250;
          piStack_264 = piStack_2a0;
          iVar25 = tls1_P_hash_constprop_2();
          piStack_338 = piVar24;
          iStack_2b4 = iStack_234;
          if (iVar25 != 0) {
            piStack_2b0 = (int *)((int)piStack_2b0 + unaff_s7);
            bVar1 = *(byte *)((int)param_4 + 3) ^ bStack_1fd;
            in_t3 = (uint)bVar1;
            in_t2 = (uint)(*(byte *)(param_4 + 1) ^ bStack_1fc);
            bVar21 = *(byte *)((int)param_4 + 5) ^ bStack_1fb;
            in_t1 = (uint)bVar21;
            *(byte *)param_4 = *(byte *)param_4 ^ bStack_200;
            *(byte *)((int)param_4 + 1) = *(byte *)((int)param_4 + 1) ^ bStack_1ff;
            *(byte *)((int)param_4 + 9) = *(byte *)((int)param_4 + 9) ^ bStack_1f7;
            *(byte *)((int)param_4 + 2) = *(byte *)((int)param_4 + 2) ^ bStack_1fe;
            *(byte *)((int)param_4 + 3) = bVar1;
            *(byte *)(param_4 + 1) = *(byte *)(param_4 + 1) ^ bStack_1fc;
            *(byte *)((int)param_4 + 5) = bVar21;
            *(byte *)((int)param_4 + 6) = *(byte *)((int)param_4 + 6) ^ bStack_1fa;
            *(byte *)((int)param_4 + 7) = *(byte *)((int)param_4 + 7) ^ bStack_1f9;
            *(byte *)(param_4 + 2) = *(byte *)(param_4 + 2) ^ bStack_1f8;
            *(byte *)((int)param_4 + 10) = *(byte *)((int)param_4 + 10) ^ bStack_1f6;
            *(byte *)((int)param_4 + 0xb) = *(byte *)((int)param_4 + 0xb) ^ bStack_1f5;
            goto LAB_0049af98;
          }
        }
        (**(code **)(puStack_258 + -0x7fac))(puStack_23c);
        goto LAB_0049afd0;
      }
LAB_0049af98:
      iVar22 = iVar22 + 1;
      piStack_340 = piStack_2a8;
      piStack_338 = piStack_2ac;
      iVar25 = ssl_get_handshake_digest(iVar22);
      piVar24 = piStack_248;
      iStack_2b4 = iStack_234;
    }
    (**(code **)(puStack_258 + -0x7fac))(puStack_23c);
    param_3 = (char *)param_4;
    if (iStack_244 == 0) {
      iStack_2b4 = 0xc;
      goto LAB_0049afd0;
    }
  }
  iStack_2b4 = 0;
  param_4 = (int *)param_3;
LAB_0049afd0:
  if (piStack_174 == *ppiStack_240) {
    return iStack_2b4;
  }
  pcStack_294 = tls1_mac;
  piStack_354 = piStack_174;
  (**(code **)(puStack_258 + -0x5328))();
  puStack_344 = PTR___stack_chk_guard_006aabf0;
  puStack_308 = &_gp;
  iStack_2bc = *(int *)PTR___stack_chk_guard_006aabf0;
  iVar22 = piStack_354[0x16];
  puStack_350 = (uint *)(iVar22 + 0x10c);
  if (piStack_338 == (int *)0x0) {
    puVar51 = (undefined *)piStack_354[0x21];
    puStack_358 = (undefined4 *)(iVar22 + 8);
    uStack_348 = piStack_354[0x1f] & 1;
  }
  else {
    puVar51 = (undefined *)piStack_354[0x24];
    puStack_350 = (uint *)(iVar22 + 0x130);
    puStack_358 = (undefined4 *)(iVar22 + 0x54);
    uStack_348 = piStack_354[0x1f] & 2;
  }
  piStack_2a4 = param_4;
  iStack_29c = unaff_s7;
  piStack_298 = unaff_s8;
  uVar23 = (*(code *)PTR_EVP_MD_CTX_md_006a85fc)(puVar51);
  iStack_2f0 = (**(code **)(puStack_308 + -0x6fb4))(uVar23);
  if (iStack_2f0 < 0) {
    uStack_2fc = iStack_2f0;
    (**(code **)(puStack_308 + -0x7194))(&DAT_00647bcc,0x3d3,"t >= 0");
    iStack_2f0 = uStack_2fc;
  }
  puStack_34c = puVar51;
  if (uStack_348 == 0) {
    puStack_34c = auStack_2ec;
    (**(code **)(puStack_308 + -0x6e2c))(puStack_34c,puVar51);
  }
  iVar22 = *piStack_354;
  if ((iVar22 == 0xfeff) || (iVar22 == 0x100)) {
    if (piStack_338 == (int *)0x0) {
      uVar2 = *(undefined2 *)(piStack_354[0x17] + 0x208);
      uVar38 = (undefined)((ushort)uVar2 >> 8);
    }
    else {
      uVar2 = *(undefined2 *)(piStack_354[0x17] + 0x20a);
      uVar38 = (undefined)((ushort)uVar2 >> 8);
    }
    auStack_2d4 = (undefined  [4])CONCAT13(uVar38,CONCAT12((char)uVar2,SUB42(auStack_2d4,0)));
    bVar1 = *(byte *)((int)puStack_358 + 6);
    in_t0 = (uint)bVar1;
    uVar34 = *(uint *)((int)puStack_358 + 2);
    cVar33 = *(char *)((int)puStack_358 + 7);
    puVar51 = auStack_2d4 + 2;
    uVar26 = (uint)puVar51 & 3;
    *(uint *)(puVar51 + -uVar26) =
         *(uint *)(puVar51 + -uVar26) & -1 << (4 - uVar26) * 8 | uVar34 >> uVar26 * 8;
    puVar51 = auStack_2d0 + 1;
    uVar26 = (uint)puVar51 & 3;
    *(uint *)(puVar51 + -uVar26) =
         *(uint *)(puVar51 + -uVar26) & 0xffffffffU >> (uVar26 + 1) * 8 | uVar34 << (3 - uVar26) * 8
    ;
    auStack_2d0 = (undefined  [4])CONCAT31(CONCAT21(auStack_2d0._0_2_,bVar1),cVar33);
    uStack_2c8 = auStack_2d0;
    uStack_2cc = auStack_2d4;
  }
  else {
    uStack_2cc = *puStack_358;
    uStack_2c8 = puStack_358[1];
  }
  uStack_2fc = puStack_350[1];
  uStack_33c = *puStack_350;
  iStack_2f8 = iStack_2f0;
  puVar42 = (undefined4 *)(uStack_33c & 0xff);
  *puStack_350 = (uint)puVar42;
  uStack_2c4 = (undefined)uStack_33c;
  uStack_2c3 = (undefined)((uint)iVar22 >> 8);
  uStack_2c2 = (undefined)iVar22;
  uStack_2c1 = (undefined)(uStack_2fc >> 8);
  uStack_2c0 = (undefined)uStack_2fc;
  puVar43 = &uStack_2cc;
  if (((piStack_338 == (int *)0x0) &&
      (puStack_2f4 = &uStack_2cc, uVar26 = (**(code **)(puStack_308 + -0x6cb0))(piStack_354[0x20]),
      puVar43 = puStack_2f4, (uVar26 & 0xf0007) == 2)) &&
     (iVar22 = ssl3_cbc_record_digest_supported(puStack_34c,puStack_2f4), puVar43 = puStack_2f4,
     iVar22 != 0)) {
    uStack_30c = 0;
    iStack_314 = piStack_354[0x16] + 0x14;
    uStack_310 = *(undefined4 *)(piStack_354[0x16] + 0x10);
    pcVar50 = (char *)&iStack_2f0;
    iStack_318 = uStack_2fc + iStack_2f8 + (uStack_33c >> 8);
    iStack_31c = puStack_350[1] + iStack_2f0;
    uStack_320 = puStack_350[4];
    puVar42 = puStack_2f4;
    ssl3_cbc_digest_record(puStack_34c,piStack_340);
  }
  else {
    (**(code **)(puStack_308 + -0x786c))(puStack_34c,puVar43,0xd);
    (**(code **)(puStack_308 + -0x786c))(puStack_34c,puStack_350[4],puStack_350[1]);
    pcVar50 = (char *)&iStack_2f0;
    iVar22 = (**(code **)(puStack_308 + -0x7914))(puStack_34c,piStack_340);
    if (iVar22 < 1) {
      pcVar50 = "t > 0";
      (**(code **)(puStack_308 + -0x7194))(&DAT_00647bcc,0x40d);
    }
  }
  if (uStack_348 == 0) {
    (**(code **)(puStack_308 + -0x7fac))(auStack_2ec);
  }
  if (((*piStack_354 != 0xfeff) && (*piStack_354 != 0x100)) &&
     ((((cVar33 = *(char *)((int)puStack_358 + 7) + '\x01', *(char *)((int)puStack_358 + 7) = cVar33
        , cVar33 == '\0' &&
        ((cVar33 = *(char *)((int)puStack_358 + 6) + '\x01',
         *(char *)((int)puStack_358 + 6) = cVar33, cVar33 == '\0' &&
         (cVar33 = *(char *)((int)puStack_358 + 5) + '\x01',
         *(char *)((int)puStack_358 + 5) = cVar33, cVar33 == '\0')))) &&
       (cVar33 = *(char *)(puStack_358 + 1), *(char *)(puStack_358 + 1) = cVar33 + '\x01',
       (char)(cVar33 + '\x01') == '\0')) &&
      (((cVar33 = *(char *)((int)puStack_358 + 3) + '\x01', *(char *)((int)puStack_358 + 3) = cVar33
        , cVar33 == '\0' &&
        (cVar33 = *(char *)((int)puStack_358 + 2) + '\x01', *(char *)((int)puStack_358 + 2) = cVar33
        , cVar33 == '\0')) &&
       (cVar33 = *(char *)((int)puStack_358 + 1) + '\x01', *(char *)((int)puStack_358 + 1) = cVar33,
       cVar33 == '\0')))))) {
    *(char *)puStack_358 = *(char *)puStack_358 + '\x01';
  }
  if (iStack_2bc == *(int *)puStack_344) {
    return iStack_2f0;
  }
  pcStack_334 = tls1_generate_master_secret;
  iVar22 = iStack_2bc;
  (**(code **)(puStack_308 + -0x5328))();
  puVar51 = PTR___stack_chk_guard_006aabf0;
  uStack_35c = *(uint *)PTR___stack_chk_guard_006aabf0;
  puVar43 = puVar42;
  uVar26 = ssl_get_algorithm2();
  iVar54 = *(int *)(iVar22 + 0xc0);
  iVar27 = 0;
  iVar25 = *(int *)(iVar22 + 0x58) + 0xc0;
  puVar28 = (uint *)(iVar54 + 0x14);
  iVar22 = 0;
  while (iVar29 = ssl_get_handshake_digest(iVar27,&iStack_394,&iStack_390), iVar29 != 0) {
    iVar27 = iVar27 + 1;
    if ((iStack_394 << 10 & uVar26) != 0) {
      iVar22 = iVar22 + 1;
    }
  }
  if (iVar22 == 0) {
    trap(7);
  }
  iVar27 = (int)puVar42 / iVar22;
  if (iVar22 == 1) {
    puVar42 = (undefined4 *)0x0;
  }
  (*(code *)PTR_memset_006aab00)(puVar28,0,0x30);
  iVar22 = 0;
  pcStack_3a8 = "master secret";
  piVar24 = &iStack_394;
  piVar52 = &iStack_390;
  iVar29 = ssl_get_handshake_digest(0);
  do {
    if (iVar29 == 0) {
LAB_0049b79c:
      if (uStack_35c == *(uint *)puVar51) {
        return 0x30;
      }
      uVar26 = uStack_35c;
      (*(code *)PTR___stack_chk_fail_006aabb8)();
      puVar42 = puVar43;
      iVar22 = (*(code *)PTR_CRYPTO_malloc_006a8108)(piVar52,&DAT_00647bcc,0x471);
      if (iVar22 == 0) {
        iVar25 = 0;
        (*(code *)PTR_ERR_put_error_006a9030)(0x14,0x13a,0x41,&DAT_00647bcc,0x4b5);
      }
      else {
        iVar25 = uStack_3e8 + 0x40;
        if (iStack_3dc == 0) {
          iVar54 = (*(code *)PTR_CRYPTO_malloc_006a8108)(iVar25,&DAT_00647bcc,0x47f);
          iVar27 = iVar25;
        }
        else {
          iVar27 = uStack_3e0 + 2 + iVar25;
          iVar54 = (*(code *)PTR_CRYPTO_malloc_006a8108)(iVar27,&DAT_00647bcc,0x47f);
        }
        if (iVar54 == 0) {
          (*(code *)PTR_ERR_put_error_006a9030)(0x14,0x13a,0x41,&DAT_00647bcc,0x4b5);
          (*(code *)PTR_CRYPTO_free_006a7f88)(iVar22);
          return 0;
        }
        uVar40 = uStack_3e8;
        (*(code *)PTR_memcpy_006aabf4)(iVar54);
        puVar32 = (uint *)(iVar54 + uStack_3e8);
        iVar36 = *(int *)(uVar26 + 0x58);
        puVar28 = (uint *)(iVar54 + uStack_3e8 + 0x20);
        uVar49 = *(uint *)(iVar36 + 0xc0);
        uVar34 = iVar36 + 0xc4U & 3;
        uVar3 = iVar36 + 200U & 3;
        uVar4 = iVar36 + 0xccU & 3;
        uVar5 = iVar36 + 0xd0U & 3;
        uVar6 = iVar36 + 0xd4U & 3;
        uVar7 = iVar36 + 0xd8U & 3;
        iVar29 = *(int *)((iVar36 + 0xd8U) - uVar7);
        uVar8 = iVar36 + 0xdcU & 3;
        iVar9 = *(int *)((iVar36 + 0xdcU) - uVar8);
        uVar12 = iVar36 + 199U & 3;
        uVar48 = (*(int *)((iVar36 + 0xc4U) - uVar34) << uVar34 * 8 |
                 in_t3 & 0xffffffffU >> (4 - uVar34) * 8) & -1 << (uVar12 + 1) * 8 |
                 *(uint *)((iVar36 + 199U) - uVar12) >> (3 - uVar12) * 8;
        uVar34 = iVar36 + 0xcbU & 3;
        uVar47 = (*(int *)((iVar36 + 200U) - uVar3) << uVar3 * 8 |
                 in_t2 & 0xffffffffU >> (4 - uVar3) * 8) & -1 << (uVar34 + 1) * 8 |
                 *(uint *)((iVar36 + 0xcbU) - uVar34) >> (3 - uVar34) * 8;
        uVar34 = iVar36 + 0xcfU & 3;
        uVar46 = (*(int *)((iVar36 + 0xccU) - uVar4) << uVar4 * 8 |
                 in_t1 & 0xffffffffU >> (4 - uVar4) * 8) & -1 << (uVar34 + 1) * 8 |
                 *(uint *)((iVar36 + 0xcfU) - uVar34) >> (3 - uVar34) * 8;
        uVar34 = iVar36 + 0xd3U & 3;
        uVar45 = (*(int *)((iVar36 + 0xd0U) - uVar5) << uVar5 * 8 |
                 in_t0 & 0xffffffffU >> (4 - uVar5) * 8) & -1 << (uVar34 + 1) * 8 |
                 *(uint *)((iVar36 + 0xd3U) - uVar34) >> (3 - uVar34) * 8;
        uVar34 = iVar36 + 0xd7U & 3;
        uVar44 = (*(int *)((iVar36 + 0xd4U) - uVar6) << uVar6 * 8 |
                 (uint)puVar42 & 0xffffffffU >> (4 - uVar6) * 8) & -1 << (uVar34 + 1) * 8 |
                 *(uint *)((iVar36 + 0xd7U) - uVar34) >> (3 - uVar34) * 8;
        uVar34 = iVar36 + 0xdbU & 3;
        uVar4 = *(uint *)((iVar36 + 0xdbU) - uVar34);
        uVar3 = iVar36 + 0xdfU & 3;
        uVar5 = *(uint *)((iVar36 + 0xdfU) - uVar3);
        *puVar32 = uVar49;
        puVar32[1] = uVar48;
        puVar32[2] = uVar47;
        puVar32[3] = uVar46;
        puVar32[4] = uVar45;
        puVar32[5] = uVar44;
        puVar32[6] = (iVar29 << uVar7 * 8 | uVar40 & 0xffffffffU >> (4 - uVar7) * 8) &
                     -1 << (uVar34 + 1) * 8 | uVar4 >> (3 - uVar34) * 8;
        puVar32[7] = (iVar9 << uVar8 * 8 | (uint)puVar43 & 0xffffffffU >> (4 - uVar8) * 8) &
                     -1 << (uVar3 + 1) * 8 | uVar5 >> (3 - uVar3) * 8;
        iVar37 = *(int *)(uVar26 + 0x58);
        uVar34 = iVar37 + 0xa0U & 3;
        uVar3 = iVar37 + 0xa4U & 3;
        iVar29 = *(int *)((iVar37 + 0xa4U) - uVar3);
        uVar4 = iVar37 + 0xa8U & 3;
        iVar9 = *(int *)((iVar37 + 0xa8U) - uVar4);
        uVar5 = iVar37 + 0xacU & 3;
        iVar36 = *(int *)((iVar37 + 0xacU) - uVar5);
        uVar6 = iVar37 + 0xb0U & 3;
        iVar10 = *(int *)((iVar37 + 0xb0U) - uVar6);
        uVar7 = iVar37 + 0xb4U & 3;
        iVar11 = *(int *)((iVar37 + 0xb4U) - uVar7);
        uVar8 = iVar37 + 0xa3U & 3;
        uVar12 = iVar37 + 0xa7U & 3;
        uVar16 = *(uint *)((iVar37 + 0xa7U) - uVar12);
        uVar40 = iVar37 + 0xabU & 3;
        uVar17 = *(uint *)((iVar37 + 0xabU) - uVar40);
        uVar13 = iVar37 + 0xafU & 3;
        uVar18 = *(uint *)((iVar37 + 0xafU) - uVar13);
        uVar14 = iVar37 + 0xb3U & 3;
        uVar19 = *(uint *)((iVar37 + 0xb3U) - uVar14);
        uVar15 = iVar37 + 0xb7U & 3;
        uVar20 = *(uint *)((iVar37 + 0xb7U) - uVar15);
        uVar41 = *(uint *)(iVar37 + 0xb8);
        uVar39 = *(uint *)(iVar37 + 0xbc);
        *puVar28 = (*(int *)((iVar37 + 0xa0U) - uVar34) << uVar34 * 8 |
                   uVar49 & 0xffffffffU >> (4 - uVar34) * 8) & -1 << (uVar8 + 1) * 8 |
                   *(uint *)((iVar37 + 0xa3U) - uVar8) >> (3 - uVar8) * 8;
        puVar28[1] = (iVar29 << uVar3 * 8 | uVar48 & 0xffffffffU >> (4 - uVar3) * 8) &
                     -1 << (uVar12 + 1) * 8 | uVar16 >> (3 - uVar12) * 8;
        puVar28[2] = (iVar9 << uVar4 * 8 | uVar47 & 0xffffffffU >> (4 - uVar4) * 8) &
                     -1 << (uVar40 + 1) * 8 | uVar17 >> (3 - uVar40) * 8;
        puVar28[3] = (iVar36 << uVar5 * 8 | uVar46 & 0xffffffffU >> (4 - uVar5) * 8) &
                     -1 << (uVar13 + 1) * 8 | uVar18 >> (3 - uVar13) * 8;
        puVar28[4] = (iVar10 << uVar6 * 8 | uVar45 & 0xffffffffU >> (4 - uVar6) * 8) &
                     -1 << (uVar14 + 1) * 8 | uVar19 >> (3 - uVar14) * 8;
        puVar28[5] = (iVar11 << uVar7 * 8 | uVar44 & 0xffffffffU >> (4 - uVar7) * 8) &
                     -1 << (uVar15 + 1) * 8 | uVar20 >> (3 - uVar15) * 8;
        puVar28[6] = uVar41;
        puVar28[7] = uVar39;
        if (iStack_3dc != 0) {
          *(char *)(iVar54 + iVar25) = (char)((uint)uStack_3e0 >> 8);
          *(undefined *)((int)puVar32 + 0x41) = (undefined)uStack_3e0;
          if ((uStack_3e0 != 0) || (iStack_3e4 != 0)) {
            (*(code *)PTR_memcpy_006aabf4)(iVar54 + uStack_3e8 + 0x42,iStack_3e4,uStack_3e0);
          }
        }
        iVar25 = (*(code *)PTR_memcmp_006aabd8)(iVar54,"client finished",0xf);
        if (((iVar25 == 0) ||
            (iVar25 = (*(code *)PTR_memcmp_006aabd8)(iVar54,"server finished",0xf), iVar25 == 0)) ||
           ((iVar25 = (*(code *)PTR_memcmp_006aabd8)(iVar54,"master secret",0xd), iVar25 == 0 ||
            (iVar25 = (*(code *)PTR_memcmp_006aabd8)(iVar54,"key expansion",0xd), iVar25 == 0)))) {
          iVar25 = 0;
          (*(code *)PTR_ERR_put_error_006a9030)(0x14,0x13a,0x16f,&DAT_00647bcc,0x4b1);
        }
        else {
          iVar25 = tls1_PRF_constprop_1
                             (*(undefined4 *)(*(int *)(*(int *)(uVar26 + 0x58) + 0x344) + 0x24),
                              iVar54,iVar27,0,0,0,0,0,0,*(int *)(uVar26 + 0xc0) + 0x14,
                              *(undefined4 *)(*(int *)(uVar26 + 0xc0) + 0x10),piVar24,iVar22,piVar52
                             );
        }
        (*(code *)PTR_CRYPTO_free_006a7f88)(iVar22);
        (*(code *)PTR_CRYPTO_free_006a7f88)(iVar54);
      }
      return iVar25;
    }
    if ((iStack_394 << 10 & uVar26) != 0) {
      if (iStack_390 == 0) {
        piVar52 = (int *)0x146;
        puVar43 = (undefined4 *)&DAT_00647bcc;
        uStack_3e8 = 0x114;
        piVar24 = (int *)0x11c;
        (*(code *)PTR_ERR_put_error_006a9030)(0x14);
        goto LAB_0049b79c;
      }
      uStack_3e0 = 0x20;
      iStack_3dc = 0;
      uStack_3e8 = 0xd;
      piVar24 = (int *)pcVar50;
      piVar52 = (int *)(((uint)puVar42 & 1) + iVar27);
      puVar43 = (undefined4 *)pcStack_3a8;
      iVar29 = tls1_P_hash_constprop_2();
      iStack_3e4 = iVar25;
      if (iVar29 == 0) goto LAB_0049b79c;
      pcVar50 = (char *)((int)pcVar50 + iVar27);
      puVar32 = &uStack_38c;
      puVar35 = puVar28;
      if (((uint)puVar28 & 3) == 0 &&
          ((uint *)(iVar54 + 0x18) <= &uStack_38c || &uStack_388 <= puVar28)) {
        *(uint *)(iVar54 + 0x14) = *(uint *)(iVar54 + 0x14) ^ uStack_38c;
        *(uint *)(iVar54 + 0x18) = uStack_388 ^ *(uint *)(iVar54 + 0x18);
        puVar43 = (undefined4 *)(uStack_374 ^ *(uint *)(iVar54 + 0x2c));
        in_t3 = uStack_378 ^ *(uint *)(iVar54 + 0x28);
        *(uint *)(iVar54 + 0x1c) = uStack_384 ^ *(uint *)(iVar54 + 0x1c);
        *(uint *)(iVar54 + 0x20) = uStack_380 ^ *(uint *)(iVar54 + 0x20);
        *(uint *)(iVar54 + 0x24) = uStack_37c ^ *(uint *)(iVar54 + 0x24);
        *(uint *)(iVar54 + 0x28) = in_t3;
        *(undefined4 **)(iVar54 + 0x2c) = puVar43;
        *(uint *)(iVar54 + 0x30) = uStack_370 ^ *(uint *)(iVar54 + 0x30);
        *(uint *)(iVar54 + 0x38) = uStack_368 ^ *(uint *)(iVar54 + 0x38);
        *(uint *)(iVar54 + 0x34) = uStack_36c ^ *(uint *)(iVar54 + 0x34);
        *(uint *)(iVar54 + 0x3c) = uStack_364 ^ *(uint *)(iVar54 + 0x3c);
        *(uint *)(iVar54 + 0x40) = *(uint *)(iVar54 + 0x40) ^ uStack_360;
      }
      else {
        do {
          puVar30 = (uint *)((int)puVar32 + 1);
          *(byte *)puVar35 = *(byte *)puVar35 ^ *(byte *)puVar32;
          puVar32 = puVar30;
          puVar35 = (uint *)((int)puVar35 + 1);
        } while (puVar30 != &uStack_35c);
      }
    }
    iVar22 = iVar22 + 1;
    piVar24 = &iStack_394;
    piVar52 = &iStack_390;
    iVar29 = ssl_get_handshake_digest(iVar22);
  } while( true );
}

